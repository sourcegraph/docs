# Other Git repository hosts

<TierCallout>
  Supported on [Enterprise](/pricing/enterprise) plans.
  <user>
    Available via the Web app.
  </user>
</TierCallout>

Site admins can sync Git repositories on any Git repository host (by Git clone URL) with Sourcegraph so that users can search and navigate the repositories. Use this method only when your repository host is not named as a supported [code host](/admin/code_hosts/).

To connect generic Git host to Sourcegraph:

1. Go to **Site admin > Manage code hosts > Add repositories**
1. Select **Generic Git host**.
1. Configure the connection to generic Git host the action buttons above the text field, and additional fields can be added using `Cmd/Ctrl+Space` for auto-completion. See the [configuration documentation below](#configuration).
1. Press **Add repositories**.

## Constructing the `url` for SSH access

>NOTE: Repository access over SSH is not yet supported on [Sourcegraph Cloud](/cloud/).

If your code host serves git repositories over SSH, make sure your Sourcegraph instance can connect to your code host over SSH:

```
docker exec $CONTAINER ssh -p $PORT $USER@$HOSTNAME
```

- $CONTAINER is the name or ID of your sourcegraph/server container
- $PORT is the port on which your code host's git server is listening for connections
- $USER is your user on your code host
- $HOSTNAME is the hostname of your code host from within the sourcegraph/server container (e.g. `githost.example.com`)

Here's an example:

```
docker exec sourcegraph ssh -p 29418 admin@githost.example.com
```

The `url` field is then

```json
  "url": "ssh://$USER@$HOSTNAME:$PORT"`
```

Here's an example:

```json
  "url": "ssh://admin@githost.example.com:29418",
```

## Adding repositories

Elements of the `repos` field are the same as the repository names. For example, a repository at https://githost.example.com/admin/repos/gorilla/mux will be `"gorilla/mux"` in the `repos` field.

Repositories must be listed individually:

```json
  "repos": [
    "gorilla/mux",
    "sourcegraph/sourcegraph"
  ]
```

## Configuration

{/* <div markdown-func=jsonschemadoc jsonschemadoc:path="admin/code_hosts/other_external_service.schema.json">[View page on our docs](/admin/code_hosts/other) to see rendered content.</div> */}

### admin/code_hosts/other_external_service.schema.json

{/* SCHEMA_SYNC_START: admin/code_hosts/other_external_service.schema.json */}
{/* WARNING: This section is auto-generated during releases. Do not edit manually. */}
{/* Last updated: Manual setup - will be automated via sourcegraph/sourcegraph releases */}
```json
{
	// A list of repositories to never mirror by name after applying repositoryPathPattern. Supports excluding by exact name ({"name": "myrepo"}) or regular expression ({"pattern": ".*secret.*"}).
	"exclude": null,
	// Other example values:
	// - [
	//     {
	//       "name": "myrepo"
	//     },
	//     {
	//       "pattern": ".*secret.*"
	//     }
	//   ]

	// Whether or not these repositories should be marked as public on Sourcegraph.com. Defaults to false.
	"makeReposPublicOnDotCom": false,

	"repos": null,

	// The pattern used to generate the corresponding Sourcegraph repository name for the repositories. In the pattern, the variable "{base}" is replaced with the Git clone base URL host and path, and "{repo}" is replaced with the repository path taken from the `repos` field.
	//
	// For example, if your Git clone base URL is https://git.example.com/repos and `repos` contains the value "my/repo", then a repositoryPathPattern of "{base}/{repo}" would mean that a repository at https://git.example.com/repos/my/repo is available on Sourcegraph at https://sourcegraph.example.com/git.example.com/repos/my/repo.
	//
	// It is important that the Sourcegraph repository name generated with this pattern be unique to this code host. If different code hosts generate repository names that collide, Sourcegraph's behavior is undefined.
	//
	// Note: These patterns are ignored if using src-expose / src-serve / src-serve-local.
	"repositoryPathPattern": "{base}/{repo}",
	// Other example values:
	// - "pretty-host-name/{repo}"

	// The root directory to walk for discovering local git repositories to mirror. To sync with local repositories and use this root property one must run Cody App and define the repos configuration property such as ["src-serve-local"].
	"root": "",
	// Other example values:
	// - "path/to/my/repos"

	"url": null
	// Other example values:
	// - "https://github.com/?access_token=secret"
	// - "ssh://user@host.xz:2333/"
	// - "git://host.xz:2333/"
}
```
{/* SCHEMA_SYNC_END: admin/code_hosts/other_external_service.schema.json */}

## Configuration Notes

### Use Cases
- Generic Git host connections are for unsupported or custom Git hosting solutions
- Use only when your Git host doesn't have a dedicated Sourcegraph integration
- Requires manual specification of repository lists

### Repository Management
- Repositories must be listed individually in the `repos` array
- Repository names should match the path after the base URL
- Use `exclude` patterns to filter out unwanted repositories

### URL Configuration
- Supports HTTP, HTTPS, SSH, and Git protocols
- SSH access requires proper key configuration
- Include authentication tokens in URLs when necessary

## Security Considerations

### Authentication
- Embed authentication tokens directly in URLs when required
- Use environment variables for sensitive credentials
- Consider using SSH keys for private repository access
- Regularly rotate authentication credentials

### Access Control
- Generic Git hosts do not enforce repository permissions
- All configured repositories will be accessible to Sourcegraph users
- Consider using dedicated Git users with limited repository access

### Network Security
- Ensure Sourcegraph can access Git host on required ports
- SSH connections require port 22 access and key exchange
- HTTPS connections require port 443 access
- Consider firewall rules for custom Git protocols

## Common Examples

### HTTPS with Authentication Token
```json
{
  "url": "https://git.example.com/",
  "repos": [
    "myorg/project1",
    "myorg/project2"
  ],
  "repositoryPathPattern": "git.example.com/{repo}"
}
```

### SSH Configuration
```json
{
  "url": "ssh://git@git.example.com:2222/",
  "repos": [
    "platform/core",
    "platform/ui"
  ],
  "repositoryPathPattern": "internal-git/{repo}"
}
```

### Custom Git Protocol
```json
{
  "url": "git://git.example.com:9418/",
  "repos": [
    "public/project1",
    "public/project2"
  ],
  "repositoryPathPattern": "{base}/{repo}",
  "exclude": [
    {"pattern": ".*-backup$"},
    {"name": "public/archive"}
  ]
}
```

### Local Repository Discovery
```json
{
  "repos": ["src-serve-local"],
  "root": "/path/to/local/repos",
  "repositoryPathPattern": "local/{repo}"
}
```

## Best Practices

### Setup and Configuration
- Test Git connectivity manually before configuring the code host
- Use meaningful `repositoryPathPattern` to avoid naming conflicts
- Start with a small set of repositories for initial testing
- Verify repository paths match your Git hosting structure

### Security
- Use SSH keys for private repository access when possible
- Store authentication tokens securely using environment variables
- Implement proper access controls on the Git host side
- Regularly audit repository access and permissions

### Performance
- Use exclude patterns to limit repository scope
- Consider repository size when planning sync schedules
- Monitor network performance for large repository sets
- Plan for Git protocol limitations and timeouts

### Maintenance
- Keep repository lists updated with infrastructure changes
- Monitor sync errors and connectivity issues
- Regularly review exclude patterns and repository configurations
- Plan for Git host migrations and URL changes

### Protocol Considerations
- HTTPS is recommended for most configurations
- SSH requires additional key management but offers better security
- Git protocol is efficient but less secure than HTTPS
- Consider protocol-specific firewall and network requirements

### Repository Organization
- Use consistent naming patterns across repositories
- Group related repositories using path prefixes
- Document repository inclusion criteria
- Consider using separate connections for different repository groups

### Troubleshooting
- Test Git clone operations manually using the same URLs
- Verify network connectivity to Git host and required ports
- Check authentication credentials and permissions
- Review Git host logs for access and error information
