# Gitolite

<TierCallout>
  Supported on [Enterprise](/pricing/enterprise) plans.
  <user>
    Available via the Web app.
  </user>
</TierCallout>

> NOTE: While it is possible to connect Gitolite repositories to Sourcegraph, we currently do not recommend it. If you have specific questions, please discuss with your account team.

Site admins can link and sync Git repositories on [Gitolite](https://gitolite.com) with Sourcegraph so that users can search and navigate the repositories.

To connect Gitolite to Sourcegraph:

1. Set up [git SSH authentication](/admin/repo/auth) for your gitolite server.
1. Go to **Site admin > Manage code hosts > Add repositories**
1. Select **Gitolite**.
1. Configure the connection to Gitolite using the action buttons above the text field, and additional fields can be added using `Cmd/Ctrl+Space` for auto-completion. See the [configuration documentation below](#configuration).
1. Press **Add repositories**.

## Configuration

{/* <div markdown-func=jsonschemadoc jsonschemadoc:path="admin/code_hosts/gitolite.schema.json">[View page on sourcegraph.com/docs](/admin/code_hosts/gitolite) to see rendered content.</div> */}

### admin/code_hosts/gitolite.schema.json

{/* SCHEMA_SYNC_START: admin/code_hosts/gitolite.schema.json */}
{/* WARNING: This section is auto-generated during releases. Do not edit manually. */}
{/* Last updated: Manual setup - will be automated via sourcegraph/sourcegraph releases */}
```json
{
	// A list of repositories to never mirror from this Gitolite instance. Supports excluding by exact name ({"name": "foo"}).
	"exclude": null,
	// Other example values:
	// - [
	//     {
	//       "name": "myrepo"
	//     },
	//     {
	//       "pattern": ".*secret.*"
	//     }
	//   ]

	// Gitolite host that stores the repositories (e.g., git@gitolite.example.com, ssh://git@gitolite.example.com:2222/).
	"host": null,
	// Other example values:
	// - "git@gitolite.example.com"
	// - "ssh://git@gitolite.example.com:2222/"

	// This is DEPRECATED
	"phabricator": null,

	// This is DEPRECATED
	"phabricatorMetadataCommand": null,

	// Repository name prefix that will map to this Gitolite host. This should likely end with a trailing slash. E.g., "gitolite.example.com/".
	//
	// It is important that the Sourcegraph repository name generated with this prefix be unique to this code host. If different code hosts generate repository names that collide, Sourcegraph's behavior is undefined.
	"prefix": null
	// Other example values:
	// - "gitolite.example.com/"
}
```
{/* SCHEMA_SYNC_END: admin/code_hosts/gitolite.schema.json */}

## Configuration Notes

### Authentication Requirements
- Gitolite connections require SSH authentication setup
- SSH keys must be configured before creating the code host connection
- The SSH user must have access to all repositories intended for syncing

### Repository Discovery
- All accessible repositories are synced by default
- Use `exclude` to prevent specific repositories from being synced
- Supports exclusion by exact name or regular expression pattern

### Connection Setup
- SSH authentication must be configured prior to adding the code host
- The `host` field specifies the SSH connection string
- The `prefix` field determines the repository naming pattern in Sourcegraph

## Security Considerations

### SSH Key Management
- Use dedicated SSH keys for Sourcegraph integration
- Store private keys securely using proper file permissions
- Consider using SSH key passphrases for additional security
- Regularly rotate SSH keys according to security policies

### Access Control
- Gitolite's repository access control is not enforced by Sourcegraph
- All repositories accessible to the configured SSH user will be visible
- Consider using dedicated Gitolite users with limited repository access

### Network Security
- Ensure Sourcegraph can access Gitolite server on SSH port (typically 22)
- Configure firewall rules appropriately for SSH access
- Consider using non-standard SSH ports for additional security

## Common Examples

### Basic SSH Configuration
```json
{
  "host": "git@gitolite.example.com",
  "prefix": "gitolite.example.com/",
  "exclude": [
    {"name": "test-repo"},
    {"pattern": ".*-temp$"}
  ]
}
```

### Custom SSH Port Setup
```json
{
  "host": "ssh://git@gitolite.example.com:2222/",
  "prefix": "gitolite.example.com/",
  "exclude": [
    {"pattern": "^archive/.*"}
  ]
}
```

### Multiple Gitolite Instances
```json
{
  "host": "git@internal-gitolite.company.com",
  "prefix": "internal-git/",
  "exclude": [
    {"pattern": ".*secret.*"},
    {"name": "legacy-system"}
  ]
}
```

## Best Practices

### Setup and Configuration
- Test SSH connectivity manually before configuring the code host
- Use meaningful prefix patterns to avoid repository name conflicts
- Configure exclude patterns to filter out temporary or test repositories
- Verify SSH key permissions and ownership on the Sourcegraph server

### Security
- Use dedicated SSH keys specifically for Sourcegraph integration
- Implement proper SSH key rotation schedules
- Consider using SSH key passphrases with secure key storage
- Monitor SSH access logs for unusual activity

### Performance
- Use exclude patterns to limit the scope of repository syncing
- Consider the size and number of repositories when planning sync schedules
- Monitor network performance for large repository synchronizations
- Plan for SSH connection limits and timeouts

### Maintenance
- Regularly review repository inclusion/exclusion patterns
- Keep SSH configurations updated with infrastructure changes
- Plan for Gitolite server migrations and key rotations
- Monitor sync errors and connectivity issues

### Migration Considerations
- Gitolite is not actively recommended for new installations
- Consider migrating to more actively supported Git hosting solutions
- Plan transition strategies for existing Gitolite repositories
- Evaluate alternatives like GitLab, GitHub Enterprise, or Bitbucket

### Troubleshooting
- Verify SSH connectivity using `ssh -T git@gitolite.example.com`
- Check SSH key permissions (600 for private key, 644 for public key)
- Ensure SSH agent is configured properly if using key passphrases
- Review Gitolite server logs for access and authentication issues
