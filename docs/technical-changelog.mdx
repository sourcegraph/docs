# Technical Changelog

This page documents all notable changes to Sourcegraph. For more detailed changelog posts, please [read here](https://sourcegraph.com/changelog/).

{/* CHANGELOG_START */}

# 6.9 Patch 2

## v6.9.902

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.9.902)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.9.902)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.9.902)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.9.902)

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v6.9.902", "releasedAt": "2025-10-20"} */}


# 6.9 Patch 0

## v6.9.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.9.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.9.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.9.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.9.0)

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- deep search: add RBAC `(PR #7427)`
  - This adds RBAC to Deep Search. By default, all users have full read and write access for Deep Search, but this can be restricted by changing the default role permissions or by creating new custom roles.

{/* RSS={"version":"v6.9.0", "releasedAt": "2025-10-15"} */}


# 6.8 Patch 1

## v6.8.2313

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.8.2313)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.8.2313)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.8.2313)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.8.2313)

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.8.x] Handle user soft delete errors in prompts resolver gracefully `(PR #7452)`
  -  Backport 4f2e3577235575b45573182254c9cf250e37d86d from #7439
- [Backport 6.8.x] Update Cody Web to 0.36.0 `(PR #7451)`
  - Update Cody Web to 0.36.0
  Backport 05d5faee1fe8f7f0785a928684c694d228558bdb from #7448
- [Backport 6.8.x] Use median value for sorting insight series `(PR #7375)`

{/* RSS={"version":"v6.8.2313", "releasedAt": "2025-10-01"} */}


# 6.8 Patch 0

## v6.8.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.8.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.8.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.8.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.8.0)

### Features

#### Cody

- Add Claude Opus 4.1 `(PR #7218)`

#### Ds

- Deep Search rate limits dynamically scale for Enterprise Portal `(PR #6902)`

#### Release

- Release prep codeowners file update `(PR #7251)`
  - Feat: update codeowners release prep activity
- Release prep deliverables activity `(PR #7240)`
  - Feat: minor release prep deliverables activity
- Stitched-graph gen activity with buildkite `(PR #7209)`
  - Feat(release): stitched-graph gen activity with buildkite
- Init minor release prep activities `(PR #7091)`
  - Temporal maxVersionConst update activity, minor release prep workflow set up
- Stitched Migration Graph Gen Library `(PR #7024)`
  - Feat(release): introduce stitched graph lib for portability rather than just a bazel target

#### Search

- Consider existing file: filters for suggestions `(PR #7253)`

#### Source

- Gate Cody API access behind license feature `(PR #7230)`
  - The Cody API endpoints (anything under `/.api/llm`) are no longer available.
- Support Bitbucket Server's archived repositories `(PR #7158)`
  - Sourcegraph now supports Bitbucket Server's [official way to archive a repository](https://confluence.atlassian.com/bitbucketserver/archive-a-repository-1128304317.html), and the workaround of applying an "archived" label is no longer supported.
- Support .git-blame-ignore-revs for Blame commands `(PR #7035)`
  - Sourcegraph now supports `.git-blame-ignore-revs` files in the root of repositories.

#### Others

- Add predefined OAuth client for Visual Studio `(PR #7163)`
  - VS predefined OAuth client added
- Sg msp: use operatorwrite db account `(PR #7132)`
- Add predefined OAuth client for Cody `(PR #7090)`
  - Add "cody" predefined client with device flow support to enable OAuth authentication for Sourcegraph Cody across all IDEs.
- Embed React prompts pages `(PR #6735)`
- Embed repo own pages `(PR #6713)`

### Fix

#### Cody

- Max output tokens for claude-opus-4-1 `(PR #7260)`

#### Deepsearch

- Only show follow-up suggestions for most recent QA pair `(PR #6998)`

#### Ds-Gating

- Added testing to telemetry for DS gating on fail open cases `(PR #7017)`
  - Added testing to the telemetry events on fail open cases for DeepSearch gating

#### Release

- Use `--auto-exclude-previous-releases` in changelog call `(PR #7224)`
  - Feat: improved changelog gen filtering, prevent duplicate entries on fast forwarded branches

#### Source

- Git blame check for fs.PathError instead of NotFound error `(PR #7215)`
- Deduplicate repository permissions on Repo Permissions page `(PR #7202)`
  - Fixed a bug where, on a user's Repo Permissions page, the number of repositories they have access to could be greatly exaggerated.
- Fix repo permissions page pagination `(PR #7200)`
  - Fixed an issue where pagination on a user's Repo Permissions page did not work.
- Show different errors for user and organisation name conflicts `(PR #7166)`

#### Others

- Fix various style issues with embedded React pages `(PR #7242)`
- Make Deep Search responsive `(PR #7125)`
- Add `billingMetadata` to `search:execute` event `(PR #7086)`
- Add /search/notebook to /notebooks redirect in new web app `(PR #7066)`
- Sg setup check for pre-commit `(PR #7042)`
  - N/A
- Update dev/nix README with Cachix setup documentation `(PR #7007)`
  - N/A

### Chore

#### Ci

- Use sourcegraph/go-mockgen fork `(PR #7052)`

#### Cody

- Deprecated claude opus 4 `(PR #7258)`

#### Deepsearch

- Remove Deep Search tool from MCP registry `(PR #7314)`
- Prevent input and follow up boxes from accepting pasted images `(PR #7309)`
- Add composite index for user_id and updated_at `(PR #7129)`

#### Release

- Consolidate sitiched const to one file `(PR #7122)`
  - Chore: consolidate stitched graph generation consts into one file

#### Source

- Wrap FetchUserPerms errors more `(PR #7264)`
- Simplify code and remove TODO `(PR #7192)`

#### Others

- Enable react embedded pages for customers `(PR #7243)`
- Deprecate claude sonnet 3.5 model since it's going to be EOL `(PR #7085)`
  - Closes: CODY-6235

### Reverts

- Revert pgvector removal and auto-upgrade of versions `(PR #-1)`

### Uncategorized

#### Others

- [Backport 6.8.x] Fix OAuth provider matching when multiple client IDs are present for the same URL `(PR #7282)`
- Fix repository metadata documentation link `(PR #7244)`
- Bug(deep search): Report suggested follow-ups as raw LLM call in analytics `(PR #7226)`
  - Fixed the analytics event type for follow-up suggestions to use `DeepSearchEventRawLLM` instead of `DeepSearchEventFollowUp` to ensure consistent event tracking.
- Feat(deep search): add deepsearch MCP tool `(PR #7197)`
  - Added DeepSearch tool to the MCP API for codebase assistant integration
- Msp: pgaudit for operator users `(PR #7196)`
- Move feature checks into the worker routine `(PR #7187)`
- Workspaces/internal: link to Stripe customer `(PR #7183)`
- Workspaces: write billing event in background `(PR #7182)`
- Feat(deep search): create MCP server endpoint `(PR #7173)`
  - Added Model Context Protocol (MCP) support to Deepsearch API
  - Refactored tool response handling to use strongly typed responses
  - Moved error messages and notes to dedicated fields instead of embedding in content
  - Removed X-Requested-With middleware requirement for MCP endpoints
  - Improved tool schema handling with separate input and output schemas
- Cloud: add waf configuration to instance proto `(PR #7172)`
- Msp: filter service logs to only service container `(PR #7171)`
- Fix SvelteKit theme state `(PR #7167)`
- Embed insight dashboard edit pages `(PR #7159)`
- Msp: scale uptime check period based on livenessInterval `(PR #7154)`
- Msp/runtime: better documentation for RegisterDiagnosticsHandlers `(PR #7151)`
- Bug(deep search): add viewed analytics event `(PR #7145)`
  - Added telemetry recording for the `DeepSearchEventViewed` event type in the deep search analytics recorder.
- Embed code insights standalone and edit pages in SvelteKit shell `(PR #7137)`
- Feat(deep search): record analytics when a shared thread is viewed `(PR #7130)`
  - Refactored DeepSearch telemetry into a dedicated `deepsearchAnalyticsRecorder` component
  - Added tracking for when DeepSearch conversations are shared and viewed by others
  - Moved telemetry-related code from `deepsearch_agent.go` to a new `analytics.go` file
- Added redirect param to sign out for workspaces and EP `(PR #7128)`
  - Added redirect parameter when pressing sign out button in Enterprise Portal and Workspaces
- Fix repositories search alert UI `(PR #7126)`
- Feat(deep search): combine line ranges in identical files `(PR #7109)`
  - Created new `file-source-utils.ts` with helper functions for processing file ranges
  - Updated `FileSource.svelte` to display multiple ranges with separators
  - Modified `FilePreview.svelte` to use the first range from the array
  - Updated backend tools to use the new `lineRanges` array format
  - Added database migration to convert existing `lineRange` to `lineRanges` array
- Omega: use internal image, deliver image to pipeline `(PR #7104)`
- Embed insights creation pages to the sveltekit shell `(PR #7082)`
- Ep/administration: filter by license tags and revocation state `(PR #7073)`
- Tls: Deprecate experimental setting and code-host certificate settings `(PR #7037)`
- Msp/cloudsql: postgresql.additionalFlags `(PR #7023)`
- Make index picker show the type of index available `(PR #7015)`
- Add RBAC permission that allows uploading SCIP code index `(PR #7010)`
  - A user can be allowed through RBAC system to upload SCIP indexes for repositories they do not have write access to on code forge. This also applies to service accounts.
- Update telemetry billing metadata from 'insights' to 'insight' `(PR #7000)`
- Modelconfig: remove generated JSON `(PR #6981)`
- Migrate Code Insights react pages to sveltekit shell UI `(PR #6929)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Add reasoning to GPT-5 models `(PR #7223)`
  - Fixed model configuration to include reasoning parameter.
- Fix(deep search): remove unused property from conversation test `(PR #7084)`

{/* RSS={"version":"v6.8.0", "releasedAt": "2025-09-18"} */}


# 6.7 Patch 5

## v6.7.2720

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.7.2720)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.7.2720)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.7.2720)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.7.2720)

### Fix

#### Cody

- Add reasoning to GPT-5 models `(PR #7223)`
  - Fixed model configuration to include reasoning parameter.

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v6.7.2720", "releasedAt": "2025-09-04"} */}


# 6.7 Patch 4

## v6.7.2518

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.7.2518)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.7.2518)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.7.2518)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.7.2518)

### Features

#### Code Intelligence

- Add Tree-sitter support for Swift `(PR #7201)`
  - Swift code should be now properly highlighted using tree-sitter.
  Backport 61c45dfc1e2371fb4e6802f5d877cdcfbb139bce from #7113

### Fix

#### Source

- Pass noSignIn field in Gerrit auth provider correctly `(PR #7206)`
- Update account connection modal display logic `(PR #7177)`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.7.x] deepsearch/quota: fix user-facing mentions of "DeepSearch" to "Deep Search" `(PR #7190)`
- [Backport 6.7.x] Add integration bundle extension to the short live cache control headers rule `(PR #7185)`
- [Backport 6.7.x] fix(deep search): Fix cached tokens summation `(PR #7156)`

{/* RSS={"version":"v6.7.2518", "releasedAt": "2025-09-03"} */}


# 6.7 Patch 3

## v6.7.1104

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.7.1104)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.7.1104)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.7.1104)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.7.1104)

### Chore

#### Deepsearch

- Bump timeout for executing turn `(PR #7143)`

### Reverts

  There were no reverts for this release



{/* RSS={"version":"v6.7.1104", "releasedAt": "2025-08-26"} */}


# 6.7 Patch 2

## v6.7.375

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.7.375)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.7.375)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.7.375)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.7.375)

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.7.x] bitbucket: Improve Bitbucket repo listing performance `(PR #7117)`
  - Addressed pagination and performance issues with listing Bitbucket.org repositories in Enterprise Starter repository management.  Backport cd8120b70d93d9ab4021f7c284464bcd5b5246de from #7112

{/* RSS={"version":"v6.7.375", "releasedAt": "2025-08-22"} */}


# 6.7 Patch 1

## v6.7.229

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.7.229)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.7.229)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.7.229)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.7.229)

### Fix

#### Cody

- Add reasoning to GPT-5 models `(PR #7107)`
  - Fixed OpenAI GPT-5 reasoning model to use correct temperature and top_p parameters. These models now default to 0 for both parameters, allowing OpenAI to use its optimized defaults for reasoning tasks.
  Backport 59a57c27d8c27a665d596b4324f85177914758a3 from #7092
- Include `UseLegacyCompletions` in the config conversion layer `(PR #7089)`
  - Addresses `422 Unprocessable Entity` errors due to Cody client using `/v1/chat/completions` instead of the legacy `/v1/completions`.
  Backport 231d6ebe20ec8e327fc9695f4df5e6039bb8208e from #7054

### Chore

#### Security

- Auto-update all packages in Sourcegraph container images `(PR #7094)`

### Uncategorized

#### Others

- Deep search: fix ranking of repo suggestions `(PR #7100)`

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v6.7.229", "releasedAt": "2025-08-22"} */}


# 6.7 Patch 0

## v6.7.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.7.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.7.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.7.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.7.0)

### Features

#### Cloud

- CloudAPI client support SAMS token provider `(PR #6816)`
- Extend with additional configuration `(PR #6712)`

#### Cloudapi

- Search by subscriptionId `(PR #6886)`
- Enforce scopes `(PR #6769)`

#### Code Intelligence

- GRAPH-920 Cross-repo syntactic code navigation `(PR #5622)`

#### Deepsearch

- Create worker pool for deepsearchHandler `(PR #6869)`

#### Dev

- Update route codegen to respect +page.ts `(PR #6685)`

#### Gating

- Added telemetry for gating on open failure `(PR #6965)`
  - Added licensing.canConsumeDeepSearchQuota and licensing.consumeDeepSearchQuota telemetry events
  - Captures error codes, license key status, and error details for debugging
  - Uses testutil.IsTest pattern for test safety

#### Release

- Changelog generation activity `(PR #6744)`
  - Feat: technical changelog generation temporal activity
- Schema sync library `(PR #6703)`
  - Chore(release): make library for easier calling of schema sync tool
- Docs activities in releaseplatform `(PR #6623)`
  - Release: add temporal activities and workflow for docs related release operations

#### Search

- CORE-1202 Added store layer to metering service of enterprise portal `(PR #6830)`
- CORE-1183 Added metering stub API for deep search usage `(PR #6636)`

#### Source

- Allow finding users by roles and permissions `(PR #6815)`

#### Others

- Google Vertex: fix critical regression; add support for Gemin models and Workload Identity auth `(PR #7080)`
  - Google Vertex: added Workload Identity authentication support, as an alternative to access token authentication.
  - Google Vertex: fixed issues preventing Gemini models from being used.
  Backport f80ec0d84a54336daf66fa6e9c8a43cea9ac1fc2 from #7075
- Add fullscreen option to page layout `(PR #6733)`
- Embed React repo batch changes page `(PR #6686)`

### Fix

#### Batch Changes

- Add constraint to remove duplicate template fields in batch spec library variables table `(PR #6741)`

#### Deepsearch

- Add nil check when setting UserAgent `(PR #6972)`
- Fix table content overflow `(PR #6870)`
- Fix token counting and split LLMStats interface `(PR #6856)`
- Migration for SearchErrorKind `(PR #6745)`
- Fix search error kind unmarshalling `(PR #6720)`

#### Dev

- Add parallel as prerequisite to sg setup for ubuntu `(PR #6226)`
- Fix postgress install step in 'sg setup' `(PR #6190)`

#### Prompts

- Avoid throwing "user not found" errors when listing prompts `(PR #6975)`
- Gracefully handle deleted users for tags `(PR #6771)`
  - Fix(prompts): gracefully handle deleted users for tags

#### Release

- Fix changelog activity semver handle `(PR #6958)`

#### Search

- Default enterprise-portal set to dev `(PR #6864)`

#### Source

- Reduce verbosity of gitserver logging `(PR #6939)`
- Add a max height to modal and overflow scroll `(PR #6881)`
- Annotate redacted secrets in batch changes logs `(PR #6849)`
- Refactor external account perms syncing to not fail on a single error `(PR #6847)`
- Improve contrast in dark theme for Combobox used in explicit permissions page `(PR #6818)`
- Teams: fix width of error banner `(PR #6702)`
- Make MT repo search tooltip span over columns `(PR #6639)`
- Fix some minor grammatical errors `(PR #6638)`

#### Others

- Match child symbols with their parent using full container path `(PR #6936)`
- Revet migration from d07540b `(PR #6922)`
- QueryInput placeholder prop `(PR #6665)`
- Improve workspaces mobile layout `(PR #6612)`

### Chore

#### Ci

- Update aspect_rules_swc to 2.4.4 `(PR #6893)`
- Update rules_js 2.4.1 `(PR #6891)`

#### Cleanup

- Remove dead mock functions `(PR #6829)`
- Remove dead graphql initializers `(PR #6826)`

#### Deepsearch

- Add default case to deep search telemetry (#6977) `(PR #7019)`
- Move deep search agentic loop to server `(PR #6919)`
- Remove external link symbol from sources (SPLF-1172) `(PR #6767)`

#### Dev

- Disable flaky web app tests in CI `(PR #6952)`
- Upgrade to pnpm v10 `(PR #6660)`
- Upgrade stylelint `(PR #6564)`

#### Release

- Move schema syncher mapping file to schema folder out of tool `(PR #6854)`
  - Chore: move schema syncher mapping file to schema folder out of tool

#### Source

- Display effective permissions for user roles `(PR #6821)`

#### Ui

- Add SQL syntax highlighting `(PR #6648)`

#### Others

- Remove long deprecated and non-functional config `(PR #6855)`
- Remove mentions of community forum `(PR #6853)`
- Prepare React prompt components `(PR #6734)`
- Support react router injection `(PR #6698)`
- Refactor Svelte app error pages `(PR #6697)`
- Remove unused/broken user area subscription route `(PR #6676)`

### Reverts

- Revert parts of "workspaces: Set up for Teams name change (#6284)" `(PR #6284)`
- Revert "feat(workspaces): add v1 metering service proto" `(PR #6591)`
- Revert "chore: skip bitbucket tests while server is reworked (#6791)" `(PR #6791)`
- Revert "bug(release): Fix the executors changes" `(PR #6912)`

### Uncategorized

#### Others

- Fix(deep search): remove unused property from conversation test `(PR #7084)`
- [Backport 6.7.x] feat(deep search): add share url to deepsearch `(PR #7079)`
  - Added a shareable URL to DeepSearch conversations, making it easier to share conversations with others.  Backport 08602f581464e9f8c1c766cf7542649159bacfc8 from #7078
- [Backport 6.7.x] chore(deep search): remove DeepsearchReference `(PR #7077)`
  - Removed the `references` field from the DeepSearch conversation model and related functionality. This simplifies the codebase by removing the unused file permission tracking system for DeepSearch conversations.  Backport affb5349bedef24188a7e992f9581ee76fbe151d from #7021
- [Backport 6.7.x] feat(deep search): allow sync processing via API (#7055) `(PR #7074)`
- [Backport 6.7.x] cody: add GPT-5 models `(PR #7053)`
- [Backport 6.7.x] webhooks: Fix 500 error if repo is unknown `(PR #7041)`
- [backport 6.7.x] feat(deep search): add v1 to deepsearch APIs prefix `(PR #7018)`
  - Adds `v1` prefix to deepsearch APIsBackport `bcd3192` from [https://github.com/sourcegraph/sourcegraph/pull/7002](https://github.com/sourcegraph/sourcegraph/pull/7002)
- [Backport 6.7.x] Fix native integration bazel build `(PR #7008)`
- Update Cody Web to 0.35.0 `(PR #6989)`
- Completions: propagate scope to Cody Gateway, use different client for deepsearch `(PR #6976)`
- Properly set deep search telemetry action `(PR #6974)`
- Deepsearch: add V2 telemetry for measuring latency of quota enforcement API calls `(PR #6973)`
- Fix(deep search): CORE-1235 Quota message is refreshed after completion of deep search query `(PR #6971)`
- Ci: update cloud gql compat playbook `(PR #6970)`
- Cody-gateway: document attributions API `(PR #6969)`
- Bug(deep search): report sources from tool calls `(PR #6946)`
  - Fixed a bug in DeepSearch where sources were not being recorded
- Enterprise-portal: fix bug in meteringservice with unlimited deepsearch -1 value `(PR #6945)`
- Bug(deep search): migrate questions to fix tool calls `(PR #6944)`
  - Added migration to fix legacy tool call formats in DeepSearch questions
- Enterprise-portal: add escape hatch we can flip to enable unlimited deepsearch `(PR #6942)`
- Disable cody web in Safari `(PR #6941)`
- Update Cody Web to 0.34.0 `(PR #6938)`
- Msp/tfc: trigger on service modules `(PR #6933)`
- Bug(deep search): include thread history in follow-up questions `(PR #6932)`
  - Enhanced DeepSearch to maintain conversation context in follow-up questions
  - Added validation to prevent errors from unfinished tool calls in conversation history
- Dotcom: remove subscriptions UI, EP proxies, unused dotcom site config `(PR #6923)`
- Cody-gateway: fix rate limit Slack notification throttling `(PR #6916)`
- Chore(deep search): CORE-1220 Deep searcg displays error if getting quota usage fails and does not crash `(PR #6897)`
- Chore(deep search): convert the frontend to using question API `(PR #6868)`
- Add sveltekit prod build command `(PR #6863)`
- Msp/lb: fixup security policy again `(PR #6857)`
- Msp/lb: fix Cloud Armor conditions `(PR #6852)`
- Msp: make Cloud Run pending requests alert a bit more lenient `(PR #6825)`
- Chore(deep search): move raw LLM calls to the server [SPLF-1302] `(PR #6812)`
  - Added automatic title generation for Deepsearch conversations
  - Added suggested followup questions after completing a Deepsearch query
- Chore(deep search): adds LLM turn handler for UpdateQuestion `(PR #6811)`
- Codyapi: Add deprecation alert and remove WIP wording `(PR #6807)`
- Dotcom: Remove post sign up page `(PR #6806)`
- Workspaces/invite: show email of already-a-member `(PR #6786)`
- Msp: support always provisioning a Cloud Armor policy that can be extended `(PR #6779)`
- Msp: support additional domains `(PR #6778)`
- Ep: port subscription timeline to new UI `(PR #6777)`
- Modelconfig: regenerate models.json, remove fallback `(PR #6773)`
- Update UIKit to 1.4.2 version `(PR #6772)`
- Msp: add option to spin up private network connector, redis connection util `(PR #6761)`
- Workspaces: fix tests, we now have 500 seats `(PR #6757)`
- Dotcom: fixup go-to-workspace button `(PR #6756)`
- Workspaces: copy fixups `(PR #6755)`
- Mail-gatekeeper: return 10 on zero_credit match `(PR #6754)`
- Rename cody ignore file name `(PR #6752)`
- Dotcom: remove special RBAC `(PR #6742)`
- Dotcom: remove all hubspot integrations `(PR #6740)`
- Dotcom/subscriptions: make deprecation alert way more aggro `(PR #6722)`
- Workspaces: remove Cody Pro checks `(PR #6721)`
- Workspaces/plan: remove code host support `(PR #6719)`
- Dotcom: remove all Cody Pro things `(PR #6708)`
- Workspaces: Fix missing template variable `(PR #6705)`
- Gateway: add gemini 2.5 flash and gemini 2.5 pro `(PR #6700)`
- Feat(deep search): migrate question data model to the server `(PR #6691)`
  - Adds API endpoints for creating and updating questions within a deep search thread
- Refactor(cody-gateway) Deprecate gemini-2.5-flash-preview-04-17 and gemini-2.5-pro-preview-03-25 `(PR #6684)`
- Deepsearch: dotcom: make quota limit 5 searches per user per week `(PR #6659)`
- Dotcom: remove pings forwarder `(PR #6556)`
- Gitserver: Don't logspam errors for canceled requests `(PR #6436)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Teams: fix width of error banner (#6702) `(PR #6706)`
- Update consts and stiched migration graph for 6.6 `(PR #6644)`
  - NA - Internal change

{/* RSS={"version":"v6.7.0", "releasedAt": "2025-08-20"} */}


# 6.6 Patch 2

## v6.6.2517

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.6.2517)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.6.2517)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.6.2517)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.6.2517)

### Features

#### Multitenant

- Load code host scopes in parallel `(PR #6681)`

### Fix

#### Batch Changes

- Introduce workaround for batch changes users on fine-grained pats for github repos `(PR #6704)`
  -  Backport 9e232e27c2c1a19b69b01cea12ae0194fb7d4422 from #6656

#### Multitenant

- Improve typography styles and colors on the create pages `(PR #6736)`

#### Source

- Teams: github: have noConnectedAccountFoundError properly implement errcode.NotFounder (also fix gitlab token scopes) `(PR #6701)`
- Teams: githubapp: make scopes use proper pagination `(PR #6677)`
  -  Backport a278c9287fd779ca9f26d10b2146e7c6cadfbcb3 from #6651
- Specify bitbucket cloud pagelen `(PR #6671)`

### Chore

#### Deepsearch

- Add effect to resize text area `(PR #6699)`
- Don't include full system prompt for rawLLM operations `(PR #6688)`
- Don't include cache control for rawLLM calls `(PR #6687)`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.6.x] gateway: add gemini 2.5 flash and gemini 2.5 pro `(PR #6788)`
  -  Backport d9fd3848772f74133b54bcb33516d2b114f20953 from #6700
- [Backport 6.6.x] Merge Cody ignore and context filters for both dotcom and enterprise `(PR #6749)`
  -  Backport c201fd4027ba118b2c8a0cd089003638f13db429 from #6593
- [Backport 6.6.x] Update Cody Web to 0.33.0 `(PR #6737)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- [Backport 6.6.x] Use iterator methods for filtering `(PR #6672)`
- Update consts and stiched migration graph for 6.6 `(PR #6644)`
  - NA - Internal change
- Removes DeepSearch from pricing table on free tier `(PR #6641)`
- Rename manage installation to just manage `(PR #6640)`
- Layout improvements for the workspace setup `(PR #6624)`
- Add telemetry for rawLLM calls `(PR #6618)`
- Teams: github: drop suspended installations from list of scopes `(PR #6614)`
- Migrate diff_search tool to backend `(PR #6545)`

{/* RSS={"version":"v6.6.2517", "releasedAt": "2025-08-07"} */}


# 6.6 Patch 1

## v6.6.868

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.6.868)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.6.868)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.6.868)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.6.868)

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.6.x] gateway: add gemini 2.5 flash and gemini 2.5 pro `(PR #6790)`
  - Backport d9fd384 from #6700
- [Backport 6.6.x] refactor(cody-gateway) Deprecate gemini-2.5-flash-preview-04-17 and gemini-2.5-pro-preview-03-25 `(PR #6789)`
  -  Backport f90029b038f82815a3a234213737d11f04059938 from #6684

{/* RSS={"version":"v6.6.868", "releasedAt": "2025-07-28"} */}


# 6.6 Patch 0

## v6.6.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.6.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.6.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.6.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.6.0)

### Features

#### Batch Changes

- Enable new templates experience by default `(PR #6608)`
- Enable forked repos flow for pushed-only changesets [gitlab only] `(PR #6342)`
  - Enable forked repos flow for pushed-only changesets [gitlab only]
- Enable forked repos flow for pushed-only changesets [github only] `(PR #6312)`
  - Enable forked repos flow for pushed-only changesets [github only]
- New batch changes experience with templates `(PR #5966)`
  - Feat(batches): new batch changes experience with templates

#### Deepsearch

- Add separate diff search and compare revisions tools (SPLF-1114) `(PR #6332)`

#### Ep

- Improved left nav and consistent margins between internal pages `(PR #6165)`
- Server side filtering for subscriptions listing `(PR #6090)`

#### Multitenant

- Load code host scopes in parallel `(PR #6681)`
- Layout improvements for the workspace setup `(PR #6624)`
- Add BitBucket Cloud setup UI `(PR #6535)`

#### Release

- Schema sync PR Generation `(PR #6340)`
  - Release: sync docs repo config files during release process
- Schema sync configuration system `(PR #6182)`
  - Feat(release): add schema syncing tool to keep docs repo schemas in sync with monorepo

#### Search

- Add grouping by repo or language to the inventory stats insight `(PR #6390)`
- Add archived badge to repos that are archived on code host `(PR #6366)`
- (new web ui) Migrate saved searches to Svelte `(PR #5081)`

#### Source

- Teams: bitbucket: enforce that username must be atlassian email address `(PR #6585)`
- Check token scopes when connecting bitbucket workspace `(PR #6570)`
- Teams: gitlab: prevent setting PAT if token doesn't have sufficient scopes `(PR #6540)`
- Gitlab: create GetPat method that can be used to get information about a PAT (including scopes) `(PR #6539)`
- Allow fetching Bitbucket Cloud connection username `(PR #6538)`
- Teams: bitbucket cloud: make it possible to search / filter repo names without knowing query syntax `(PR #6505)`
- Implement Bitbucket Cloud workspace resolver `(PR #6476)`
- Bitbucket - Create multitenant service for connection management `(PR #6435)`
- Add ListWorkspaceRepositories `(PR #6410)`
- Add support for api tokens to bitbucket cloud client `(PR #6393)`

### Fix

#### Batch Changes

- Introduce workaround for batch changes users on fine-grained pats for github repos `(PR #6704)`
  -  Backport 9e232e27c2c1a19b69b01cea12ae0194fb7d4422 from #6656
- Only show examples in library pane `(PR #6577)`
- Dont pass empty renderTemplate `(PR #6362)`
- Restrict valid characters for batch spec template variable names `(PR #6265)`
- Update schema link to public artifacts repo `(PR #6193)`
  - Fix(batches): update schema link to public artifacts repo

#### Code Intelligence

- Fix and prevent cases where local and global occurrences share a range `(PR #6563)`
- Don't mark global Go vars as locals in syntactic indexing `(PR #6537)`

#### Cody

- Fix underline on hover for the Important Notice Banner `(PR #6246)`

#### Deepsearch

- Fix arrow up and down in follow ups `(PR #6616)`
- Fix commit search query structure `(PR #6551)`
- Reset scroll position when switching conversations `(PR #6482)`
- Cache system prompt `(PR #6459)`
- Fix sidebar animation `(PR #6399)`
- Reset activeAnswerIndex when switching conversations `(PR #6398)`
- Wrap content elements in container `(PR #6394)`
- Follow up questions not working after a fresh load `(PR #6392)`
- Fix external icon styling in sources `(PR #6379)`
- More UI refinements `(PR #6378)`
- Fix null byte parsing (SPLF-1216) `(PR #6348)`
- Sanitize JSON bytes before writing to Postgres (SPLF-1216) `(PR #6275)`
- Ensure hidden sidebar buttons are not interactive `(PR #6262)`
- Move revision label down on file sources and preview to another line `(PR #6135)`

#### Dev

- Fix new web app dev build `(PR #6322)`
- Fix react storybook `(PR #6321)`
- Fix client/web-sveltekit storybook `(PR #6314)`
- Add software-properties-common as prerequisit to sg setup `(PR #6191)`

#### Ep

- Improved tooltip readability for lightmode `(PR #6097)`

#### Ep-Ui

- Fixed subscriptions list's width when loading `(PR #6474)`

#### Insights

- Skip empty repos for inventory insights `(PR #6250)`
  - Fix(insights): skip empty repos for inventory insights

#### Migrator

- Remove links to sourcegraph/sourcegraph repo in drift summary `(PR #6463)`
  - Fix(migrator): remove private repo links in migrator drift output

#### Msp/Otelcol

- Disable GCP resource detection override `(PR #6176)`

#### Multitenant

- Improve typography styles and colors on the create pages `(PR #6736)`
- Multitenant setup paper cuts `(PR #6578)`
- Do not show discount label if coupon isn't presented `(PR #6491)`

#### Release

- Custom wolfi redis image `(PR #6548)`
  - Fix: package custom wolfi redis base image and package to include jemalloc

#### Search

- Do not use workspace list API on unauth instance `(PR #6579)`
- Skip search contexts from deleted namespaces `(PR #6013)`

#### Serch

- Fix dotcom again `(PR #6581)`

#### Source

- Teams: fix width of error banner (#6702) `(PR #6706)`
- Teams: github: have noConnectedAccountFoundError properly implement errcode.NotFounder (also fix gitlab token scopes) `(PR #6701)`
- Teams: githubapp: make scopes use proper pagination `(PR #6677)`
  -  Backport a278c9287fd779ca9f26d10b2146e7c6cadfbcb3 from #6651
- Specify bitbucket cloud pagelen `(PR #6671)`
- Rename manage installation to just manage `(PR #6640)`
- Teams: github: drop suspended installations from list of scopes `(PR #6614)`
- Fix image/attachment click handling in bitbucket server native integration `(PR #6590)`
- Teams: bitbucket: return 0 scopes instead of error when credentials appear to be invalid `(PR #6588)`
- Fix Bitbucket Cloud cloning with API Tokens `(PR #6541)`
- Fix bug where workspace admins cannot manage GitLab repos `(PR #6520)`
- Handle spaces in depot file paths for Perforce `(PR #6337)`

#### Others

- 'Public code search' entry style `(PR #6611)`
- Update bazel file to include correct patch file `(PR #6603)`

### Chore

#### Batch Changes

- Add immediate sync after pushed-only changeset creation [gitlab only] `(PR #6525)`
- Add immediate sync after pushed-only changeset creation [github only] `(PR #6368)`
- Remove unnecessary comments `(PR #6333)`
  - Remove unnecessary comments
- Refactor to use AbbreviateRef instead of TrimPrefix for pushed-only changesets `(PR #6222)`
  - Refactor to use AbbreviateRef instead of TrimPrefix for pushed-only changesets
- Add more backend telemetry for pushed-only changesets `(PR #6219)`
  - Add more backend telemetry for pushed-only changesets

#### Deepsearch

- Add effect to resize text area `(PR #6699)`
- Don't include full system prompt for rawLLM operations `(PR #6688)`
- Don't include cache control for rawLLM calls `(PR #6687)`
- Add telemetry for rawLLM calls `(PR #6618)`
- Migrate diff_search tool to backend `(PR #6545)`
- Migrate compare_revisions tool to backend `(PR #6523)`
- Ensure valid tool call history for follow ups `(PR #6500)`

#### Dev

- Upgrade prettier and prettier svelte plugin `(PR #6473)`
- Upgrade sass `(PR #6291)`
- Upgrade to vite v6 `(PR #6273)`
- Cleanup client/web peer dependency warnings `(PR #6261)`
- Update @reach packages `(PR #6260)`
- Cleanup client/web-sveltekit peer dependencies `(PR #6258)`
- Upgrade fonts `(PR #6257)`
- Upgrade prettier format imports plugin `(PR #6256)`
- Standardize on @sourcegraph/ui `(PR #6070)`
- Upgrade Svelte version `(PR #6040)`
- Upgrade unplugin-icon and icon type definitions `(PR #6016)`

#### Release

- Update consts and stiched migration graph for 6.6 `(PR #6644)`
  - NA - Internal change

#### Release

- Cadvisor image default WARN log level `(PR #6516)`
  - Cadvisor image is now logging using WARN level by default

#### Wolfi-Images/Cloud-Mi2

- Upgrade nodejs to v22.17.0 `(PR #6417)`

#### Others

- Upgrade uikit to latest version `(PR #6576)`
- Fix some logspam `(PR #6470)`
- Use more standard site-admin check `(PR #6349)`
- CI removing upload to demo workflow `(PR #6225)`
  - DINF-1196 has all details

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.6.x] Merge Cody ignore and context filters for both dotcom and enterprise `(PR #6749)`
  -  Backport c201fd4027ba118b2c8a0cd089003638f13db429 from #6593
- [Backport 6.6.x] Update Cody Web to 0.33.0 `(PR #6737)`
- [Backport 6.6.x] Use iterator methods for filtering `(PR #6672)`
- Removes DeepSearch from pricing table on free tier `(PR #6641)`
- UI fix on workspaces.sourcegraph.com for users with no workspace but able to join `(PR #6613)`
- Update copy on confirmation modal to be code-host agnostic `(PR #6610)`
- Adjust new dot com specific UI `(PR #6602)`
- Feat(deep search): Implemented dotcom gating for deepsearch `(PR #6589)`
  -
- Zoekt: try to reduce memory usage of zoektFileMatchToMultilineMatches `(PR #6561)`
- Msp: support custom OTEL config `(PR #6557)`
- Sg/msp: support single-env ops docs `(PR #6554)`
- Ep: warn when trying to add sourcegraph user `(PR #6531)`
- Chore(batches) add new test to ensure pushed-only changesets can transition to published state `(PR #6529)`
- Workspaces: ignore workspace-not-found on deletion `(PR #6528)`
- Feat(deepsearch) - CORE-1181: Added QuotaUsage information to HandleRetrieveDeepSearchs response `(PR #6527)`
  - Added QuotaUsage information to HandleRetrieveDeepSearchs
- Improves the UI and copy of the PlanPage for workspaces `(PR #6522)`
- Add dot com UI for 6.6 `(PR #6521)`
- Reduce output verbosity of SCIP groundtruth targets `(PR #6518)`
- Chore(deep search): migrated `commit_search` tool to server `(PR #6508)`
- [CORE-1158] deepsearch: Added store for quota checks `(PR #6506)`
  - Added store layer for tracking deep search queries
- Gitlab: Gracefully handle bad token when listing scopes `(PR #6495)`
- Gitab: Add all repos scope resolver `(PR #6494)`
- Bug(deep search): replaced compaction and turn limit with token limit `(PR #6485)`
  - Replaced turn limits in deep search with a token limit
- Doc: Update architecture diagram svg `(PR #6458)`
- Ep: more copy fixups `(PR #6457)`
- Re-add missing system prompt `(PR #6455)`
- Deepsearch: add stub gating.Provider for DS metering/enforcement `(PR #6443)`
- Web: Fix eslint not picking up changes to GQL `(PR #6439)`
- Idp: Advertise PKCE support in OIDC discovery `(PR #6434)`
- Ep: branding tweaks `(PR #6418)`
- Ep: add backend usage telemetry `(PR #6415)`
- Cody-gateway: add sg_actor_id, sg_actor_anonymous_uid for rate-limited events `(PR #6414)`
- Add query logging to private metadata for search.submit events in sveâ€¦ `(PR #6397)`
- Ep: fix analytics enablement instructions `(PR #6396)`
- Ep: slight copy fixups `(PR #6391)`
- Oidc: Fix empty displayName and improve claim precedence `(PR #6388)`
- Adds new UI for template experience `(PR #6387)`
- Feature(release): improve schema syncer tool json output `(PR #6369)`
  - Feature(release): improve the schema marshalling in the release schema syncher tool
- Update Cody Web to 0.32.9 in react web app `(PR #6360)`
- Web: Fix eslint autofixable errors `(PR #6357)`
- Ep: show button for Entitle link on internal pages to sourcegraph teammates `(PR #6345)`
- Dotcom, workspaces: shut down cody after codyprosunset.SunsetDate `(PR #6343)`
- Workspaces: remove price reference to Cody Pro `(PR #6335)`
- Dotcomgating: support siteconfig fallback for SAMS options `(PR #6311)`
- Completions: remove 'cody.completions:complete' event `(PR #6310)`
- Cody: remove token-usage manager `(PR #6309)`
- Added license key lookup page `(PR #6307)`
- Source: Add workspace functions for Bitbucket Cloud client `(PR #6298)`
- Update Cody Web to 0.32.9 `(PR #6296)`
- Gateway: Drop benchmarking endpoints `(PR #6287)`
- Dotcom: Implement dotcom gating provider `(PR #6286)`
- Workspaces: Set up for Teams name change `(PR #6284)`
- Completions: only record disabled reasons in trace `(PR #6282)`
- Gateway: support OpenAI models for autocomplete `(PR #6272)`
- Multitenant(fix): Fix workspaces and instance internal debug pages UI `(PR #6263)`
- Idp: Show UIs by default `(PR #6245)`
- Dotcom: update Enterprise Starter CTA to omit AI stuff `(PR #6240)`
- Fede/ep UI fix left nav `(PR #6230)`
- CI: remove scip-go upload to demo.sourcegraph.com `(PR #6220)`
  - [https://sourcegraph.slack.com/archives/C04MYFW01NV/p1750800014304569](https://sourcegraph.slack.com/archives/C04MYFW01NV/p1750800014304569)
  - Removed failing upload process that was causing CI errors
- Polished EP UI `(PR #6207)`
- Completions/aws-sdk-compatibility `(PR #6198)`
- Feat(deep search): single URL for deepsearch [SPLF-1207] `(PR #6181)`
  - Deep search URLs are now directly shareable
- Msp/otelcol: use googlecloud exporter for metrics `(PR #6171)`
- Idp: Add consent notification emails `(PR #6141)`
- Txemail: Add interface to make mocking nicer `(PR #6140)`
- Removes dot from create workspace button `(PR #6139)`
- Style Fixes homepage `(PR #6138)`
- Add Cody Deprecation Notice `(PR #6103)`
  - Cody will be deprecated on July 23rd 2025.
- Dotcom: remove Cody from footer link `(PR #6076)`
- Fix(dev infra): add dev proxy request cancellation propagation `(PR #6075)`
- Update sensitive metadata allowlist `cody.autoedit` events to include `languageId` `(PR #6073)`
- Enterpriseportal/iam: document problems with schema `(PR #6069)`
- Fix(deep search): preserve conversation title on update `(PR #6029)`
- Reduce local syntactic replicas, improve codeintel run configuration `(PR #5742)`

{/* RSS={"version":"v6.6.0", "releasedAt": "2025-07-24"} */}


# 6.5 Patch 2

## v6.5.2654

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.5.2654)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.5.2654)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.5.2654)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.5.2654)

### Fix

#### Insights

- Skip empty repos for inventory insights `(PR #6271)`
  - Fix(insights): skip empty repos for inventory insights  Backport beee9d2241a4d3e854ac06ef8b5d8d000bd84a69 from #6250

#### Migrator

- Remove links to sourcegraph/sourcegraph repo in drift summary `(PR #6496)`
  - Fix(migrator): remove private repo links in migrator drift output Backport 4ae3c3a6b6d60bb99421293df830a9e63a53ae01 from #6463

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- Backport 6360 to 6.5.x `(PR #6492)`
- [Backport 6.5.x] dotcom, workspaces: shut down cody after codyprosunset.SunsetDate `(PR #6344)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- [Backport 6.5.x] tenant/reconciler: add notice reconciler for codyplgsunset `(PR #6218)`
- Add experimental icon + code host limits to pushed-only changesets UI `(PR #6215)`
  - Add experimental icon + GitLab/GitHub only specification for pushed-only changesets in batch changes UIBackport 04be437 from #6180
- [Backport 6.5.x] llmapitelemetry: fix traceparent metadata field `(PR #6209)`
- Add a new Code Insight for tracking inventory statistics over time `(PR #6202)`
  - Combines features of the Language usage and Detect and track patterns insights to track code inventory metrics over time:
    - Lines of code
    - Size of code
    - File counts
  - Can group those metrics by repository, by language, or not at all
  - Can collect the metrics for a list of repositories, or a repo search query
- Add graphql endpoints for inventory stats insight `(PR #6201)`
  - New GraphQL endpoints
    - Query:
      - InventoryStatsPreview
    - Mutation:
      - CreateInventoryStatsInsight
      - UpdateInventoryStatsInsight
- [Backport 6.5.x] multitenant(fix): Fix Add repositories UI picker `(PR #6192)`

{/* RSS={"version":"v6.5.2654", "releasedAt": "2025-07-09"} */}


# 6.5 Patch 1

## v6.5.1211

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.5.1211)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.5.1211)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.5.1211)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.5.1211)

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.5.x] Remove sourcegraph repos from go to def tool description `(PR #6356)`

{/* RSS={"version":"v6.5.1211", "releasedAt": "2025-07-01"} */}


# 6.5 Patch 0

## v6.5.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.5.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.5.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.5.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.5.0)

### Features

#### Batch Changes

- Add experimental icon + code host limits to pushed-only changesets UI `(PR #6215)`
  - Add experimental icon + GitLab/GitHub only specification for pushed-only changesets in batch changes UIBackport 04be437 from #6180
- Add batchSpecLibraryRecord API `(PR #5982)`
- Enable gitlab v0 functionality for pushed-only changesets `(PR #5974)`
- Enable bulk ops for pushed-only-changesets (github only) `(PR #5796)`
  - Add 'push only' bulk operation for Github

#### Ci

- Add TSV tracking for pushed Docker images `(PR #5733)`
- Add the rights tags depending on where we push too + tests `(PR #5221)`

#### Cloud

- Cloud-relay process all handlers and slo parsing added `(PR #5438)`

#### Completions

- Always calculate and return credits, round up calculations `(PR #5817)`

#### Deepsearch

- Add tooltip when share button is disabled `(PR #6021)`
- Introduce transitions `(PR #6007)`
- Add Deep Search intro modal `(PR #6005)`
- Initial UI for sharing threads `(PR #5954)`
- Add API to rotate read token `(PR #5948)`
- Add commit search card `(PR #5922)`
- Add GetContributorReposTool card `(PR #5920)`
- Hide follow-up suggestions with ESC `(PR #5906)`
- Unify modal system for diagrams `(PR #5905)`
- Add copy button to mermaid diagrams `(PR #5882)`
- Force repo filter when using commit search `(PR #5760)`
- Improve homepage `(PR #5756)`
- Rebalance UI (Part 1) `(PR #5729)`
- Introduce full file previews `(PR #5677)`
- Make panes resizeable panels instead `(PR #5675)`
- Conversation left, sources right layout `(PR #5621)`
- Make file icons use language icon where applicable `(PR #5517)`
- Report what tool we are executing before it finishes (SPLF-1017) `(PR #5465)`

#### Dev

- Add web-next-optin feature flag to control gradual rollout of Svelte pages `(PR #5780)`

#### Enterprise-Portal

- Update subscription fields `(PR #5736)`
- Subscription details page with archive logic `(PR #5710)`
- List subscriptions page UI `(PR #5700)`
- ArchiveEnterpriseSubscription RPC handler `(PR #5636)`

#### Ep

- Create subscription UI `(PR #5734)`
- Implement UpdateEnterpriseSubscription RPC handler `(PR #5678)`
- Implement RevokeEnterpriseSubscriptionLicense RPC handler `(PR #5577)`
- Implement CreateEnterpriseSubscriptionLicense RPC handler `(PR #5575)`
- Implement CreateEnterpriseSubscription RPC handler `(PR #5554)`

#### Msp

- Sg msp (cloudrun|traces|metrics|rollouts|alerts) `(PR #5795)`
- More health probe types `(PR #5691)`
- Alert for datastream issues when publications are enabled `(PR #5546)`
- Hint exact entitle links, update outdated links `(PR #5526)`
- Custom entitle links `(PR #5503)`
- Rollouts promotion strategy `(PR #5474)`
- Otelcollector sidecar `(PR #5464)`

#### Msp/Operationdocs

- Account for automatic promotion rollouts `(PR #5537)`

#### Release

- Add granular telemetry for external databases `(PR #5739)`
  - [telemetry] add granular database telemetry.
- Create workflows to trigger and create graphQL pipelines `(PR #5299)`

#### Release

- Fix handler initialization and add testing `(PR #5975)`
  - Correct handler init for gcp and aws clients in releaseplatform, add testing
- ConnectRPC endpoints for VerifyExecutorsRelease `(PR #5972)`
  - Releaseplatform: add rpc endpoint for VerifyExecutorsWorkflow
- Add support for aws and gcp client initialization options `(PR #5916)`
  - Releaseplatform: added secret injection to aws and gcp clients
- Add aws verification to temporal executors check workflow `(PR #5529)`
  - Add aws verification to VerifyExecutorsRelease temporal workflow

#### Rerun-Changesets

- Warn when rerunning a changeset triggers more changesets to be rerun `(PR #5426)`
  - GIN index to efficiently search workspace by changesetSpec
  - Resolver endpoint to get workspace from changesetSpec
  - UI warning in preview step

#### Search

- Add a new Code Insight for tracking inventory statistics over time `(PR #6202)`
  - Combines features of the Language usage and Detect and track patterns insights to track code inventory metrics over time:
    - Lines of code
    - Size of code
    - File counts
  - Can group those metrics by repository, by language, or not at all
  - Can collect the metrics for a list of repositories, or a repo search query  Backport e5a5779e01a0e9cef1e29020c3ab173b44f19be2 from #5397
- Add graphql endpoints for inventory stats insight `(PR #6201)`
  - New GraphQL endpoints
    - Query:
      - InventoryStatsPreview
    - Mutation:
      - CreateInventoryStatsInsight
      - UpdateInventoryStatsInsight
 Backport 3c7681e462152cdc401148bd679b1d2924a6d639 from #5566
- Expose Inventory settings in site config `(PR #5506)`
  - The Inventory environment variables have been moved into site config settings (in the "inventory" section):
    - USE_ENHANCED_LANGUAGE_DETECTION: "disableEnhancedLanguageDetection" (defaults to false)
    - GET_INVENTORY_GIT_SERVER_CONCURRENCY: "gitServerConcurrency" (defaults to 4)
    - GET_INVENTORY_REDIS_CONCURRENCY: "redisConcurrency" (defaults to 20)
    - GET_INVENTORY_MAX_INV_IN_MEMORY: "maxInventoryInMemory" (defaults to 1000)
    - GET_INVENTORY_TIMEOUT: "timeoutInMinutes" (defaults to 5)

#### Sg

- 'fleet' reports multi-stage pipelines and db publications `(PR #5528)`

#### Sg/Msp

- Add 'sg msp init env --clone-from=ENV' `(PR #6034)`
- Add 'sg msp entitle' command `(PR #5583)`

#### Source

- Gate service accounts based on Explicit Permissions feature `(PR #6113)`
- Allow filtering by account type `(PR #6098)`
- Tweak service account pages to be a bit friendlier `(PR #6043)`
- Add SERVICE_ACCOUNT rbac role `(PR #6009)`
- Allow granting access to all to repositories in the UI `(PR #5812)`
- Add unrestricted_repo_access option for users `(PR #5752)`
- Allow site-admins to create service accounts `(PR #5628)`

#### Telemetry

- Improve updateCheck to check for canonical version `(PR #5789)`
  - Feat(telemetry): add canonical PG version check for detecting external db usage

#### Workspaces

- Redirect users to homepage on 404, suspended `(PR #5533)`

#### Others

- Use TCP startup probe to otel-collector sidecar `(PR #5913)`
- Add a tooltip on the retry button `(PR #5607)`
  - Adds a tooltip to the retry button on the batch changes preview page.image

### Fix

#### Batch Changes

- GitLab webhooks for merge requests not associated with batch changes now return HTTP 204 instead of HTTP 500 errors `(PR #6185)`
  - Fix(batches): GitLab webhooks for merge requests not associated with batch changes now return HTTP 204 instead of HTTP 500 errors  Backport b5e926187d14784ea9a51fefca626379a25bda3e from #6052
- Don't sync changesets from soft-deleted namespaces `(PR #6039)`
  - Fix(batches): fixed an issue where Batch Changes would attempt to sync changesets from deleted namespaces resulting in delays and timeouts for active changesets
- Update docs link `(PR #5955)`
- Fix label unmarshalling for gitlab events `(PR #5782)`
  - Fix(batches): fixed an issue where GitLab merge request events would fail to handle labels

#### Client

- Use forks vitest pool for branded `(PR #5626)`

#### Cody

- Update output limit for opus4 `(PR #5689)`

#### Cody-Gateway

- Update Claude 4 sonnet model tiers `(PR #5543)`
  - Green ci

#### Deepsearch

- Conversation side bar bug fixes `(PR #6148)`
- Adds delete confirmation modal `(PR #6118)`
- Vertically center refresh button for upfront prompt suggestions `(PR #6115)`
- Center intro modal, darken background and add dismiss animation `(PR #6058)`
- Gives cancel icon margin top to align with question better `(PR #6054)`
- Fixes ui bleeding offscreen `(PR #6053)`
- Add color back to conversation pane `(PR #6046)`
- Add Deep Search title back in and offset UI `(PR #6038)`
- Add info text if new share link has not been generated yet `(PR #6023)`
- Increase likelihood go-to-def and find-references uses syntactic or precise data `(PR #6018)`
- Reduce search input width `(PR #6012)`
- Add opacity to input placeholder `(PR #6008)`
- Example query and search input visual tweaks `(PR #6006)`
- Minimise query examples `(PR #6001)`
- Improve Deep Search homepage `(PR #5980)`
- Fix circular dependency in deep search tools `(PR #5953)`
- Exclude first and last turn `(PR #5923)`
- Make answer code highlighting styled differently `(PR #5919)`
- Change placeholder inputs `(PR #5892)`
- Fail mermaid tool call if result cannot be parsed `(PR #5881)`
- Stop page jumping `(PR #5871)`
- Update input placeholder `(PR #5868)`
- Fixes funky layout issues `(PR #5867)`
- Fix title truncation `(PR #5866)`
- Handle non-utf8 data in get_contributor_data `(PR #5848)`
- Show code host icon `(PR #5844)`
- Tweaks to @-mentions menu `(PR #5839)`
- Make conversation history list fancier `(PR #5757)`
- Tweak source list height `(PR #5753)`
- Fix code excerpts `(PR #5705)`
- Consistently apply truncation to repo name `(PR #5704)`
- Add code bg to code preview `(PR #5672)`
- Suppress rendering diagrams with errors (SPLF-1060) `(PR #5610)`
- Remove "Running" before tool display name `(PR #5561)`
- Make footer more subtle and add finder link `(PR #5560)`
- Improve submit button `(PR #5524)`
- Make docs link more compact `(PR #5521)`
- Improve date handling in commit search tool (SPLF-1043) `(PR #5501)`

#### Dev

- Hide logspam in gazelle about generation_mode `(PR #5630)`

#### Msp

- Include timeout in MaximumStartupLatencySeconds `(PR #5847)`

#### Msp/Rollouts

- Fix automation SA `(PR #5505)`

#### Notebooks

- Fix notebook page loading error `(PR #6152)`

#### Pre-Commit

- Don't flag service account configuration as a credential `(PR #5532)`
  - Make google cred pre commit hook more precise

#### Release

- Verify glibc version in postgresql images `(PR #5670)`
  - Release: add container test to verify `glibc` version does not get unintentionally upgraded in PostgreSQL container images`

#### Release

- Pin containerd version in executor build `(PR #5643)`

#### Search

- Allow users to see all public search contexts `(PR #5888)`
- Do not suggest deprecated search filters `(PR #5551)`

#### Source

- Don't show warning while settings are loading `(PR #6037)`
- Add store tests for AddUserToRepo and RemoveUserFromRepo `(PR #6010)`
- Explicit permissions pagination `(PR #5965)`
- Retry watching executor pods `(PR #5813)`
- Handle 429 TooManyRequest responses from GitHub `(PR #5787)`
  - Fixed an issue where Sourcegraph was not handling rate limit responses from GitHub correctly.
- Bottom margin removed from service account tooltip `(PR #5746)`
- Remove string as a default for boolean from schema `(PR #5717)`
- Change auth provider URL type to NormalizedURL `(PR #5714)`

#### Others

- Leftover comment with dbperms `(PR #5976)`
- Make menu separators uniform with React version `(PR #5901)`
- Visually update fuzzy finder `(PR #5886)`
- Correctly handle different kinds of paths for scip-syntax `(PR #5627)`
- Minor tweaks to feedback modal `(PR #5594)`

### Chore

#### Batch Changes

- Build out metadata enrichment process for gitlab pushed-only changesets, COPY `(PR #6032)`
  - For some reason, PR 5995 got rebased in a weird way via git-spice, causing it to not get merged to [main](https://github.com/sourcegraph/sourcegraph/tree/main) when its base PR (5974) got merged. This is just us re-issuing PR [https://github.com/sourcegraph/sourcegraph/pull/5995](https://github.com/sourcegraph/sourcegraph/pull/5995).
- Remove feature flag for pushed-only changesets `(PR #5816)`
  - Remove feature flag for pushed-only changesets

#### Deepsearch

- Re-add pages if more than 4 charts on one answer `(PR #6143)`
- Remove link to mermaid live editor `(PR #5880)`
- Remove AI disclaimer `(PR #5762)`
- Move markdown styling into separate file `(PR #5593)`
- Add user friendly display names for tools `(PR #5540)`
- Simplify question state management [SPLF-1023] `(PR #5472)`

#### Dev

- Run svelte-check on all files in CI `(PR #5737)`
- Cleanup root package.json `(PR #5495)`
- Cleanup non-client package dependencies `(PR #5488)`
- Cleanup client/wildcard dependencies `(PR #5424)`

#### Frontend

- Update gitignore to include `*.d.ts` files in the `client/ui/` dir `(PR #5798)`
  - Update gitignore to include `*.d.ts` files in the `client/ui/` dir

#### Msp

- Rename healthProbes.probeType to healthProbes.type `(PR #5720)`
- Downgrade Sentry provider `(PR #5685)`
- Upgrade CDKTF providers `(PR #5645)`
- Move xdomainloginservice to subpackage of userauth `(PR #5612)`
- Set DeletionProtectionEnabled on Cloud SQL `(PR #5611)`

#### Release

- Src-cli 6.3.0 update `(PR #5534)`
  - Release: `src-cli` release docs

#### Search

- Fine-tune inventory stats insights `(PR #6204)`
- Implement the create and edit pages + resolvers for the new Repo Stats insight `(PR #6203)`

#### Source

- Remove localhost in favour of 127.0.0.1 `(PR #5981)`
- Remove !go pointer force from object fields `(PR #5699)`

#### Others

- Upd msp delivery for msp-testbed `(PR #5999)`
- Cleanup leftover agents code `(PR #5978)`
- Update datastream alert name and description for clarity `(PR #5693)`
- Make externally unused public functions private `(PR #5613)`
- Fix flaky test `(PR #5518)`

### Refactor

#### Authz

- Remove logging from subrepo perms `(PR #5740)`

#### Ep

- Renamed EnterpriseSubscriptionLicenseType enum to follow Go conventions `(PR #5484)`

### Reverts

- Revert layout updates `(PR #-1)`
- Revert "chore(batches): extract pushed-only changeset metadata into unique struct + simplify frontend hyperlinking" `(PR #5759)`

### Uncategorized

#### Others

- [Backport 6.5.x] tenant/reconciler: add notice reconciler for codyplgsunset `(PR #6218)`
- [Backport 6.5.x] llmapitelemetry: fix traceparent metadata field `(PR #6209)`
- [Backport 6.5.x] multitenant(fix): Fix Add repositories UI picker `(PR #6192)`
- [Backport 6.5.x] fix(deep search): Fix follow up bug `(PR #6179)`
- [Backport 6.5.x] bug(deep search): fix route invalidation globally `(PR #6175)`
- [Backport 6.5.x] feat(deep search): simplify state management via API [SPLF-1166] `(PR #6146)`
- [Backport 6.5.x] deepsearch: fix tiny mermaid shards in tool results `(PR #6132)`
- [Backport 6.5.x] search(fix): Fix Welcome Overlay UI position `(PR #6102)`
- Modelconfig: mark smart-apply-qwen-default as "stable" correctly `(PR #6035)`
- Fix(deep search): Use `$state.snapshot` when syncing local thread state [SPLF-1178] `(PR #6028)`
- Web: remove Cody upsell in navbar `(PR #6027)`
- Workspaces-switcher: use globe icon for public code search `(PR #6026)`
- Feat(deep search): added error pages for deep search routes `(PR #6025)`
- Bug(deep search): fixed sidebar resizing `(PR #6024)`
- Bug(deep search): fixes missing repo foreign key errors [SPLF-1169] `(PR #6022)`
- Trace: Improve lock contention on tracer `(PR #6019)`
- Feat(deep search): Config for enabling/disabling thread sharing globally on the instance [SPLF-1115] `(PR #5997)`
  - Deepsearch thread sharing can be enabled or disabled globally on an instance
- Cody/chat: redirect to deepsearch or search in dotcom and workspaces `(PR #5994)`
- Sg/live: add dotcom-dev alias, add aliases for MSP services `(PR #5993)`
- Update Cody Web to 0.32.8 `(PR #5991)`
- Feat(deep search): disabled repo permission checks by default [SPLF-1149] `(PR #5979)`
  - Defaults repo permission checks for sharing deep searches off.
- Feat(deep search): server based routing for deepsearch [SPLF-1110][SPLF-1109] `(PR #5977)`
  - Adds server based routes for deep search
- Dotcom: fix in-web-app redirect to workspaces `(PR #5971)`
- Localdev: improve dotcom DX `(PR #5970)`
- Dotcom: always enable workspaces switcher `(PR #5952)`
- Codyplg: disable Cody Free for users created after sunset date `(PR #5951)`
- Cody: apply post-sunset behaviour to all cody.IsCodyEnabled checks `(PR #5950)`
- Workspaces: more tweaks for public code search row `(PR #5947)`
- Jscontext: fixup injected time `(PR #5944)`
- Workspaces: make public code search conditional `(PR #5940)`
- Fx workspace storybook demos `(PR #5939)`
- Workspaces: make public code search option off-by-default, remove border `(PR #5936)`
- Cody Pro Sunset: schedule subscription changes `(PR #5933)`
- Completions: add special cody_debug:::{} prompt syntax site admins can use to measure latency `(PR #5918)`
  - Test: added special debug syntax usable by site admins to measure completions latency.
- Bedrock: do not discard IAM machine-credential authentication cache; add support for latency optimized inference `(PR #5917)`
  - Bedrock: added support for AWS Bedrock Latency Optimized Inference which can reduce autocomplete latency with e.g. Haiku 3.5 models by as much as 40%.
  - Bedrock: fixed an issue where Cody's AWS Bedrock implementation would incorrectly discard the IAM machine-credential cache, making static access tokens potentially faster in older versions.
- Workspaces: make public code search more prominent `(PR #5910)`
- Executors: Report less metrics on GCP `(PR #5896)`
- Feat(deep search): Repo permissioning in deepsearch [SPLF-1108] `(PR #5883)`
  - Adds repo and sub-repo permissioning for deep search threads to enable sharing
- Migrate sourcegraph workspaces web client to @sourcegraph/uikit `(PR #5800)`
- Workspaces/internal: show last state change `(PR #5794)`
- Rbac: Add missing repo permission enum value `(PR #5792)`
- Feat(deep search): backend persistence for thread sharing `(PR #5778)`
  - Deep search threads are persisted in the database allowing for thread sharing
- Executor-vm: Ensure we always build for amd64 `(PR #5773)`
- Sg/msp: suggest 'gcloud auth application-default login' on perm issue `(PR #5764)`
- Sourcegraph: CORE-935 Unify bedrock anthropic request parameters with direct anthropic request parameters `(PR #5730)`
- Deep search: return JSON error from completions/stream `(PR #5723)`
  - With this change we return JSON errors from the `completions/stream` endpoint. Before we returned plain text errors.
- Executors: Always use legacy iptables `(PR #5698)`
- Release: Bump backcompat test target to 6.4 `(PR #5697)`
- Executor: Upgrade base VM image again `(PR #5695)`
- Executor: Upgrade various components `(PR #5694)`
- Executor: Actually bump executor-vm image to new ubuntu version `(PR #5688)`
- Bug(deepsearch): prefix all deepsearch prompts with a whitelisted prefix `(PR #5687)`
- Chore(deep search): added tool id to analytics metadata and a source.clicked analytics event `(PR #5673)`
- Feat(deep search): generate title from question [SPLF-1072] `(PR #5671)`
- Amp-pruner: create MSP job for deleting attachments `(PR #5648)`
- Executors: Bump base VM to ubuntu 24.04 `(PR #5637)`
- Executors: Upgrade CNI plugins `(PR #5631)`
- Removed RPC dependencies from database enum types `(PR #5598)`
- Switch autoedit model with better context understanding `(PR #5582)`
- Bug(deep search): retain button strip when side bar open `(PR #5567)`
- Chore(deep search): split ExampleQueries and TurnLimit into separate components `(PR #5565)`
- Feat(deep search): only show follow ups when input is focused [SPLF-1050] `(PR #5564)`
- Bump buf dependency version to fix deprecations `(PR #5523)`
- Implemented ListEnterpriseSubscriptionLicenses rpc `(PR #5513)`
- Agent.md: hint to use go doc `(PR #5500)`
- Add Deep Search tools UI `(PR #5441)`
- Authz: Drop old legacy tables `(PR #5408)`
- Remove cody from workspace and dotcom plans pages - For 6.5 release `(PR #5385)`
- Remove BillingMetadata from telemetry in ValidateChangesetSpecs `(PR #5298)`
- To focus ES on code search, skip the editor install step during onboarding - For 6.5 release `(PR #5103)`
  - During onboarding, skip the "install Cody in your IDE" step
- Authz: Add UI for explicit repo permissions `(PR #5082)`

{/* RSS={"version":"v6.5.0", "releasedAt": "2025-06-25"} */}


# 6.4 Patch 3

## v6.4.3889

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.4.3889)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.4.3889)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.4.3889)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.4.3889)

### Fix

#### Batch Changes

- Don't sync changesets from soft-deleted namespaces (#6039) `(PR #6061)`
  - Fix(batches): fixed an issue where Batch Changes would attempt to sync changesets from deleted namespaces resulting in delays and timeouts for active changesets

### Reverts

  There were no reverts for this release

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- [Backport 6.4.x] bitbucket: Fix panic with nil logger `(PR #5605)`
- Move grafana dashboards for retry to proper section `(PR #5603)`
  - N/A  Backport 413705d76b9e4b258f3718f884e3c3c2ddf4f6fd from #5602
- Gitserver: have gitserver try re-running commands before marking repositories as corrupt `(PR #5584)`
  - N/A
  Backport 4e0ca00f1e5fb1951a0f24bb7ccb3af918ce33ec from #5531
- Fix repository package names `(PR #5581)`
- [Backport 6.4.x] feat(deep search): add current stats to telemetry `(PR #5563)`
- Remove "Outdated" stats on permissions page `(PR #5553)`
  -  Backport 484e546eca171cc184c86cf2cf7119f358f4bc02 from #5515

{/* RSS={"version":"v6.4.3889", "releasedAt": "2025-06-18"} */}


# 6.4 Patch 2

## v6.4.2622

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.4.2622)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.4.2622)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.4.2622)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.4.2622)

### Features

#### Source

- Gitserver: have gitserver try re-running commands before marking repositories as corrupt `(PR #5584)`
  - N/A
  Backport 4e0ca00f1e5fb1951a0f24bb7ccb3af918ce33ec from #5531

### Fix

#### Gitserver

- Move grafana dashboards for retry to proper section `(PR #5603)`
  - N/A  Backport 413705d76b9e4b258f3718f884e3c3c2ddf4f6fd from #5602

#### Search

- Fix repository package names `(PR #5581)`

#### Source

- Retry watching executor pods (#5813) `(PR #5900)`
  - @sourcegraph/release

### Chore

#### Source

- Remove "Outdated" stats on permissions page `(PR #5553)`
  -  Backport 484e546eca171cc184c86cf2cf7119f358f4bc02 from #5515

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- Deep search: fix race condition in model validation `(PR #5890)`
  - This fixes the error "ModelConfigService not initialized. Init not called" which might occur during startup. The error was caused by a race condition where the validator of the Deep Search site config expected the model config service to be initialized.
- [Backport 6.4.x] bitbucket: Fix panic with nil logger `(PR #5605)`
- [Backport 6.4.x] feat(deep search): add current stats to telemetry `(PR #5563)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- [Backport 6.4.x] feat(cody gateway): Claude 4 models `(PR #5536)`
- [Backport 6.4.x] cody-gateway-config: allow Enterprise tier, rename misleading method `(PR #5535)`
- [Backport 6.4.x] azure-devops: Add support for Entra OAuth apps `(PR #5520)`

{/* RSS={"version":"v6.4.2622", "releasedAt": "2025-06-11"} */}


# 6.4 Patch 1

## v6.4.1203

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.4.1203)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.4.1203)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.4.1203)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.4.1203)

### Fix

#### Release

- Verify glibc version in postgresql images `(PR #5735)`
  - Release: add container test to verify `glibc` version does not get unintentionally upgraded in PostgreSQL container images`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- Backport executor PRs `(PR #5725)`

{/* RSS={"version":"v6.4.1203", "releasedAt": "2025-06-03"} */}


# 6.4 Patch 0

## v6.4.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.4.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.4.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.4.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.4.0)

### Features

#### Auto-Edit

- Update the deployment to IOWA region `(PR #5166)`
- Update the next cursor prediction model `(PR #5092)`

#### Autoedit

- Propagate the rewrite speculation parameter for completions `(PR #5190)`

#### Batch Changes

- Site admins can feature library records `(PR #5415)`
  - Feat(batches): site admins can feature library records
- Add site admin setting to configure the number of displayed batch spec library records `(PR #5317)`
  - Feat(batches): Add site admin setting to configure the number of displayed batch spec library records
- Add partial changesets, part 1 `(PR #5172)`
- Auto-merge for github code hosts `(PR #4977)`
  - Feat(batches): auto-merge for github code hosts

#### Code Intelligence

- Syntactic indexing for C `(PR #5163)`
- TypeScript syntactic indexing support `(PR #5044)`
  - Add TypeScript syntactic indexing support

#### Cody

- Update the Context Limit for Gemini 2.5 Models `(PR #5322)`
- Support client provided URL, model and apiKey for websocket proxy `(PR #5030)`
- Create a new loopback endpoint in cody-gateway `(PR #4941)`

#### Codygateway

- Instrument events publishing with metric `(PR #5347)`
- Insert 'metadata.event_id' for manual dedupe `(PR #5084)`

#### Deepsearch

- Make stop button cooler `(PR #5449)`
- Add AI disclaimer `(PR #5436)`
- Improved NLS Search Tool block `(PR #5427)`
- Add follow up question suggestions [SPLF-1022] `(PR #5410)`
  - Added suggested follow ups to deepsearch
- Add codegraph tool cards `(PR #5404)`
  - Custom tool cards for GoToDefinition and FindReferences
- Add go-to-definition and find-references tools [SPLF-992] `(PR #5373)`
- Add copy button to code blocks in answer `(PR #5342)`
- Add syntax highlighting to markdown rendering (SPLF-977) `(PR #5297)`
- Render separate block for diagrams (SPLF-982) `(PR #5267)`
- Allow continuation after 20 turns [UI] (SPLF-974) `(PR #5253)`
  - When a deep search reaches it's turn limit, the user will be shown a summary of the search thus far and the next steps to determine if the search should continue
- Mermaid enhancements and fixes `(PR #5245)`
- Add commit and diff search tools to deep search (SPLF-959) `(PR #5223)`

#### Enterprise-Portal

- Added GetEnterpriseSubscription handler for administrationservice ep `(PR #5337)`
  - Adds database-to-proto conversion for enterprise subscriptions and implements the GetEnterpriseSubscription handler in the AdministrationService. This enables user-authenticated access to subscription data via the Administration API.

#### Ep

- Add ListEnterpriseSubscriptions RPC handler to administrationservice `(PR #5396)`
  - This PR adds the ListEnterpriseSubscriptions RPC to the administrationservice, allowing Enterprise Portal to retrieve subscriptions.
It has support for multiple filter types: subscription IDs, archived status, display name, Salesforce data, instance domains, verified domains, and instance types

#### Msp

- Support configuring secondary cidr in vpc network `(PR #5264)`
- Add http-to-https support when cloudflare.proxied: false `(PR #5131)`
- Suggest 'sg update' if validation failed `(PR #5105)`
- Add option to configure session affinity `(PR #5102)`
- Add deploy type 'ignore' for custom deploy `(PR #5087)`
- Support apex domains `(PR #5086)`
- Configure prevent_destroy explicitly on Cloud Run `(PR #5060)`
- Security logs sink `(PR #3683)`

#### Msp/Operationdocs

- Improve rollouts section `(PR #5085)`

#### Release

- Add releaseworker health check `(PR #5367)`
  - N/A - Internal change
- Add connectRPC handlers to API `(PR #5089)`
  - N/A - Not customer facing
- Add release worker service `(PR #4990)`
  - N/A - Internal tooling

#### Search

- Add TotalFiles to the inventory that powers language usage insights `(PR #5340)`
- Add config for an admin to allow Code Insights to ignore sub-repo permissions `(PR #5187)`
  - In the site config, set `experimentalSettings.subRepoPermissions.allowInsights` to `true`
  - Admins can decide if it is safe in their environment to allow Code Insights to generate graphs using data from repositories that use sub-repo permissions.
- Added eval tool for deepsearch `(PR #5160)`
- Collapse/expand search results `(PR #5099)`
  - Adds the ability to collapse/expand search results

#### Searchplatform

- Initial mermaid chart support `(PR #5209)`

#### Sg/Msp

- Improve 'sg msp db' usability `(PR #5078)`
- Allow usage from almost anywhere `(PR #4996)`

#### Source

- Gitserver: have gitserver try re-running commands before marking repositories as corrupt `(PR #5584)`
  - N/A
  Backport 4e0ca00f1e5fb1951a0f24bb7ccb3af918ce33ec from #5531
- Disable janitor if DISABLE_GITSERVER_JANITOR env var is set `(PR #5475)`
  - If the DISABLE_GITSERVER_JANITOR is set, the janitor routines for gitserver will no longer run.
- Remove stale temporary files like .tmp-2128506-pack-abacabadabacaba.pack `(PR #5401)`
- Gitserver: include repoID, CWD, and command arguments when reporting corruption error `(PR #5399)`
  - N/A
- Disable .api/llm/chat/completions for Enterprise Starter `(PR #5200)`
- Add reminder to Amp to clean up binaries that it creates when checking the build `(PR #5134)`
- Oauth: github: add tests to clarify allowOrgs and allowOrgsMap interaction `(PR #5098)`
  - N/A

#### Workspaces

- Track longest duration since destroy_pending or destroy_failed state change `(PR #5135)`
- Fixup google tag manager `(PR #5023)`

#### Others

- Buildtracker tracks nightly builds `(PR #5126)`

### Fix

#### Auto-Edit

- Use integer with unit of millisecond for fireworks latency metrics `(PR #4869)`

#### Cody

- [CORE-827] Added support for Thinking capability for Bedrock Anthropic `(PR #5479)`
- Update MaxOutputTokens for Gemini Thinking Models `(PR #5384)`
- Crashes after adding model selection support `(PR #5171)`

#### Completioncredits

- Fix CompletionCreditsUsage condition `(PR #5153)`

#### Deepsearch

- Adds preview badge to title `(PR #5493)`
- Fix -z-index for conversation title bar `(PR #5489)`
- Fix new answer autoscroll (SPLF-1036) `(PR #5476)`
- Tidy up response blocks in left pane during streaming `(PR #5459)`
- Fix scrolling to new answer `(PR #5456)`
- Reset searcher to null after cancellation `(PR #5454)`
- Improve response blocks `(PR #5420)`
- Fix right pane scrolling and navigation `(PR #5416)`
- Fix bugs with opening and closing diagrams `(PR #5406)`
- Fix indices and navigation for follow up questions `(PR #5405)`
- UI fixes for continuations after hitting turn limit `(PR #5403)`
- Fix and improve UI for diagrams `(PR #5400)`
- Fix typo `(PR #5352)`
- Bump default number of results for commit and diff search `(PR #5296)`
- Fix hardcoded run count `(PR #5248)`

#### Ep

- Add ep web bundle into final binary `(PR #5269)`

#### Gitserver

- Move grafana dashboards for retry to proper section `(PR #5603)`
  - N/A  Backport 413705d76b9e4b258f3718f884e3c3c2ddf4f6fd from #5602

#### Msp

- Support apex domains for no-CF-proxy configuration `(PR #5088)`

#### Msp/Rollouts

- Properly support regional stages `(PR #5458)`

#### Search

- Fix repository package names `(PR #5581)`

#### Sg/Sams

- Use internaldoer when targetting localhost `(PR #5321)`

#### Source

- Gitserver: janitor: emit a log when we fail to gather statistics for optimizing a repository `(PR #5371)`
  - N/A
- Gitserver: janitor: make janitor emit an ERROR level log when optimizing a repository fails `(PR #5370)`
  - N/A
- Gitserver: errors.Wrap call to OptimizeRepository so that we have a shared prefix `(PR #5369)`
  - N/A
- Fix no tenant in context error for gitserver locker debug handler `(PR #5104)`

#### Workspaces

- Fix error message when name is shorter than regex `(PR #5295)`

#### Others

- Accept a blank string in addition to null for feature flag type `(PR #5270)`
- Map ui feature flag type to internal type `(PR #5217)`
- Show correct number of filtered feature flags `(PR #5110)`
  - Fix: show correct number of filtered feature flags
- Exact string match for similar bundle names `(PR #4719)`

### Chore

#### Analytics

- Added interaction id to deep search [SPLF-970] `(PR #5324)`
- Add basic telemetry for deep search for S2 [SPLF-981] `(PR #5320)`

#### Batch Changes

- Add telemetry to record number of changesets merged `(PR #4938)`

#### Code Intelligence

- Syntactic evaluation for C++ `(PR #5258)`
- Syntactic evaluation for C `(PR #5256)`

#### Cody

- Fix token limit `(PR #5368)`

#### Deepsearch

- Add research preview label and feedback mechanism `(PR #5433)`
- Switch Deep Search to use the experimental feature setting `(PR #5429)`
- Handle large files `(PR #5428)`
- Fix icon on react app and add query param support `(PR #5402)`

#### Dev

- Cleanup client/web-sveltekit dependencies `(PR #5360)`
- Cleanup more dependencies from root package.json `(PR #5083)`
- Cleanup client/web dependencies `(PR #4913)`

#### Graphql/Entitlements

- Convert type field to use GraphQL enum `(PR #4892)`

#### Local

- Add check with mise tool \<name\> --json to check if bazelisk is installed `(PR #5141)`

#### Msp

- Upgrade cloudsqlproxy, enable debug logs on --verbose `(PR #5133)`
- Bump pinned cloud-sql-proxy version to latest `(PR #5100)`

#### Msp/Monitoring

- Remove extra reader permission `(PR #5020)`

#### Prompt-Library

- Make copy for automatically running prompts clearer `(PR #5029)`

#### Release

- Release prep for 6.3.0 (#5033) `(PR #5034)`
  - N/A - Internal facing

#### Search

- Show deep search icon on react pages `(PR #5154)`

#### Sg

- Make interrupt quieter `(PR #5077)`

#### Source

- Remove "Outdated" stats on permissions page `(PR #5553)`
  -  Backport 484e546eca171cc184c86cf2cf7119f358f4bc02 from #5515
- Format code and imports `(PR #5364)`
- Use constants for feature names in workspace gating check `(PR #5363)`

#### Telemetrygateway

- Deploy pipeline is in us-west1 now INC-406 `(PR #5453)`
- Reduce cardinality of workspaces data metrics `(PR #5066)`

#### Workspaces

- Allow routerreconciler.upsert to be disabled `(PR #5183)`
- Fixup GTM container again `(PR #5031)`
- Fixup GTM body container injection `(PR #5024)`

#### Others

- Update third-party licenses `(PR #5302)`
- Update third-party licenses `(PR #5192)`
- Update teams.yml for changes in product platform `(PR #5185)`
- Update third-party licenses `(PR #5091)`
- Update @sourcegraph/cody-web version to 0.32.5 `(PR #5026)`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.4.x] bitbucket: Fix panic with nil logger `(PR #5605)`
- [Backport 6.4.x] feat(deep search): add current stats to telemetry `(PR #5563)`
- [Backport 6.4.x] feat(cody gateway): Claude 4 models `(PR #5536)`
- [Backport 6.4.x] cody-gateway-config: allow Enterprise tier, rename misleading method `(PR #5535)`
- [Backport 6.4.x] azure-devops: Add support for Entra OAuth apps `(PR #5520)`
- Authz: Refactor database schema for pending permissions to be more performant `(PR #5466)`
- Add riazanovskiy to team.yml `(PR #5423)`
- Deepsearch(fix): update styling of ReadFileTool `(PR #5421)`
- Authz: Remove writing to old legacy tables `(PR #5407)`
- Add the warm start auto-edit model in backend `(PR #5393)`
- Feat(deep search): Improvements to tools & prompts `(PR #5382)`
- Deepsearch: major layout update `(PR #5380)`
- Modelconfig: fix typo s/unlimited/fallback/g `(PR #5379)`
- Update read file tool prompt to verify files before reading `(PR #5372)`
- Marshal the optional Stop field in CreateChatCompletionRequest more correctly `(PR #5362)`
- Upgrade Cody Web 0.32.6 `(PR #5358)`
- Bug(deepsearch): increment turns by max turns when search is continued `(PR #5350)`
- Add highlighted code block for read file tool call `(PR #5349)`
- Deepsearch: fix height of conversation title header `(PR #5346)`
- Deepsearch: don't cover content at the bottom of the screen `(PR #5345)`
- Deepsearch: fix show more button `(PR #5334)`
- Deepsearch: move diagrams into answer and cap excerpt content `(PR #5330)`
- Agent.md: connectrpc hints `(PR #5323)`
- Remove duplicate mode icon `(PR #5319)`
- Gateway: add ability to mark models as 'unlimited', mark gemini-2.0-flash as unlimited `(PR #5301)`
  - Gateway: added ability to mark models as 'fallback' in model configuration `capabilities` section, which gives models effectively-unlimited rate limits for Cody Pro and Workspaces users.
  - Model config: configuring the default fallback model (similar to default chat/autocomplete model) to use when rate limits have been exceeded is now possible. Future versions of Cody Clients will support this functionality.
  - Gateway: gemini-2.0-flash is now an fallback model, and is the default fallback model.
- Deepsearch: tweak sidebar `(PR #5293)`
- Deepsearch: move stats to turns header `(PR #5291)`
- Add slightly more margin top to query examples `(PR #5289)`
- Deepsearch: move tools button to top left `(PR #5288)`
- Deepsearch: add icon to homescreen `(PR #5287)`
- Deepsearch: remove follow up input background `(PR #5286)`
- Deepsearch: minor UI adjustments `(PR #5285)`
- Deepsearch: fix conversation title `(PR #5284)`
- Deepsearch: add search cancelled label `(PR #5281)`
- Deepsearch: centralise textarea initially `(PR #5280)`
- Update gitlab code host exclude property description `(PR #5277)`
- Agent.md: add guidance for managed services `(PR #5272)`
- Fix spelling: Change 'By organisation' to 'By organization' in Promptâ€¦ `(PR #5265)`
  - Not a substantial change. Purely cosmetic. No Changelog needed.
- Fix typo in SingleServiceMainWithoutConf documentation comment `(PR #5259)`
- Deepsearch: make conversation titles responsive `(PR #5247)`
- Deepsearch: Transform prompt editor input into textarea `(PR #5244)`
- Deepsearch: add search examples `(PR #5243)`
- Deepsearch: fix turn ordering and remove autoscrolling `(PR #5242)`
- Deepsearch: change deep search icon in global nav `(PR #5241)`
- Deepsearch: add thread title, layout tidyups `(PR #5239)`
- Deepsearch: simplify layout `(PR #5236)`
- Deepsearch: move input to bottom of viewport `(PR #5235)`
- Deepsearch: split panes `(PR #5230)`
- Cody-gateway: Fallback event logger is used if no big query configuration is available `(PR #5224)`
- Codemonitors: Move webhooks to stable `(PR #5213)`
- Update Prompts Library Order By `(PR #5211)`
  - Adds new way to sort prompts by relevance.
  - Minor updates to the UI including
a. Make Create new prompt button primary
b. Remove order by name
c. Add order by relevance by default
d. Add pencil icon for edit prompts
- Cody-gatway: Removed legacy cody-gateway code `(PR #5198)`
- Fix TelemetryEventsExportMode docstrings after moving to gating package `(PR #5189)`
- Deps: Bump alertmanager and prometheus dependencies `(PR #5176)`
- Gitserver: Try to fix superfluous WriteHeader logs `(PR #5164)`
- Fix(models.json): mark smart-apply-qwen-default as "stable" `(PR #5151)`
  - Fixed issue where smart-apply-qwen-default model was marked as experimental instead of stable, sometimes leading to a smart apply issue if modelConfiguration excludes experimental models.
- Bug(source): Fix alignment on security dialog `(PR #5150)`
- Remove required login redirect handler for xdomainlogin service `(PR #5142)`
  - Adding RedirectToLoginHandler to the xdomainlogin service is no longer required. If an unauthorized request comes and RedirectToLoginHandler is not registered, we return an unauthorised error. This helps generalise the service for better reuse.
- Squirrel: Add integration smoke test `(PR #5140)`
- Add 'model' key to allowed private metadata for smart apply context `(PR #5123)`
- Reduce number of snapshots and testdata files `(PR #5119)`
- Symbols: Move symbol search to searcher `(PR #5115)`
- Symbols: Refactor config to not use globals `(PR #5114)`
- Symbols: Move LocalCodeIntel implementation to caller `(PR #5113)`
- Symbols: Move SymbolInfo implementation to caller `(PR #5112)`
- Symbols: Move squirrel package to internal `(PR #5111)`
- Only rank non-deleted repositories in position calculation `(PR #5108)`
- Symbols: Remove DisableFileSymbolsParsing setting `(PR #5096)`
- Symbols: Remove Healthz endpoint `(PR #5095)`
- Gitserver: Use instrumented gitservice client `(PR #5093)`
- Queuemetrics: Use ViewName for max duration queued `(PR #5074)`
- Update prompt list UI `(PR #5070)`
- Repoupdater: Move background jobs to worker `(PR #5057)`
- Only check if tracing is enabled when tracelog.logger is created `(PR #5054)`
- Cody-gateway: Allowed to override BigQuery configuration in MSP based version `(PR #5051)`
- Repoupdater: Move monitoring to worker dashboard `(PR #5049)`
- Repoupdater: Replace remaining APIs by service library `(PR #5047)`
- Repoupdater: Replace scheduling API by service library `(PR #5046)`
- Repoupdater: Move scheduler and janitor to internal `(PR #5045)`
- Batches: Remove EnqueueChangesetSync from repoupdater API `(PR #5043)`
- Codeintel: Remove unused PreDequeue condition `(PR #5042)`
- Queuemetrics: Only count jobs ready to be dequeued `(PR #5041)`
- Queuemetrics: Improve name of executor metrics `(PR #5040)`
- Fix merge conflict `(PR #5036)`
- Singleflight: Add tenant aware wrapper `(PR #5028)`
- Amp: Add info about databases and migrations to memory `(PR #5021)`
- Batches: Migrate changeset registry to db-backed pattern `(PR #5019)`
- Gitserver: Use new janitor for all instances `(PR #4981)`
- Dbworker: Add queue metrics `(PR #4961)`
- Treat Gerrit auth provider URL as a NormalizedURL `(PR #4945)`
- Changes spaces to "-" on the edit search contexts page `(PR #4933)`
- Feat(batch changes): [SRCH-1873] rerun change sets from preview page `(PR #4806)`
  - Allow changesets to be rerun from the preview step of batch changes.
- Cody-gateway: Synced default values for MSP and non-MSP versions of configuration `(PR #4737)`
- Repo-updater: Add repo cleanup scheduling and optimization UI `(PR #4547)`
- Database: Cleanup duplicative unique constraints `(PR #4355)`
- Gitserver: Drop gitserver_repos.shard_id column `(PR #4092)`
- Saml: Keep old metadata for longer when upstream is down `(PR #4078)`

{/* RSS={"version":"v6.4.0", "releasedAt": "2025-05-28"} */}


# 6.3 Patch 2

## v6.3.4167

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.3.4167)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.3.4167)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.3.4167)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.3.4167)

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- Claude 4 Available
- [Backport 6.3.x] cody-gateway-config: allow Enterprise tier, rename misleading method `(PR #5541)`

{/* RSS={"version":"v6.3.4167", "releasedAt": "2025-05-23"} */}


# 6.3 Patch 1

## v6.3.2692

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.3.2692)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.3.2692)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.3.2692)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.3.2692)

### Features

#### Code Intelligence

- Add env var to disable precise code intel `(PR #5357)`

#### Tenant/Reconciler

- Ignore deleted workspaces when reporting instance status `(PR #5161)`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.3.x] authz: Reduce updates on pending perms tables `(PR #5365)`
- [Backport 6.3.x] openaicompatible: support custom headers && pure inference through /chat/completions `(PR #5361)`
- [Backport 6.3.x] workspaces: clarify that deletion does not affect Sourcegraph Account `(PR #5273)`

{/* RSS={"version":"v6.3.2692", "releasedAt": "2025-05-14"} */}


# 6.3 Patch 0

## v6.3.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.3.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.3.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.3.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.3.0)

### Features

#### Agents

- Add true positive and impact filters `(PR #4911)`
- Improve task page, abstract out changeset header, add rerun buttons `(PR #4834)`
- Implement agentic chat on top of conversation API `(PR #4809)`
- New agent action menu added `(PR #4761)`
- Allow grader to rewrite or relocate diagnostics [AGENT-302] `(PR #4728)`
  - The grader service can now fix broken diagnostics that come out of a review, hopefully improving quality.
- Add additional graphs and metrics to agent overview `(PR #4709)`
- Reformat overview stats, add user list and CSS tidy ups `(PR #4668)`
- Add feedback page `(PR #4656)`
- Add filters for reviews and diagnostic pages `(PR #4564)`
- Improved agents page `(PR #4557)`
- Add review statuses everywhere `(PR #4520)`
- Generic query param parser `(PR #4434)`
- Add default rules `(PR #4418)`
  - New default for the review setting `rules: ['builtin-rules', 'repo-rules']`. Builtin rules allow you to start using the review agent without creating any `*.rule.md` files.
- Add a dropdown to access sibling reviews from the changeset `(PR #4375)`
- Grade diagnostics before posting [AGENT-196] `(PR #4205)`
  - Adds reflection to the review process to filter out bad diagnostics before posting.

#### Auto-Edit

- Add auto-edit long suggestion model `(PR #4965)`
- Use user's sourcegraph instance endpoint for authentication `(PR #4759)`
- Create a new fireworks backend for fine-tunes-proxy `(PR #4661)`
- Implement websocket upgrade logic for the fine-tuned proxy proxy `(PR #4582)`
- Create a new fireworks proxy service for Cody auto-edit `(PR #4538)`

#### Batch Changes

- Add search for batch changes template library `(PR #4280)`

#### Code Intelligence

- Dont upload empty syntactic indexes `(PR #4738)`

#### Cody

- Add OpenAI o3 and o4-mini models `(PR #4958)`
- Add OpenAI 4.1 models support `(PR #4926)`
- Add gemini 2.5 preview support `(PR #4802)`
- Add entitlements UI to site admin `(PR #4742)`
- Support tool results for anthropic and gemini `(PR #4493)`
- Update context limits (CODY-5022) `(PR #4321)`

#### Cody-Gateway

- Add gemini 2.5 flash preview support `(PR #4970)`

#### Codygateway

- Block Enterprise usage of Google models `(PR #4534)`

#### Completions

- Enable system prompts for all newer Claude models `(PR #4989)`

#### Gitserver

- Add heuristic and eager strategies from Gitaly `(PR #4588)`

#### Graph

- Syntactic for C# `(PR #4236)`

#### Msp

- Allow configurable Cloud SQL version `(PR #4959)`

#### Multi Tenant

- Add coupon sale percentage UI `(PR #4699)`

#### Release

- Add a sg release steps command `(PR #4206)`
  - New internal release command `sg release steps` to be used in pipeline gen

#### Search

- Diff comparison page UI enhancements `(PR #5097)`
  - Users can now filter diffs on the diff comparison page
 Backport a2725da3281de64d2d2e41438222d0f38700e441 from #4398
- Expose ENVs for search jobs config `(PR #4975)`
  -
- Add tool selection and stats to deep search `(PR #4744)`
- Add support for chaining multiple filePaths in URL `(PR #4333)`
  - Add support for chaining multiple filePaths together in URL

#### Searchplatform

- Deep Search Client Side plumbing `(PR #4531)`

#### Source

- Gitserver: add env var for forcing all janitor optimizations to use eager strategy for debug purposes `(PR #4949)`
- Support sub-repo perms for all repo types `(PR #4935)`
- Gitserver: add new chaos testing for git maintenance commands `(PR #4929)`
- Add prometheus dashboards and logs for new janitor `(PR #4861)`
- Adapt Gitaly's stats package and adapt test suite to run in our codebase `(PR #4365)`
  - N/A

#### Telemetry

- Add `billingMetadata` to batch change events `(PR #3732)`

#### Workspaces

- Show admin analytics menulink `(PR #5027)`
  -  Backport 0b9ee7390bca046462737172c39d8ad2e13b99fb from #4652

#### Others

- Syntactic indexing support for C++ `(PR #4606)`
  - Adds support for syntactic indexing for C++
- Unsigned commits warning `(PR #4525)`
  - It is possible for users to have `rejectUnverifiedCommits` site configuration enabled, and also apply changesets without having the necessary configurations for commit signing. This change provides a warning banner during the batch set preview stage in such a case.With commit signing fully configuredWarning showing because no GitHub commit signing configuredimageimage
- Expose relationships through GraphQL API `(PR #4330)`
- Add metrics for periodic goroutines `(PR #4317)`

### Fix

#### Agents

- Delete agents codebase `(PR #4982)`
- Agent intro banner css tweaks `(PR #4912)`
- Fix chunker calculation bug `(PR #4904)`
- Switch to non-thinking agent for diagnostic grader `(PR #4903)`
- Use empty snippets when old revision cannot be found `(PR #4902)`
- Enable new chat pages for old UI `(PR #4896)`
- Update review and task page headers to more clearly show states `(PR #4891)`
- Fixes commit sha badge on review item `(PR #4866)`
- Show correct line range for diagnostics on `diagnostics` page `(PR #4860)`
- Change changeset ordering by default `(PR #4840)`
- Basic tidy ups for conversations page `(PR #4829)`
- Improve changesets page `(PR #4828)`
- Improve styling of repo page `(PR #4827)`
- Minor CSS updates to `rule` page `(PR #4826)`
- Improve `rules` page UX `(PR #4822)`
- Post process diagnostics based on rule filters (AGENT-15) `(PR #4808)`
- Tweaks to agents page `(PR #4757)`
- CSS tweaks to the diagnostic page `(PR #4754)`
- Handle empty impact string `(PR #4741)`
- Improve page layout, agent navigation and breadcrumbs `(PR #4727)`
- Minor spacing issues with layout `(PR #4712)`
- Minor visual improvements to reviews page `(PR #4711)`
- Rename fix rate to true positives `(PR #4706)`
- Link to reviews when available `(PR #4698)`
- Only show review tasks in latest runs `(PR #4686)`
- Limit CSS height on authors filter `(PR #4673)`
- Don't fail fast on missing revisions `(PR #4672)`
- Skip diagnostics for hallucinated file paths `(PR #4608)`
- Improved GitHub app creation step `(PR #4586)`
- Improve review cards `(PR #4580)`
- Rename agent "run" to agent "task" `(PR #4567)`
- Updates run/review card linking `(PR #4560)`
- Don't fail fast on invalid rule tag `(PR #4555)`
- Make report diagnostic tool skippable `(PR #4542)`
- Allow models to have "tools" capability in site-config `(PR #4529)`
- Improve run animation `(PR #4523)`
- Improve visually the review cards list `(PR #4505)`
- Filter out diagnostics outside the diff (AGENT-6) `(PR #4283)`

#### Auto-Edit

- Fix invalid JSON string `(PR #4864)`
- Fix incorrect naming of environment variables `(PR #4670)`

#### Billing

- Prevent applying coupons that expire before subscription period ends `(PR #4244)`

#### Ci

- Fix syntax in node heap size override `(PR #4595)`
- Remove error logging to avoid OOMs in CI for react integration tests `(PR #4424)`

#### Code Nav

- Add client side caching for file content `(PR #5073)`

#### Completions

- Track context token usage in completions client `(PR #4208)`

#### Dev

- Fix running storybook `(PR #5013)`
- Fix 'pnpm build' command in web-sveltekit `(PR #4851)`

#### Entitlements

- Fix interval handling, rename to window `(PR #4495)`

#### Github

- Synchronize at least 100 GitHub issue/PR comments, not 30 `(PR #4410)`
  - When syncing conversations from GitHub, we now fetch 100 comments by default instead of the default 30 comments

#### Modelconfig

- Fix gemini-1.5-flash cost `(PR #4441)`

#### Multi Tenant

- Don't show no seats left tooltip always `(PR #4688)`
- Do not show upsell banner when we have user space `(PR #4413)`
- Do not show error in loading state in coupon field `(PR #4370)`

#### Release

- Set development branch name by default `(PR #4357)`
  - NA

#### Search

- Fix global navigation grow/shrink functionality `(PR #5062)`
- Improve global navigation overflowing `(PR #4804)`
- Limit client range highlights `(PR #4354)`

#### Source

- Bump retry timeout on gqlutil tests to lessen flakiness `(PR #4952)`
- Fix error that happens when adding an existing GitHub App `(PR #4558)`
  - Fixed an error where Sourcegraph would display an error when an existing GitHub App was added in Site Admin, even though the adding succeeded.
- Bump default user permission back-off time `(PR #4297)`

#### Style

- Fix a gomft issue that made it to main `(PR #4535)`

#### Others

- Create wrapper to reduce risk of `NewGaugeFunc` causing deadlocks `(PR #4960)`
- Do not hard-fail when calculating file stats for large files `(PR #4950)`
- Do not use store methods, which can deadlock because they make observation `(PR #4944)`
- [SRCH-1387] workspace refresh caching using incorrect key `(PR #4859)`
  - Fixes issue [https://linear.app/sourcegraph/issue/SRCH-1387/chime-workspaces-not-updating](https://linear.app/sourcegraph/issue/SRCH-1387/chime-workspaces-not-updating)The workspace preview components rely on the apollo client cache to coordinate the state. Queries are made in two places;
- /client/web/src/enterprise/batches/batch-spec/edit/workspaces-preview/useWorkspacesPreview.ts
- /client/web/src/enterprise/batches/batch-spec/edit/workspaces-preview/useWorkspaces.tsThe desired effect is that both queries are cached under the same cache-key by apollo, and so when a query finds new results it triggers a component refresh with the new data.The problem is that there is a subtle difference in the variables passed to the query - One has `after: null` and on does not provide the `after` field. This means that they are treated as different queries and the cache entries for the queries are separate.
- Update auto-updating script to use correct scip-typescript Docker tag `(PR #4722)`
  - Switch to Debian-based auto-indexing Docker image for scip-typescript, and official Node builds. The new image is compatible with recent Node versions (verified: 23.11.0).
- Add docs link for github apps `(PR #4563)`

### Chore

#### Agents

- Limit tool calls in grader `(PR #4813)`
  - Added `ToolCallLimit` to `InternalCompletionParams` for limiting the number of allowed LLM tool calls in a loop.
- Always trace and show traceID in run logs `(PR #4685)`
- Enable string-enums in go-typespec code generation `(PR #4599)`
- Bazel build hygiene `(PR #4556)`
- Minor changes for localhost development `(PR #4554)`
- Adds more information into de-duplicate error `(PR #4385)`

#### Ci

- Add test github action for partially published changesets flow `(PR #4807)`
- Refactor web-sveltekit build process `(PR #4382)`
- Bump typescript in bazel to 5.4.2 `(PR #4367)`
- Update prechecks to handle bzl mod tidy and go mod tidy `(PR #4288)`

#### Database/Entitlements

- Test entitlements grants deletion `(PR #4838)`

#### Dev

- Cleanup client/vscode dependencies `(PR #4781)`
- Cleanup client/ui dependencies `(PR #4769)`
- Cleanup client/testing dependencies `(PR #4768)`
- Cleanup client/template-parser dependencies `(PR #4714)`
- Cleanup client/shared dependencies `(PR #4696)`
- Cleanup client/observability-server dependencies `(PR #4695)`
- Cleanup client/observability-client dependencies `(PR #4694)`
- Cleanup client/jetbrains dependencies `(PR #4693)`
- Cleanup client/http-client dependencies `(PR #4692)`
- Cleanup client/common dependencies `(PR #4666)`
- Cleanup client/codeintellify dependencies `(PR #4665)`
- Cleanup client/client-api dependencies `(PR #4664)`
- Cleanup client/build-config depdendencies `(PR #4663)`
- Cleanup client/browser dependencies `(PR #4561)`
- Cleanup client/branded dependencies `(PR #4552)`
- Cleanup unused dependencies `(PR #4516)`

#### Entitlements

- Hide site admin navbar item behind feature flag `(PR #5058)`

#### Gateway

- Use Authorization: Bearer as header for reranker `(PR #4513)`
- Change URL for reranker model `(PR #4511)`

#### Local

- Use docsite 1.9.6 `(PR #3823)`

#### Release

- Improve upgrade error message for out of policy upgrade attempts `(PR #4943)`
  - Improve migrator error for invalid upgrade ranges

#### Search

- Batch Changes PAT dialog - Fix wording `(PR #4660)`
- Migrate filter UI to svelte 5 `(PR #4479)`

#### Searchplatform

- Add deep search route to backend `(PR #4581)`

#### Security

- Update to s3proxy 2.6.0 `(PR #4515)`

#### Telemetrygateway

- Remove old proto symlink `(PR #4584)`

#### Workspaces

- Inject GoogleTagManagerContainer when serving index.html `(PR #4956)`

#### Others

- Update third-party licenses `(PR #4967)`
- Remove unused pipeline job implementation `(PR #4951)`
- Remove unused dbworker option `(PR #4920)`
- Update third-party licenses `(PR #4919)`
- Fix batch change codehost links `(PR #4707)`
  - Fix some broken links to documentation
- Update third-party licenses `(PR #4671)`
- Remove non-nil pre-condition for pagination function `(PR #4473)`
- Document nil propagation for PaginationArgs `(PR #4468)`
- Summarize linked Slack thread in code `(PR #4460)`
- Update third-party licenses `(PR #4448)`
- Release anish from changelog duties `(PR #4435)`
- Change default to match documented default `(PR #4429)`
- Remove search from gitserver `(PR #4420)`
- Bump up page size for repo cleanup scheduling `(PR #4419)`
- Mark TotalCount method as unreachable `(PR #4254)`
- Remove large.String -> replace back with []byte `(PR #4146)`

### Refactor

#### Others

- Remove deprecated batchChangePreview component `(PR #4384)`
  - Refactor to remove old duplicated component

### Reverts

- Revert pnpm upgrade (back to v9) `(PR #-1)`
- Revert "Revert "fix(cody-gateway): migrate Google client from from Gemini to Vertex API"" `(PR #4705)`

### Uncategorized

#### Others

- [Backport 6.3.x] Add ability for admins to set the default context for all users within an instance `(PR #5052)`
- Authz: Don't error when external account isn't usable for sync `(PR #5011)`
- Perforce: Remove top-level maxChanges setting `(PR #5010)`
- Gitserver: Observe vcs syncer from other shard `(PR #5009)`
- Gitserver: Rename variable and remove experimental disclaimer for v2 janitor `(PR #5008)`
- Add KUBERNETES_IMAGE_PULL_POLICY environment variable for the Executor service to allow setting the image pull policy `(PR #4995)`
  - Acepted values for KUBERNETES_IMAGE_PULL_POLICY:
    - Always - Kubelet always attempts to pull the latest image. Container will fail If the pull fails.
    - Never - Kubelet never pulls an image, but only uses a local image. Container will fail if the image isn't present.
    - IfNotPresent - Kubelet pulls if the image isn't present on disk. Container will fail if the image isn't present and the pull fails.
- Bump zoekt `(PR #4991)`
- Gitserver: Add option to disable janitor `(PR #4980)`
- Perforce: Don't drop rules for proxy catchalls `(PR #4978)`
- Perforce: Make changelist mapper recover automatically `(PR #4954)`
  - Fixed an issue where perforce changelist mapping could fall into an unrecoverable state after recloning.
- Batches: Don't use stateful periodic goroutine `(PR #4946)`
- Refactor cross domain login service to allow re-use in other services `(PR #4942)`
  - Moved userauth and xdomain login service from workspaces to managed services, to allow import from other services
  - Refactored userauth and xdomain login service to not be workspaces-specific, removing all workspaces references and allowing to specify the path for cross-domain login.## Test plan
 Tetsted changes locally from workspaces service
- Workerutil: Streamline heartbeat and stalled intervals `(PR #4934)`
- Workerutil: Streamline maximum resets `(PR #4932)`
- Fix(agents) use .at(0) instead of [0] for safe array access `(PR #4918)`
- Mail-gatekeeper: increment abuse score for Google abusers `(PR #4916)`
- Janitor: Don't schedule jobs too far into the future `(PR #4906)`
- Workerutil: Unify settings for resetter interval `(PR #4870)`
- Workerutil: Simplify resetter metrics `(PR #4865)`
- Contributors: Fix updating last_processed `(PR #4841)`
- Gitserver: Fix error parsing empty author/committer times `(PR #4832)`
- Contributors: Add missing resetter job `(PR #4831)`
- Tenant: Add deletion routine for searcher cache `(PR #4821)`
- Replace python with explicit python3 for pre-commit hook `(PR #4803)`
- Feat/Deep search: Show reasoning steps during execution `(PR #4795)`
- Database: Add missing indexes for repo hard deletions `(PR #4789)`
- Bug(agents): fixed spend page formatting `(PR #4763)`
- Repoupdater: Initialize subrepoperms `(PR #4756)`
- Bug(agents): fixed repo id bug `(PR #4755)`
- Analytics(telemetry): trim whitespace in comma separated list `(PR #4750)`
- Increase the max tokens to sample `(PR #4749)`
- Adds github only badge to plans page (and style tweaks) `(PR #4747)`
- Change the smart apply deployment to arizona region `(PR #4702)`
- Dotcom: Some cleanups after migration `(PR #4683)`
- Gitserver: Fix panic in ListRepositories error handling `(PR #4682)`
- Telemetry: Add DB index to optimize sorting in memory `(PR #4667)`
- Gitserver: Update error filter for backend metrics `(PR #4629)`
- Mail-gatekeeper: gRPC client and DNS improvements `(PR #4628)`
- Gitserver: Always disable gc.auto and maintenance.auto `(PR #4613)`
- Perforce: Fixup changelist ID parsing `(PR #4597)`
- Gitserver: Add gRPC method and basic UI for repo stats `(PR #4544)`
- Gitserver: Add OptimizationStrategy interface and runner for it `(PR #4540)`
- Gitserver: Add CleanStaleData function for new janitor `(PR #4532)`
- Gitserver: Address a few compiler warnings `(PR #4458)`
- Gitserver: Improve configuration for fetch `(PR #4439)`
- Gitserver: Implement maintenance methods in Git backend `(PR #4438)`
- Gitserver: Fix bad observable owner `(PR #4437)`
- Gitserver: Cleanup leftovers of coursier `(PR #4436)`
- Add no results page tutorial info `(PR #4432)`
- Add telemetry `(PR #4274)`
- Update subscription page `(PR #4241)`
- Database: Add primary keys to all tables `(PR #4144)`
- Gitserver: Implement scheduler for janitorial tasks `(PR #2519)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- [backport 6.2] perforce: Don't drop rules for proxy catchalls (#4978) `(PR #4993)`
- [backport 6.2.x] repoupdater: Initialize subrepoperms (#4756) `(PR #4760)`
- [6.2.x] Auto-update all packages in Sourcegraph container images `(PR #4723)`
- [6.2.x] Auto-update all packages in Sourcegraph container images `(PR #4601)`
Revert "Revert "[Backport 6.2.x] fix(agents): filter out empty diagnostic paths"" `(PR #4427)`
Revert "Revert "[Backport 6.2.x] fix(agents): make reviews and diagnostics pages order by -created_at"" `(PR #4428)`
- [6.2.x] Auto-update all packages in Sourcegraph container images `(PR #4466)`
- Add support for chaining multiple filePaths in URL (#4333) `(PR #4433)`
Revert "[Backport 6.2.x] fix(agents): make reviews and diagnostics pages order by -created_at" `(PR #4403)`
Revert "[Backport 6.2.x] fix(agents): filter out empty diagnostic paths" `(PR #4409)`
- Update context limits (CODY-5022) (#4321) `(PR #4426)`
- Add release as branch code owners `(PR #4421)`
  - N/A - Not customer facing

{/* RSS={"version":"v6.3.0", "releasedAt": "2025-04-30"} */}


# 6.2 Patch 3

## v6.2.3841

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.2.3841)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.2.3841)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.2.3841)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.2.3841)

### Features

#### Source

- Graphql: add databaseID field to repository graphql field `(PR #4999)`
  - The `repository` graphql API now supports fetchinig the `databaseID` field.  Backport cac91705f82f1221766f1576cdadd0b5c2c7502a from #4953

### Reverts

  There were no reverts for this release

#### Others

- [backport 6.2] perforce: Don't drop rules for proxy catchalls (#4978) `(PR #4993)`

{/* RSS={"version":"v6.2.3841", "releasedAt": "2025-04-23"} */}


# 6.2 Patch 2

## v6.2.2553

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.2.2553)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.2.2553)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.2.2553)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.2.2553)

> Attention - This patch contains a known issue for self-hosted customers upgrading from previous versions of Sourcegraph whom are using the Sourcegraph provided PostgreSQL container images.
> Please see our [PostgreSQL Collation Version Mismatch Resolution](/admin/postgresql_collation_version_mismatch_resolution) notes for more details.

### Features

#### Source

- Create different proxy interpretation modes for sub repo ip perms matching `(PR #4745)`
  - Authz: Add Perforce IP rule interpretation modes (`unified` (default), `directOnly`, `proxyOnly`) in site configuration via `rulesInterpretationMode` field to provide more predictable sub-repo permissions behavior
  Backport 774ac0c653371b0acbae62e233764dc6729fddf3 from #4713

### Fix

#### Cody

- Add new bedrock fields to legacy completions config `(PR #4940)`
  -  Backport 0d9f70dd54a4c20621fe7404d3c7598e60264f59 from #4771

### Chore

#### Security

- [6.2.x] Auto-update all packages in Sourcegraph container images `(PR #4723)`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.2.x] completions/azureopenai: reasoning and API version configuration `(PR #4936)`
- [backport 6.2.x] repoupdater: Initialize subrepoperms (#4756) `(PR #4760)`

{/* RSS={"version":"v6.2.2553", "releasedAt": "2025-04-16"} */}


# 6.2 Patch 1

## v6.2.1106

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.2.1106)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.2.1106)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.2.1106)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.2.1106)

### Features

#### Source

- Create graphql endpoint for viewing sub repo perms for a repository `(PR #4572)`
  -  Backport 34dd46a20d9d9d3a52abaaeaa845b968bf781435 from #4528

### Fix

#### Others

- Use internal actor for symbols archive fetching and downgrade error `(PR #4539)`
- Fetch user by username for Bitbucket Server `(PR #4514)`
  - Fixes an issue where we OAuth would fail for Bitbucket Server users with special characters in their usernames
 Backport 28317328924ae0139edacc3711d169b37179c31f from #4490

### Chore

#### Release

- [backport 6.2.x] Update jaeger-all-in-one `(PR #4611)`
  - Update jaeger-all-in-one to 1.67.0

#### Security

- [6.2.x] Auto-update all packages in Sourcegraph container images `(PR #4601)`

#### Others

- Log output of p4 protects commands `(PR #4549)`

### Reverts

- Revert "Revert "[Backport 6.2.x] fix(agents): filter out empty diagnostic paths"" `(PR #4427)`
- Revert "Revert "[Backport 6.2.x] fix(agents): make reviews and diagnostics pages order by -created_at"" `(PR #4428)`

### Uncategorized

#### Others

- [backport 6.2.x] ci: Improve runtime of integration test suite (#4632) `(PR #4715)`
  - (see original PR [https://github.com/sourcegraph/sourcegraph/pull/4632](https://github.com/sourcegraph/sourcegraph/pull/4632))
- [Backport 6.2.x] Prevent invalid Basic Auth header in webhook alert notifiers `(PR #4708)`
  - Fix(rel): prevent invalid authorization headers in webhook alert configurations when no credentials are provided  Backport eefbf38fc2ba6024d028ba968dedf397235714d3 from #4635
- [Backport 6.2.x] perforce: Implement mode for subrepo that doesn't hide commits `(PR #4591)`
- [Backport 6.2.x] perforce: Add test to cover nested subdirs `(PR #4569)`

{/* RSS={"version":"v6.2.1106", "releasedAt": "2025-04-08"} */}


# 6.2 Patch 0

## v6.2.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.2.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.2.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.2.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.2.0)

### Features

#### Agents

- First draft of new review page `(PR #4324)`
- Add rule stats to the `./api/rules` API `(PR #4320)`
  - Added rule stats to the `.api/agents/{agent_id}/rules` REST endpoint when the query string `?include=revision.stats` is present
- Wire data into Agent overview page `(PR #4302)`
- Add support to create rules from the web UI `(PR #4229)`
- Cool orb animation `(PR #4199)`
- New overview page `(PR #4172)`
- Always run merge base when computing base OID (AGENT-203) `(PR #4163)`
- Make review API return changeset and file diff `(PR #4159)`
- Add connected indicator next to agent title `(PR #4132)`
- Updated card design for changesets `(PR #4110)`
- Agent overview updates `(PR #4034)`
- Improved create new agent page `(PR #4023)`
- Add multiple table view UIs `(PR #4016)`
  - New UIs to view an agent repos, conversations, PRs, reviews, and diagnostics
- Auto-generate feedback from changeset conversations `(PR #3996)`
  - When a pull request is merged, diagnostic feedback is auto-generated via LLM judge from the comments and reactions
- Visual update to agents page `(PR #3963)`
- Mirror pull requests in our database `(PR #3880)`
  - It's now possible to `POST /.api/agents/{agent_id}/runs` to trigger a background review of a pull request
  - It's now possible to list pull requests for an agent with `GET /.api/agents/{agent_id}/changesets`
  - It's now possible to list repositories for an agent with `GET /.api/agents/{agent_id}/repos`
  - It's now possible to trigger a background sync of pull requests via `POST /.api/agents/{agent_id}/runs`.
- Link to original rule URL in GitHub review comments `(PR #3816)`
  - Review comments on GitHub now link to the original rule. Previously, it only displayed the rule slug (short ID like `logic`) and it was difficult to find the source of the rule. Now, it's easy to find both the rule instructions or identify the rule author (via git blame).
- Rules Table [AGENT-145][AGENT-169] `(PR #3797)`
- Add $-based cost estimates in agent overview `(PR #3632)`
  - There is now a new "Spend" tab in the agent overview that gives insights into how expensive it is to run an operate an agent, which is helpful among other reasons when making a decision about what LLM model to use.
  - The LLM API `/.api/completions/stream` now returns the used "modelref" (Sourcegraph canonical representation) alongside the used "model" (LLM provider canonical representation).
- Rule builder with testing on a specific PR `(PR #3614)`
- Sync PR conversations on merge or error [CODY-5010] `(PR #3569)`
- Rename all-inferred to repo-rules `(PR #3476)`
  - Use the setting `rules: ["repo-rules"]` instead of `rules: ["all-inferred"]` to pick up `*.rule.md` files in the repository based on the changed files in the diff.

#### Autocomplete

- Redict starcoder traffic to Deepseek from CG `(PR #4310)`

#### Batch Changes

- Add sorting to changesets `(PR #4085)`
- New api for batch spec examples `(PR #4050)`
  - Feat(batches): new batch spec examples library api
- Add title-search capabilities to batch changes `(PR #3837)`

#### Batch Changes

- Enable ssh key commit signing for site admins `(PR #4013)`
- Add fine-grained access tokens to credential modal `(PR #4007)`
  - Feat(batches): Batch Changes now supports fine-grained access tokens as user and site-admin credentials
- Update commit signing to display public key `(PR #3968)`
- Commit signing with ssh keys `(PR #3817)`
  - Feature is behind `batches-commit-signing` feature flag.Adds the UI form elements needed for submitting a private SSH key and passphrase for git commit signing.note: only UI elements and graphql changes in this PR, backend changes are still required.imageimage
- Implement changeset rebasing `(PR #3600)`

#### Cloudapi

- Database configuration `(PR #3779)`

#### Code Intelligence

- Syntactic indexing for Scala `(PR #2393)`

#### Code Nav

- Add metadata and topics to repo home `(PR #3984)`

#### Cody

- Update context limits (CODY-5022) (#4321) `(PR #4426)`
- Add entitlements CRUD endpoints `(PR #4402)`
- Add a site config for "enforced" Guardrails and transmit it to Cody clients `(PR #4286)`
  - Adds a site config setting, `"attribution.mode": "enforced"`, which configures Cody IDE extensions after v1.82 (VSCode) or v7.82 (JetBrains) to not display code until attribution checks have finished.
- Add support for logging to Search using Cody credentials `(PR #3585)`

#### Cody-Gateway

- MSP based version of cody gateway exposes sync sources endpoint `(PR #4261)`
- Return consumption in standardised trailer headers `(PR #3680)`
- Deprecate legacy /anthropic endpoint `(PR #3677)`

#### Codygateway

- Allow lookup failures to check Enterprise Portal again `(PR #3936)`

#### Completioncredits

- Disable request-count-based limiting when enforcement is enabled `(PR #4222)`
- Generate flattened usage view `(PR #3971)`

#### Completions

- Add token usage to traces `(PR #4180)`
- Credit consumption tracking `(PR #3917)`
- Apply cost estimate from Cody Gateway as source `(PR #3681)`
- Refactor cost estimation to 'credits' from 'pennies' `(PR #3667)`

#### Database/Completioncredits

- Improved List, add Count `(PR #4323)`
- Track raw token counts `(PR #4322)`

#### Dev

- Enable SvelteKit dev server in sourcegraph command set by default `(PR #3084)`

#### Dotcom

- Bring workspaces hype to Cody Pro upsell page `(PR #3768)`

#### Entitlements

- Init tables `(PR #3944)`

#### Gitserver

- Commit signing with ssh keys `(PR #3592)`

#### Graphqlbackend

- Add prototype completionCreditsUsage query `(PR #4346)`

#### Graphqlbackend/Completioncredits

- Prototype entitlement usage query `(PR #4483)`

#### Llmapitelemetry

- Allow consumers to GetTokenUsages `(PR #4181)`

#### Multi Tenant

- Bring onboarding UI a bit closer to original design `(PR #4217)`
- Add disabled tooltip to invite users button `(PR #3981)`
- Update public repositories picker tab `(PR #3923)`
- Add exit survey and delete re-typing confirmation UX `(PR #3859)`

#### Release

- Add timeout to migrator test `(PR #4237)`

#### Sams

- Extend workspaces session cookie to 30 days `(PR #4213)`
- Bump IntrospectTokenCacheSize for multi-tenant services `(PR #3850)`

#### Search

- Add support for chaining multiple filePaths in URL (#4333) `(PR #4433)`
- Rename scope refinement options for (hopefull) better clarity `(PR #4341)`
- Enable personalized ranking by default `(PR #4148)`
  - We've enabled personalized ranking for search results in the new web appâ€”marking the first step in integrating user-specific ranking signals into our search pipeline. As a result, queries spanning multiple repositories will prioritize results from repositories the user has frequently contributed to.User can disable the feature by setting `boostRelevantRepositories` to false in the settings

```json
{
  "experimentalFeatures": {
    "boostRelevantRepositories": false,
  },
}
```

- (new web ui) Add support for capture group aggregation `(PR #4122)`
- Add repo metadata editing `(PR #4086)`
- Add simple form validation/handling library `(PR #4084)`
- Code Monitors - Change the display order of the tabs in the page `(PR #3959)`
- Load 100 batch changes at a time instead of 15 `(PR #3739)`
- Use `patterntype=nls` for Cody context `(PR #3709)`
  - The `GetCodyContext` endpoint is now deprecated. Instead, clients should use the search API with `patterntype=nls`. Here's an example of how Cody calls the search API: ([https://github.com/sourcegraph/cody/blob/62d73f78c432036d1f99bc9631ed534cc2ed846b/lib/shared/src/sourcegraph-api/graphql/client.ts#L1386-L1404](https://github.com/sourcegraph/cody/blob/62d73f78c432036d1f99bc9631ed534cc2ed846b/lib/shared/src/sourcegraph-api/graphql/client.ts#L1386-L1404)).
- Add BlamePopover for blame view in new webapp `(PR #3659)`
- Improve cody web warmstart performance `(PR #3333)`

#### Smart-Apply

- Allow smart apply models on dotcom `(PR #4104)`
- Add instant apply model for smart apply `(PR #3857)`
  - Feat(smart-apply): Add instant apply models

#### Source

- Add projectQuery option to Gerrit code host connections `(PR #3807)`
  - Gerrit code host connections now support a `projectQuery` option that allows for any arbitrary query parameters supported by the Gerrit API.
- Allow adding details of an already existing GitHub App `(PR #3370)`
  - Site admins can now add their own pre-existing GitHub Apps to Sourcegraph. This also allows site admins to supply the App details of Enterprise GitHub Apps.

#### Workspaces

- Implement workspace membership filter `(PR #4038)`
- Add Google Tag Manager via WORKSPACES_GOOGLE_TAG_MANAGER_ID `(PR #3611)`
- Add plans-viewed event `(PR #3503)`
- Check Enterprise Portal for potential overlap `(PR #3500)`

#### Workspaces/Internal

- Add button to find by workspace ID `(PR #3607)`
- Add link to Looker for workspace `(PR #3588)`
- Add search workspaces UI `(PR #3566)`

#### Others

- Configurable runtime for codemonitor jobs `(PR #4289)`
  - Feat: configurable runtime for codemonitor jobs
- Show an info message that commit signing is set up `(PR #4216)`
- Hide commit signing integration when no github code host is available `(PR #4022)`
- Create new package /lib/releases `(PR #3835)`
- Implement commit search on searcher `(PR #3541)`
  - Added a feature flag to run commit search on searcher, goal being to improve stability and resource usage of gitserver
- New GraphQL query evaluateFeatureFlags `(PR #3513)`
  - Feat: new GraphQL query evaluateFeatureFlags
- Add C++ support for ctags `(PR #3301)`

### Fix

#### Agents

- Render context lines against head (AGENT-195) `(PR #4430)`
- Add missing sg enable to +page.svelte files `(PR #4399)`
- Simplify onboarding `(PR #4386)`
- Fix broken changeset titles `(PR #4372)`
- Use MarshalCursor.idField as an override if "Id" is explictly listed `(PR #4352)`
- Add minor touches to review page `(PR #4347)`
- Make agent overview page load again `(PR #4338)`
- Generate meaningful name for newly created agents `(PR #4334)`
- Make agent page load with empty connections `(PR #4331)`
- Make `/.api/reviews?include=changesets` actually work `(PR #4328)`
- Fix explicit changeset revision ID and improve logging `(PR #4304)`
- UI improvements to reviews list `(PR #4294)`
- Improve overview review cards `(PR #4293)`
- Updated review list design `(PR #4271)`
- Fix detection of generated files (AGENT-202) `(PR #4238)`
- Agent orb z-index removed `(PR #4235)`
- Links the "View review" button in review list `(PR #4234)`
- Handle diffs with deleted files `(PR #4221)`
- Remove review rule `(PR #4214)`
- Fix overview page bugs `(PR #4193)`
- Fix prompt rendering issues `(PR #4186)`
- Updated spend page for new schema `(PR #4166)`
- Settings moved to top-level nav `(PR #4135)`
- Link buttons and links on connection card `(PR #4129)`
- Moves sidebar items into context menu `(PR #4126)`
- CSS and changeset logic fixes `(PR #4113)`
- Added whitelisted prefix to system prompts `(PR #4090)`
- Import create images properly `(PR #4073)`
- Agents Intro Hero visual update `(PR #4070)`
- Visual update agent hero section `(PR #3990)`
- Conversations have Upsert semantics `(PR #3915)`
- Display stable number of agent runs `(PR #3822)`
- Skip draft PRs with the `feature_flag_enabled` trigger `(PR #3820)`
  - The review agent no longer automatically reviews draft PRs with the `feature_flag_enabled` trigger. Instead, users must explicitly request reviews on draft PRs through a comment (`comment_starts_with`) or a label (`label_exists`)
- Track spend even when not posting GitHub review `(PR #3819)`
- Automatically add feature-flag trigger `(PR #3815)`
  - When creating a new agent program, it now automatically includes a feature flag trigger for the feature flag named `agents-auto-review`. You must create this feature flag to have the trigger activate.
- Run items condensed `(PR #3813)`
- Run status indicators changed to circles `(PR #3811)`
- Get review agent working again `(PR #3766)`
- 404 link `(PR #3763)`
- Added another migration to fix edited agent_conversation migration `(PR #3686)`
- Add migration to fix edited migration [AGENT-157] `(PR #3641)`
- Use non-cancelable context for telemetry reporting `(PR #3630)`
- Correctly chunk diffs wrt generated files `(PR #3628)`
  - Fix a bug where the review agent would error if a generated file had more than 100k tokens.
  - Updated docs to describe the algorithm to detect and ignore generated files
- Mark run as "errored" on panic `(PR #3627)`
  - Fixed a bug where an agent run would be stuck in "running" mode forever. Now, these runs get correctly marked as "errored"
- Improve wording of a log entry `(PR #3626)`
- Remove outdated suggestion `(PR #3625)`
- Fix flaky test failure `(PR #3578)`
- Several small fixes for agents `(PR #3571)`
  - The review agent now posts a comment reply when it's triggered by a comment trigger (example: `@sourcegraph review`). This is makes the agent behave more like a colleague would.
  - The agent run page now links back to the pull request at the top of the page
  - "Duration: 0s" is no longer shown on the agent run page while it's running.
  - The links to the "applied_rules" in the agent run page now work correctly. Previously, the links were a 404 because they were one long `", "` joined string. We plan to further improve the design of how rules are displayed in this page, so this is not a final solution, just a quick fix for the most immediate bug.
- Fix bug where `POST /reviews` always failed `(PR #3520)`

#### Analytics

- Deprecate admin analytics `(PR #3930)`
  - Deprecate the admin analytics pages (/site-admin/analytics) and redirect users to Sourcegraph Analytics (analytics.sourcegraph.com).

#### Batch Changes

- Don't show ssh keys if they're not applicable `(PR #4009)`
- Make batch changes restriction more visible `(PR #3860)`

#### Ci

- Fix pnpm patch file paths `(PR #3519)`

#### Search

- Fix bug that wasn't setting a default tab selection `(PR #4107)`
  - Fixes a bug where default selections were not being set.

#### Code Intelligence

- Allows explicitly specifying scala for scip-syntax `(PR #3875)`
- Allow failed and errored uploads to expire in accordance with retention policy `(PR #3393)`

#### Code Nav

- Enable code intel for graphql and protobuf `(PR #4264)`
- Change file tree alignment `(PR #4246)`
- Fix inline diff view `(PR #4232)`

#### Cody

- Allow "edit" model capability in site config `(PR #4377)`
- Endpoint and token definition in requests to Cody Gateway `(PR #3980)`
- Cody Gateway client config `(PR #3978)`
- Cody Gateway enabled definition `(PR #3977)`
- Cody Gateway endpoint and token resolution on Sourcegraph instance `(PR #3950)`
- Update auditlog API to have cursor-based pagination `(PR #3942)`
  - Improve usability of auditlog API
- Remove Cody quota usage check worker `(PR #3922)`
- Prevent panic in chat completions API by checking error first `(PR #3918)`
  - The API `POST /.api/llm/chat/completions` now does not panic anymore when sending a bad request (HTTP 400), which was possible to trigger if you used tool with an incorrect schema.

#### Cody-Gateway

- Added missing call of InitCodyGatewayModelConfig to MSP version of Cody Gateway `(PR #4266)`

#### Cody-Gateway/Dotcomuser

- Shorter TTL for failure case `(PR #3847)`

#### Codygateway

- Fix Enterprise actor cache fail-open `(PR #3559)`

#### Completioncredits

- Fix aggregation generating >1 row per user `(PR #4178)`

#### Completions

- Soft-fail aggregated token usage recorder `(PR #4284)`

#### Completions/Client

- Check for resp nil-ness before deref `(PR #4218)`

#### Completions/Entitlements

- Do not hard-fail on missing usage data `(PR #4446)`
- Ignore code completions `(PR #4185)`
- Fix fallback calculation `(PR #4115)`

#### Dev

- Fix pnpm test:preview command `(PR #4314)`
- Fix `pnpm dev` `(PR #4219)`

#### Enterpriseportal

- Remove bad log scopes `(PR #3536)`

#### Entitlements

- Use bigint limits `(PR #4176)`

#### Modelconfig

- Correct modelcost calculation `(PR #4179)`
- Remove invalid modelcost, add enforcement `(PR #4100)`

#### Multi Tenant

- Fix add repositories error layout, workspace redirection, added repositories search `(PR #4167)`
- Fix variable preservation for add repositories picker pagination query `(PR #4030)`

#### Perf

- Remove quadratic behavior in rune counting `(PR #3665)`
  - (perf) Fixed quadratic behavior in commit and diff search

#### Prompts

- Do not allow to create prompts if you're not a site admin `(PR #4011)`

#### Search

- Make form input directions more clear `(PR #4093)`
- Remove unscoped css `(PR #4080)`
- Disallow rev filters with repo predicates `(PR #4035)`
  - Fixes a search bug where queries like `repo:has.file(...) rev:1.0` would completely ignore the `rev` filter. Now, these types of searches are explicitly disallowed.
- Ensure we ignore context canceled errors in searcher client `(PR #3992)`
  - Fix a rare bug in `repo:has.file` queries where some searches could return no results.
- Truncate all Rockskip tables `(PR #3976)`
  - With this change we delete all Rockskip indexes. In Sourcegraph v5.5.0 we shipped a bug in Rockskip which causes some unindexed symbol searches to return no results. The bug has been fixed in 6.2 and was backported to 6.1. However indexes that have been created prior to the fix are corrupted. Hence, we have to reindex all Rockskip repositories. A new index job will automatically be triggered. This requires no further action. However, during the reindex, symbol search at older revisions of very large repos will likely time out, so we encourage all customers to communicate this to their users ahead of the rollout of the new version.
- Code monitors tab logic `(PR #3961)`
- Fix 'case:' and 'patterntype:' parsing bug `(PR #3927)`
- Server returns new app for /agents/* Routes `(PR #3762)`
- Improve error for clashing revisions `(PR #3714)`
- Make repo readme fill available space `(PR #3707)`
- Fix streaming search in vscode and jetbrains extension `(PR #3510)`
- Workaround settingscasacde error checks `(PR #3364)`

#### Smart-Apply

- Change the deployment id for the custom model `(PR #3921)`
  - Fix(smart-apply): Change deployment id

#### Workspaces

- Only check eTLD+1 if domain might have a subdomain `(PR #3561)`

#### Workspaces/Web

- Fix tag manager ID interpolation `(PR #3664)`

#### Others

- Escape LIKE queries for users `(PR #4311)`
- Add ssh-keygen to gitserver to enable commit signing `(PR #4300)`
- Clean up indexes for user_relevant_repos `(PR #4281)`
- Skip check for github app commit signing if configured by SSH `(PR #4169)`
- Init subrepo perms before enterprise init hooks `(PR #4064)`
- Only show commit signing for gitlab and github `(PR #4027)`
- Use pathspec literal to avoid colons `(PR #3928)`
  - Fixed a bug where paths that start with colons may be reported as not found.
- (Agents) Modify agent submenu styling `(PR #3810)`
- (Agents) Remove description field in agent creation step `(PR #3808)`
- Enforce file size limits for highlighting `(PR #3697)`
  - Enforces limits of 1.5 MiB and 50K lines for highlighting code files.
- Remove vertical scrollbar from pre block `(PR #3678)`
  - (minor bugfix) Fixed an issue where we would show scrollbars on unscrollable items in the dynamic search filters sidebar
- Fetch modified files for `DiffModifiesFile` `(PR #3654)`
- Clean up cmd leak `(PR #3642)`
- A few bugfixes for the experimental commit search on searcher `(PR #3639)`
- Close diff reader `(PR #3636)`
- A few small fixes for commit search on searcher experiment `(PR #3620)`
- Change developer dialog back to cache first `(PR #3548)`

### Chore

#### Agents

- Add support for 'sg test agents' `(PR #4336)`
- Add extra debugging statement `(PR #4326)`
- T.Equal argument order `(PR #4290)`
- Replace openapi-generator with custom typespec emitter `(PR #4249)`
- Optimize Go coding style rule `(PR #3848)`
- Minor fixes for spend page `(PR #3757)`
  - API documentation for `GET /.api/reviews` now correctly shows the supported query parameters
  - The agent spend overview now correctly displays the oldest date in the title (not newest date)
  - The agent spend overview page now no longer has a 404 in the page title
- Move internal dev docs to Notion `(PR #3675)`
- Conversation Reactions [AGENT-17] `(PR #3618)`
- Remove less useful rules `(PR #3598)`
- Add rules related to emitting telemetry events `(PR #3582)`

#### Batch Changes

- Commit signing polish `(PR #4287)`

#### Ci

- Migrate hermetic cc toolchain to bzlmod + ubuntu 24.04 (v2) `(PR #3979)`
- Remove linter_deps `(PR #3778)`
- Handle pushing of images with tag `internal-image` `(PR #3701)`
- Move hermetic_cc_toolchain to bzlmod `(PR #1665)`

#### Code Intelligence

- Remove stray comment `(PR #3616)`
- Reduce frequency of auto-indexing summary builder `(PR #3615)`
- Add test for Int4 overflow fix `(PR #3597)`
- Delete dependency syncing code `(PR #2947)`

#### Code Nav

- Fetch file content from raw endpoint in React app `(PR #4299)`
- (new web ui) Use raw endpoint to fetch file content `(PR #4136)`

#### Cody

- Roll Cody Web to 0.32.4 `(PR #4404)`
  - Cody Web is updated to 0.32.4
 Backport 70119119b25a883d94571770aafe7846c161a79d from #4401
- Fix max tokens default values for dev env `(PR #4125)`
- Make Cody Gateway accept incoming trace as a direct parent `(PR #4003)`
- Remove teams mention from pro plan description `(PR #3749)`
- Remove "New" from Claude 3.5 Sonnet name (SRCH-1627) `(PR #3530)`
  - No-changelog

#### Cody-Gateway

- 10x all blocking/flagging limits `(PR #4184)`

#### Codygateway

- QA fixups `(PR #4099)`

#### Completioncredits

- Increase aggregation interval to 5s `(PR #4251)`

#### Deps

- Bump vulnerable dependencies `(PR #4329)`

#### Dev

- Extracted constant time string comparison into a utility function `(PR #4278)`
- Upgrade playwright `(PR #4272)`
- Clean up web-sveltekit and ui package.json files `(PR #4269)`
- Improve stability of top level navigation test `(PR #4259)`
- Improve playwright test stablility `(PR #4162)`
- Remove sourcegraph.yaml code path in auto-indexing `(PR #2957)`
- Delete most package repo code `(PR #2955)`
  - Removes experimental support for creating, configuring and using package code hosts such as NPM dependencies, JVM dependencies, Go modules etc.

#### Docs

- Add link to telemetry naming best practices guide `(PR #4012)`

#### Dotcom

- Remove deprecated events pubsub client `(PR #3662)`

#### Enterpriseportal

- Wrap error instead of using safedetails `(PR #3937)`
- Include error in lookup error log `(PR #3935)`
- Log subscription-not-found GetCodyGatewayAccess requests `(PR #3734)`

#### Gitserver

- Clarify correctness of code in CommitsIter `(PR #3547)`

#### Graph

- Upgrade auto-indexer images (Adds support for .NET 9.0) `(PR #4057)`

#### Graphql

- Split specific functionality of `GitTreeResolver` and `GitBlobResolver` out of shared `GitTreeEntryResolver` `(PR #3744)`

#### Local

- On MacOS use `login` keychain `(PR #3975)`
- Add analytics sentinel value to events `(PR #3853)`
- Remove GOWORK from sg.config `(PR #3851)`

#### Modelconfig

- Update Gemini 2.0 Flash-Lite model info `(PR #3887)`

#### Monitoring

- Add completions latency dashboards `(PR #3741)`

#### Perf

- Stream commits `(PR #3661)`
  - (internal, perf) Modified commits endpoint on gitserver to stream end-to-end, increasing raw listing throughput by ~20x.

#### Refactor

- Extract subrepo permissions checking into a Client wrapper `(PR #3634)`

#### Release

- Add release as branch code owners `(PR #4421)`
  - N/A - Not customer facing

#### Release

- Move operations package out of internal `(PR #4164)`
  - Move buildkite and operations packages into public package from internal
- Remove duplication of SBOM generation in internal releases `(PR #4061)`
  - Remove SBOM from internal release
- Publish basic initcontainer to use in deployments `(PR #3974)`

#### Search

- Convert toReadable to toLoadable `(PR #4121)`
- Standardize on valibot for runtime data validation `(PR #4082)`
- Blame popover polish `(PR #3908)`
- Update cody web to v0.32.2 `(PR #3904)`
- Remove fuzzy finder access for unauthorized users `(PR #3776)`
- Change os.Setenv to t.Setenv and move the env closer to the tests `(PR #3557)`
- Add tests for KUBERNETES_GIT_CA_CERT `(PR #3539)`

#### Security

- Backport: Update to src-cli 6.1.1 `(PR #4477)`
  - Update src-cli version to 6.1.1
- [6.2.x] Auto-update all packages in Sourcegraph container images `(PR #4466)`
- Pin GH actions `(PR #4134)`
- Remove database dependency from security event logs `(PR #3907)`
  - Removed ability to write audit logs to database.
  - Audit logs can no longer be disabled, and will always stream to stderr.
- Auto-update all packages in Sourcegraph base images `(PR #3483)`
- Auto-update all packages in Sourcegraph base images `(PR #3274)`

#### Source

- Move subrepo filtering to gitserver client for `StreamRawDiffs` `(PR #3799)`

#### Telemetry

- Update `NonActiveUserEvents` to include `cody.auth.connected` `(PR #4517)`
- Cody.api and requestclient cleanups `(PR #3769)`

#### Workspaces

- Remove redundant custom utm_source `(PR #3531)`

#### Workspaces/Blocklists

- Make fuzzy-match more lenient `(PR #3770)`

#### Others

- Activate commit signing by default `(PR #4373)`
  -  Backport 5f9519cec1e7edea1880dd44af25161f9d4fc88b from #4343
- Update styling for batch changes search `(PR #4291)`
- Simplify logic for occurrence resolvers `(PR #4253)`
- Update third-party licenses `(PR #4250)`
- Try again to fix test flake `(PR #4231)`
- Fix racy test `(PR #4227)`
- Remove packages from GraphQL & site config `(PR #4220)`
- Disable flaky test in CI `(PR #4212)`
- Clarify + add more o11y for HandleRawUpload `(PR #4177)`
- Add ability to fetch repo by database ID `(PR #4161)`
- Fix commit search test `(PR #4143)`
- Remove last log15 from repo-updater `(PR #4140)`
- Cleanup code that was not implemented `(PR #4127)`
- Update third-party licenses `(PR #4097)`
- Remove unused gitserver_repos_statistics table `(PR #4087)`
- Enable diff-search-on-searcher by default `(PR #4052)`
  - Internal: moved commit and diff search from gitserver to searcher to help stabilize gitserver memory usage
- Add ability to migrate in parallel `(PR #4017)`
- Fixup copy for bitbucket.org `(PR #3993)`
- Update third-party licenses `(PR #3967)`
- Remove intent detection model call in frontend, always return chat `(PR #3938)`
  - The ChatIntent endpoint is now deprecated and will always return chat as the chosen intent.
- Include context for inference logic (o11y) `(PR #3899)`
- Add historical context for Rand parameter `(PR #3896)`
- Remove fmt.Printf in test code `(PR #3895)`
- Base language detection limit on measurements `(PR #3893)`
  - Language icons for files with ambiguous extensions (such as `.h` files, which is used for both C and C++) are more likely to be accurate.
- Add tool for language detection measurements `(PR #3873)`
- Add constant for language detection limit `(PR #3854)`
- Add Go style guide to rules `(PR #3845)`
- Update third-party licenses `(PR #3840)`
- Remove unused WebBuilderDevServer field `(PR #3812)`
- Update teams.yml for product platform changes `(PR #3748)`
- Refactor content fetching `(PR #3742)`
- Add `rawURL` `(PR #3740)`
  - (feat) Added `rawURL` to git blob GraphQL resolver to encourage fetching file contents from in a more performant manner.
- Reduce vite logging to warn `(PR #3727)`
- Serialize commit search `(PR #3715)`
- Remove evaluated feature flags from event logging for performance `(PR #3700)`
- Erase errors returned from *FileChecker types `(PR #3693)`
- Add LargeString type to avoid string copies `(PR #3692)`
- Change constants casing `(PR #3691)`
- Add printing functions for units.Size `(PR #3690)`
- Update third-party licenses `(PR #3688)`
- Ignore debug binaries produced by delve `(PR #3679)`
- Bump auto-indexing image SHAs `(PR #3676)`
  - Updates default auto-indexing images for scip-go (to v0.1.23), scip-ruby (to v0.4.6) and scip-dotnet (to v0.2.10).
- Remove client-side code for packages `(PR #3671)`
  - Removes UI settings for experimental package repos feature.
- Add test for patch.go `(PR #3655)`
- Remove tree-sitter-based semantic chunker `(PR #3645)`
- Update Emi's mentions to 'emidoots' `(PR #3624)`
- Notify Varun on changes to codeintel dashboard `(PR #3623)`
- Update Entitle Link for documentation `(PR #3613)`
- Update third-party licenses `(PR #3572)`
- Migrate react hook useFeatureFlag to use batch query `(PR #3550)`
- Migrate developer dialog to evaluateFeatureFlags `(PR #3546)`
- Rename Search to CommitSearch `(PR #3464)`

### Refactor

#### Search

- Rename boost: query params to repo:boost `(PR #4332)`
  - `boost:repo()` and `boost:relevant.repos()` query params have been renamed to `repo:boost()` and `repo:boost.relevant()`.

#### Security

- Remove security event patterns from audit logging `(PR #4154)`
  - Security events have been removed in favor of improved audit logging

#### Others

- Batch settings requests `(PR #4315)`
  - Perf: reduced DB roundtrips when fetching settings, lowering floor latency for API requests
- Move after commit logic into server source implementations `(PR #4224)`
  - The executor shouldn't know about code host specific logic. This change moves github specific logic - Duplicating commits when signing with a GH app - Out of the executor and into the Github ChangeSetSource.This is behind a generic AfterCommit interface method of ChangeSetSource interface, for which other code host implementations are simply no-ops.

### Reverts

- Revert "chore: add Zoekt indexserver GRPC client" `(PR #4024)`

### Uncategorized

#### Others

- [Backport 6.2.x] bitbucketserver: Properly refresh OAuth credentials in API calls `(PR #4522)`
  - Fixed an issue where Bitbucket Data Center/Server OAuth2.0 credentials were sometimes not refreshed correctly, causing errors when syncing repository permissions.  Backport fb4e51d25cc2ac0713e9af3d7ed39fc6e9d01500 from #4521
- [Backport 6.2.x] modelconfig: refresh model costs `(PR #4400)`
- [Backport 6.2.x] Update deployment types to show accurate types in telemetry `(PR #4361)`
  -  Backport a09017f5ef6e75ec083fc0c9444baa64b0354989 from #4319
- Cody-gateway: Fixed (Read/Write)Timeout in MSP version of cody gateway; those were misaligned compared to legacy version `(PR #4296)`
- Database: Add support for CloudSQL connector in monolith `(PR #4282)`
- Uploadpack: Fixup metrics reporting `(PR #4279)`
- Session: Store loaded user on actor `(PR #4276)`
- Increase request duration `(PR #4275)`
- Api: Fix panic in randomizeUserPassword mutation `(PR #4265)`
- Upgrade rules_rust 0.59.2 and remove rules_rust patch `(PR #4260)`
- Monitoring: tweak entitlements docs `(PR #4252)`
- Migration: Fixup performance of packages migration `(PR #4228)`
- Gitserver: Update on-disk format again `(PR #4203)`
- Monitoring: add entitlements panels `(PR #4201)`
- Repoupdater: RecloneRepo removes repo from all shards `(PR #4187)`
- Extract user setting link to a separate nav item `(PR #4182)`
- Gitserver: Change janitor default interval to 2h `(PR #4175)`
- Dev: add debug image `(PR #4174)`
- Tenant: Fix missing tenant errors in updates to repo_statistics `(PR #4165)`
- Internal/database: add initial entitlements store `(PR #4153)`
- Fix some linter warnings `(PR #4147)`
- CORE-814: soureces.Worker is used in MSP cody-gateway not only in non-MSP version `(PR #4133)`
- Chore(cloud ephemeral): allow extend lease for expired/incomplete insâ€¦ `(PR #4128)`
- CORE-814: MSP version of Cody Gateway exposes all endpoints exposed by the non-MSP version `(PR #4123)`
- Gitserver: Recalculate size only after fetches `(PR #4116)`
- Update Cody Web to 0.32.3 `(PR #4105)`
- Add support for tool_results `(PR #4101)`
- Gitserver: Simplify refspecoverrides `(PR #4096)`
- Frontend: Unexport packages not used outside of frontend `(PR #4095)`
- Gitserver: Implement upload-pack in gitcli package `(PR #4094)`
- Workspaces: Deprecate code.repositoryInfo:succeeded event `(PR #4089)`
- Gitserver: Don't persist shard_id in database anymore `(PR #4088)`
- Tenant: Add deletion routine for the database `(PR #4071)`
- Initialise subrepo permissions checker in syntactic worker `(PR #4069)`
- Feat(cody gateway): Update default chat model to Claude 3.7 Sonnet without Thinking enabled `(PR #4063)`
- Cleanup: fail if subrepo perms is not initialized `(PR #4056)`
  - (Infra) Searcher now requires a database connection, so must be able to reach Postgres,
- Mark Scala import packages as namespaces `(PR #4046)`
- Repo-updater: Fix bad log field `(PR #4041)`
- CORE-814: MSP version of Cody Gateway exposes basic HTTP API `(PR #4036)`
- Gitserver: Fix goroutine leak `(PR #4033)`
- Fix bug where penny-based model configurations would result in site config validation errors `(PR #4021)`
- Symbols: Fix column reference in rockskip repo deletion `(PR #4020)`
- Added EventLogger to the Cody Gateway supporting BigQuery configuration created by MSP `(PR #4004)`
  - Added EventLogger to the Cody Gateway supporting BigQuery configuration created by MSP
- Fix merge order conflict `(PR #3997)`
- Stream: Fix unintentional buffering in streaming APIs `(PR #3994)`
- Fix(cody gateway): disable chat vision by default `(PR #3988)`
- Add trace events for external requests `(PR #3987)`
  - Internal: added trace logs for HTTP lifecycle events
- Feat(cody gateway): unblock vision models requests `(PR #3986)`
- Reapply "fix: batch workspaces to reduce memory pressure (#3657)" (#3965) `(PR #3982)`
- Symbols: enabled ad-hoc file parsing by default `(PR #3970)`
  - We have enabled a new performance improvement for unindexed symbol search. Requests asking for all symbols of a file will now be handled by ad-hoc file parsing instead of by Rockskip or sqlite-based symbol search. This solves an issue many customers have reported for larger repositories, where the symbol sidebar in the blob view would often show errors related to timeouts. The feature can be disabled by setting `DISABLE_FILE_SYMBOLS_PARSING=true` as ENV for the symbols service.
- P4fusion: Use the latest version in localdev `(PR #3955)`
- P4fusion: Remove old p4-fusion wolfi package `(PR #3954)`
- Ci: Skip perforce IP tests as well in backend integration tests `(PR #3953)`
- Search: add tracing for revision resolution `(PR #3934)`
- Bug(agent): Set display_name when fetching rules `(PR #3931)`
- Gitserver: Run p4-fusion operations in quarantined repo directory `(PR #3929)`
- Gomod: bump Zoekt for test scoring change `(PR #3926)`
- Fix(mi2 cloud eph): support older Sourcegraph versions `(PR #3920)`
- CORE-759: Added MSP skeleton to Cody Gateway `(PR #3902)`
  - Added feature flag for MSP and added skeleton of MSP app into Cody Gateway
- Fix incorrect enqueuing of syntactic indexing jobs `(PR #3877)`
  - Fix incorrect enqueuing of syntactic indexing jobs `(PR #3877)`
- Tenant: Add deletion routine for blobstore `(PR #3876)`
- Gitserver: Fix testbed setup in git 2.48 `(PR #3867)`
- Index C++ concepts using scip-ctags `(PR #3843)`
  - Use scip 0.5.2 to identify C++ concepts
- Map "c++" -> "cpp" for scip-ctags parsing `(PR #3842)`
  - Maps `c++` to `cpp` when selecting `scip-ctags` parser, instead of falling back to `universal-ctags`.
- Update to src-cli 6.1.0 `(PR #3818)`
  - Update src-cli version to 6.1.0
- Gitserver: Support fetching repo from other gitserver after resharding `(PR #3800)`
- Tenant: Add deletion routine for zoekt `(PR #3782)`
- Changing Gemini Flash Lite model from Preview to GA `(PR #3752)`
- Tenant: Forbid changing the primary email `(PR #3747)`
- Tenant: Add deletion routine for gitserver `(PR #3745)`
- Bug(agents): db.Conversations().Create also has update semantics [AGT-172] `(PR #3743)`
- Tenant: Add small framework and first task for tenant deletion reconciler `(PR #3735)`
- Vsce: minor release v2.4.0 `(PR #3718)`
- Feat(cody gateway): change the reasoning effort for  Claude 3.7 Sonnet model to low `(PR #3710)`
- Feat(cody gateway): add Claude 3.7 Sonnet model `(PR #3705)`
- Tenant: Fix local dev not starting up `(PR #3684)`
- Fix: Mark releases as development in the releaseregistry `(PR #3682)`
  - NA
- Monitoring: add new CPU/ memory group for all services `(PR #3666)`
- Cody: Change some unlimited wording to increased `(PR #3640)`
- Searcher: Add missing logger `(PR #3617)`
- Updated marketing to reflect Pro chat limits are not unlimited `(PR #3586)`
- Add 'clear search' feature to search input bar. `(PR #3583)`
- Monitors: Fix logo URL and use new branding in notification email `(PR #3570)`
- Gateway: Increase ES LLM limits to match Pro `(PR #3564)`
  - Increased ES LLM limits to match Pro
- Gitserver: Adopt zoekt charts for IO and memory pressure `(PR #3533)`
- Search: actually enable scip-ctags for C `(PR #3532)`
- Remove Waitlist for O1 Models `(PR #3509)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)
- Telemetry: allowlist key "chatAgent" in feature:"cody.chat-question" `(PR #3484)`
- Update svelte/react storybook  `(PR #3472)`
- Don't let users see event logs page on dotcom (we don't store v2 teleâ€¦ `(PR #3430)`
- Search: expose bestLineMatch via GraphQL `(PR #3291)`
- Authz: Clean up requirement to validate authz providers when creating code host connection `(PR #2863)`
- Searcher: Remove RepoName field from requests `(PR #2520)`
- Gitserver: Don't reclone repos after random GC failures `(PR #2517)`
- Gitserver: Drop Git attributes janitor task `(PR #2516)`
- Repoupdater: Slightly simplify repo loading and clean up RepoNames in gRPC `(PR #2515)`
- Repoupdater: Move internal actor impersonation to caller `(PR #2514)`
- Gitserver: Consolidate purge worker and state syncer `(PR #2513)`
- Gitserver: Switch to IDs for all requests `(PR #2493)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Feat(cody gateway): Update default chat model to Claude 3.7 Sonnet wiâ€¦ `(PR #4207)`
  - See [https://github.com/sourcegraph/sourcegraph/pull/4063](https://github.com/sourcegraph/sourcegraph/pull/4063)
- Update Caddy `(PR #3906)`
- Fix bug where POST /reviews always failed `(PR #3522)`
- Auto-update all packages in Sourcegraph base images `(PR #3482)`

{/* RSS={"version":"v6.2.0", "releasedAt": "2025-04-02"} */}


# 6.1 Patch 5

## v6.1.5633

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.1.5633)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.1.5633)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.1.5633)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.1.5633)

### Features

#### Cody

- Allow non-aws bedrock endpoints with Bedrock provider `(PR #4196)`
  - Add AWS Bedrock client support for non-AWS Bedrock-compatible endpoints
  Backport 9054d7c14db0ecf96200c2985c5b550b6dd2ded0 from #4145

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- Feat(cody gateway): Update default chat model to Claude 3.7 Sonnet wiâ€¦ `(PR #4207)`
  - See [https://github.com/sourcegraph/sourcegraph/pull/4063](https://github.com/sourcegraph/sourcegraph/pull/4063)
- [Backport 6.1.x] Add thinking/chain-of-thought support for Anthropic models via Vertex AI `(PR #4202)`
- [Backport 6.1.x] bitbucket: Add support for subpath in cloneurl resolution `(PR #4195)`

{/* RSS={"version":"v6.1.5633", "releasedAt": "2025-03-21"} */}


# 6.1 Patch 4

## v6.1.4020

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.1.4020)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.1.4020)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.1.4020)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.1.4020)

### Features

#### Source

- Sub-repo-perms: add limited support for IPv4 wildcard semantics `(PR #4018)`
  -  Backport 04606e20fbc8f13ad473533820b8f5df71e20ad7 from #3989

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v6.1.4020", "releasedAt": "2025-03-12"} */}


# 6.1 Patch 3

## v6.1.2889

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.1.2889)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.1.2889)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.1.2889)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.1.2889)

### Features

#### Search

- Adds `Team` support in SvelteKit ownership panel `(PR #3830)`
  - Implement  ownership information for the Sveltekit rewrite. Backport 30f3ea6a6c115c633291c388ff599ff107d7f38b from #3738
- Add ownership panel MVP to sveltekit app `(PR #3829)`
  - Adds read-only ownership panel to Sveltekit frontend
  - Gated behind 'svelte-ownership' feature flag
 Backport 469f2ea37a214f3c0eb1cbde012625bdbef84b6f from #3558

### Fix

#### Batch Changes

- TransformChanges.group.directory should not interpret file names as directories `(PR #3726)`
  - Fix(batches): transformChanges.group.directory should not interpret file names as directories  Backport 6ffff463be1743b89ab865018e46a34ff4e549f5 from #3721

#### Cody-Gateway

- Removes ModelCapabilityEdit from Claude 3.7 Sonnet `(PR #3737)`

#### Search

- Missing symbol changes from merge commits in Rockskip `(PR #3844)`
  - This fixes a bug in Rockskip (symbol search) where we would miss symbol changes introduced by merge commits. This bug manifested in incorrect search results and errors of symbols service similar to &quot;pathspec (...) did not match any files&quot;. Backport d8426a9aec4930ce71922562fdebdcfd0d657cb4 from #3699

#### Source

- Fix bug where the token always has to be entered when editing certain code host connections `(PR #3751)`
  - Fixed issue where the code host connection editor would always ask for the token to be re-entered.  Backport 428c1eef19d68b38037bd35457632a007a78494d from #3719

#### Workspaces

- Apply jitter to global reconciler `(PR #3772)`

#### Others

- Update cody web to 0.31.1 to fix issue with pasting linebreaks (#3696) `(PR #3729)`
  - Fix: prompt templates should not fail when pasting linebreaks

### Chore

#### Security

- Update Caddy `(PR #3906)`

### Refactor

#### Search

- Normalize `displayName` across `Person` and `Team` types `(PR #3825)`

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v6.1.2889", "releasedAt": "2025-03-05"} */}


# 6.1 Patch 2

## v6.1.1295

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.1.1295)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.1.1295)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.1.1295)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.1.1295)

### Features

#### Cody-Gateway

- Add thinking/reasoning support to Anthropic models `(PR #3708)`
  - Added support for chain-of-thought reasoning in Anthropic models, allowing users to see the model's thinking process for complex tasks.  Backport 389bf9a4f2cf8ed7762cf8876b0efe4064e2b234 from #3507

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v6.1.1295", "releasedAt": "2025-02-25"} */}


# 6.1 Patch 1

## v6.1.376

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.1.376)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.1.376)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.1.376)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.1.376)

### Features

#### Agents

- Add support for globally enabled rules (#3480) `(PR #3502)`
- Simplify agent admin onboarding experience `(PR #3501)`
  - You can now create a GitHub App with all the right permissions/events for code review agents. Previously, you had to manually customize the apps.  Backport 87e8d77f464912cbd4356a8c3c39fba1d099e3b6 from #3473

#### Cody

- Add "autocomplete" capability to Claude Haiku models `(PR #3638)`

#### Tenant

- Telemetry for adding code `(PR #3560)`

### Fix

#### Agents

- Fix bug when using global rules in default revision `(PR #3524)`
- Fix bug where POST /reviews always failed `(PR #3522)`
- Improve error reporting in `POST /reviews` `(PR #3518)`
- Render errors as strings in agent run logs `(PR #3516)`
  - Errors are now rendered as strings in agent run logs. Previously, they rendered as `Source: {}`, which wasn't helpful.
 Backport d1f18d280fc9d3a985a284c31e819412d2add606 from #3514
- Hide listing of rules to fix unconditional error `(PR #3498)`

#### Code Intelligence

- Correctly handle document counts exceeding MaxInt32 `(PR #3596)`
  - Fixes a bug in SCIP index processing for instances with a long history
of processing large uploads.  Backport 48e7b47898ee7710f12270c6861c335a2ef75f48 from #3595

#### Release

- Check for and remove timescaledb extension `(PR #3584)`
  - Fix(rel): remove TimescaleDB from existing database if found during upgrade to Postgres 16 on the codeinsights database.
  Backport 71b4af3d6faef054803db0151b2cc7b151bb1c0e from #3556

#### Security

- Allow the admin's HTTP auth provider headers in CORS preflight requests `(PR #3540)`
  - HTTP header auth username and email headers, if configured, are no longer blocked by CORS.  Backport 782b98a780dac335576b8f43affb4b1a10123882 from #3512

#### Others

- TransformChanges.group.directory should ignore file names `(PR #3594)`
  - Fix: transformChanges.group.directory now ignores file names
  Backport 3b76fe4ab146565b0e736231353b1e24f1468241 from #3576
- Fix missing JSON schema on serve-git connection page `(PR #3567)`
- Do not close stream when tab is unfocused `(PR #3529)`
  - Fixes an (unreleased) issue that could cause duplicate search results when switching between tabs.
 Backport 746a29a25d6e54dfe7ab38f70855a9f58a652426 from #3528

### Chore

#### Agents

- Allow non-site-admins to read agent endpoints [CODY-4962] `(PR #3511)`
  - GET access to `/.api/agent/*` endpoints for non-site admins  Backport 321543c38aab312c7d3924e19617f9f247c3a5fa from #3504

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- Backport 3542 to 6.1.x `(PR #3612)`
- [Backport 6.1.x] tenant: Report newRepositoryTotalSizeBytes for setSelectedRepos `(PR #3568)`

{/* RSS={"version":"v6.1.376", "releasedAt": "2025-02-19"} */}


# 6.1 Patch 0

## v6.1.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.1.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.1.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.1.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.1.0)

### Features

#### Agents

- Allow code review agent to auto-run based on feature flags `(PR #3477)`
  - Code review agents can now automatically run on GitHub Pull Requests (actions: `opened` and `synchronize`) based on a feature flag. Both boolean (true/false) and rollout (percentage-based ) feature flags are supported. For example, this means you can enable automatic reviews on 10% of all opened PRs.
- Review Diagnostic Feedback [CODY-4951] `(PR #3456)`
  - Adds a feedback UI for diagnostics within the Agents app.
- Report progress with GitHub Commit Status API `(PR #3445)`
  - The Code Review Agent now reports live status with the GitHub Commit Status API making it possible to open Agent logs directly from GitHub.
- Make Review Agent leverage PR title and description (CODY-4749) `(PR #3431)`
- Make review triggers configurable `(PR #3368)`
  - You can now request review from the Review Agent by posting a pull request comment with a configurable substring
- Code reviews deduplicate diagnostics from historical review [CODY-4743] `(PR #3355)`
  - Code reviews deduplicate diagnostics from historical reviews
- Add basic review rules to repo `(PR #3335)`
- Rules-related API improvements `(PR #3305)`
- Read the cody repo for rules as well `(PR #3212)`
- Show rules that apply to a file in the code view `(PR #3200)`
- More agents UI updates `(PR #3177)`
- Add Run API, view live progress on agent runs `(PR #3171)`
  - Add `GET /.api/agents/runs` to list runs of an agent, and other related endpoints including the ability to view logs
- Make Review agent handle large diffs `(PR #3136)`
  - The Review agent can now review larger diffs.
- Expose rules API endpoints and use rule URIs instead of IDs `(PR #3056)`
- Adds Conversation HTTP handlers and generated DB columns [CODY-4751] `(PR #3021)`
  - Adds HTTP handlers for `/.api/conversations` for creating and filtering conversations as well as a DB method for querying conversations.
- Agents UI and requisite new APIs `(PR #2818)`

#### Code Intelligence

- Syntactic indexing job resetter `(PR #3336)`
- Periodically delete old audit logs from syntactic jobs `(PR #3278)`

#### Cody

- Add Prompt Caching to Code Context (CODY-4807) `(PR #3198)`

#### Cody-Gateway

- Add actor-auth-status metric `(PR #3460)`
- Add cache related token usage data to telemetry(CODY-4808) `(PR #3396)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)
- Roll out new Gemini Models `(PR #3357)`
  - Move Gemini 2.0 Flash from Experimental to GA, add Gemini 2.0 Flash-Lite Preview Experimental and Gemini 2.0 Pro Experimental

#### Enterpriseportal

- Add tracking for verified domains `(PR #3447)`

#### Lib/Msp

- Add OTEL instrumentation to gRPC clients by default `(PR #3428)`

#### Local

- Install mise as part of `sg setup` and deprecate asdf `(PR #2877)`

#### Model-Config

- Implement reasoning parameters for OpenAI models `(PR #3489)`

#### Msp/Auditlog

- Add trace ID to response headers `(PR #3248)`

#### Release

- Add init subsection to release.yaml `(PR #3223)`
  - Feat: add init cmd subsection to release.yaml parser
  - Feat: add init section to release.yaml

#### Release

- `sg upgradetest` `(PR #3388)`
  - Allow the upgradetest to be run locally without knowing the bazel invocation required to stamp the build etc
  - Unlock local minor and major branch upgradetests

#### Search

- Add enterprise starter cta to dotcom search home `(PR #3090)`

#### Telemetry

- Add events for repo page views `(PR #3265)`
- Add billing metadata to toggles `(PR #3264)`

#### Tenant

- Fix workspace management UI quirks `(PR #3227)`

#### Web

- Update cloning status to new designs `(PR #2760)`

#### Workspace

- Workspace creation error UX `(PR #3383)`

#### Workspaces

- Attach cf ray id to otel traces `(PR #3387)`
- Add WORKSPACES_ROUTER_DISABLE_RECONCILERS `(PR #3382)`
- Upsert/delete route on manual reconcile `(PR #3378)`
- Contact support to claim a name `(PR #3340)`
- Record clientside payment errors `(PR #3319)`
- Remove profanity blocks `(PR #3317)`
- Add cancellation/churn notifications in Slack `(PR #3314)`
- Add 'code search and code navigation' to plan page `(PR #3267)`
- Allow creation form to be pre-filled with a coupon `(PR #3228)`
- Seat-purchase notifications for Slack `(PR #3225)`
- Allow Stripe promo codes only, enforce short-lived promo codes `(PR #3222)`
- Enforce SAMS client per instance, add instance debug UI `(PR #3138)`
- Metric for Cloudflare interactions, include status from Stripe `(PR #3117)`
- Internal admin trigger to reconcile workspace `(PR #3070)`
- Add instance class option for employees `(PR #3067)`
- Write snapshot of workspace details into BigQuery on creation `(PR #3049)`
- Plans page refresh `(PR #2983)`

#### Workspaces/Billing

- Add workspace name/displayname to Slack notifications `(PR #3262)`
- Include total seats in slack notification `(PR #3260)`

#### Workspaces/Slack

- Make coupons links, refactor slack formatting `(PR #3332)`

#### Workspaces/Telemetry

- Add marketingtracking and anonymous UID `(PR #3343)`

#### Others

- Prompt templates editor supports @ current mentions `(PR #3397)`
  - Feat: prompt templates editor supports dynamic @ mentions
- Add event for codeintel highlights `(PR #3261)`
- Add support for VoyageAI reranker `(PR #3155)`

### Fix

#### Agents

- Redirect to settings page after creating agents `(PR #3471)`
  - Creating a new agent now redirects to the settings page for further setup
- Correct typo in system prompt `(PR #3421)`
- Disable Agents unless feature flag is enabled `(PR #3420)`
- Show diagnostics on review page `(PR #3358)`
- Fix bug where review agent posted comments on wrong lines `(PR #3347)`
- Add fallback when rules list is empty (CODY-4834) `(PR #3285)`
- Use globs instead of regexp for include/exclude filters `(PR #3277)`
  - Rule include/exclude patterns are now interpreted as globs (`*.go`) instead of regexp (`.*\.go`). Negative include patterns like `!*.go` will be interpreted as exclude patterns, and vice versa.
- Remove agents from the navbar on dotcom `(PR #3166)`

#### Auth

- Add missing allowSignup option to HTTP header auth provider `(PR #3232)`
  - Fix/auth: "http-header" auth provider can "allowSignup": false to disable automatic account creation

#### Ci

- Disable puppeteer browser tests `(PR #3298)`
- Disable client checks `(PR #3290)`
- Update licenses script and rerun it `(PR #3053)`

#### Code Intelligence

- Optimize GetSymbolUsages core query `(PR #3035)`
- Decorrelate subquery for hover docs `(PR #3031)`
- Bound number of docs read for GetHover `(PR #3000)`

#### Cody

- Include token usage in OpenAI streaming requests `(PR #3441)`
- Check that completion exists `(PR #3410)`
- Include token usage in OpenAI streaming requests `(PR #3376)`
- Use max_completion_tokens field for OpenAI `(PR #3362)`
- Pull correct client-name param `(PR #3167)`
- Show actual chat quota usage for free-tier users `(PR #2970)`
- Filter allowed models by capability for PLG users `(PR #2506)`

#### Cody-Gateway

- V1/limits handler `(PR #2908)`

#### Dev

- Internal/memcmd: add support for using mise in tests `(PR #3256)`

#### Local

- Set GOWORK=off for frontend in sg `(PR #3111)`

#### Models

- Update OpenAI o3-mini model pricing `(PR #3303)`

#### Msp/Iam

- Grant Cloud Deploy executor access to images `(PR #3175)`

#### Msp/Runtime

- Fix pgx pool stats metric `(PR #3126)`

#### Multi Tenant

- Bring back description text to the github add account setup step `(PR #3325)`
- Improve workspace validation states `(PR #3093)`

#### Multitenant/Mt-Router

- Fix up routes and redirect `(PR #3195)`

#### Release

- Fix migrator update check `(PR #3173)`
  - Fix(rel): fix migrator upgrade check

#### Search

- Change chevrons in in-file search panel `(PR #3367)`
- Web app broken if settings contains 'message' key `(PR #3363)`
- Bust cache for new logo (favicon) `(PR #3350)`
- Use separate light and dark SG logo variants `(PR #3280)`
- Link to correct dashboard page in extensions CTA `(PR #3182)`
- Fix search aggregation chart popover `(PR #3046)`
- Chat tips modal covered by file sidebar `(PR #3016)`

#### Source

- Fix Gerrit clone URL resolution `(PR #3446)`
- Fix inability to update Gerrit code host config URL `(PR #3361)`
  - Fix bug where the URL of a Gerrit code host connection could not be updated.
- Web: ensure list of external accounts has unique entry for each key `(PR #3323)`
  - A bug on the user's account security page that could result in duplicated / buggy entries has been fixed.
- RepoSource.BitbucketServer.CloneURLToRepoName():  support more URL shapes `(PR #3224)`
  - The logic that translates Bitbucket clone URLs to repository names has been fixed to support:
  - URLs that have no scheme (like `"bitbucket.sgdev.org/sourcegraph/sourcegraph"`)
  - SSH clone urls that don't have a `ssh://` scheme prefix (like `git@bitbucket.sgdev.org:sourcegraph/sourcegraph.git`)
- Gitserver: merge base: add explicit test to ensure ordering of RevisionNotFoundErrors `(PR #2779)`

#### Tenant/Repositories

- Do not show search text if empty `(PR #3321)`

#### Ui

- Display Revision not found instead of Empty repo `(PR #3235)`

#### Web

- Add missing separator under organizations `(PR #3253)`

#### Workspaces

- Correctly apply management retries `(PR #3384)`
- Spread out routerreconciler workload more `(PR #3377)`
- Reduce frequency of custom input telemetry event `(PR #3342)`
- Apply coupon when estimating price on existing subscription `(PR #3331)`
- Tweak plan page copy again `(PR #3328)`
- Use display name on join page `(PR #3326)`
- Drill coupon from homepage, make sure coupon is applied immediately `(PR #3312)`
- More sentence-casing fixes `(PR #3255)`
- Fix capitalization in creation form `(PR #3218)`
- Hide open-invites toggle when email domain is not allowed `(PR #3213)`
- Price is monthly `(PR #3197)`
- Fix name validation `(PR #3165)`
- Include class in unseen instance counts, remove unseen instances from normal counts `(PR #3134)`
- Log check-name errors as unexpected errors `(PR #3075)`
- Test that post-normalization bad words are caught `(PR #3047)`

#### Workspaces/At-Capacity

- Capitalize error message `(PR #3381)`

#### Workspaces/Metrics

- Report all workspace/instance states `(PR #3297)`

#### Others

- Color removed from filter sidebar in search `(PR #3399)`
- Change workspace icon in profile menu `(PR #3241)`
- Fix yaml file `(PR #3183)`
- Index matches safely `(PR #3168)`
- Server checks reindex at 5.10 now `(PR #2881)`
  - Single docker server checks for 5.10-reindex.completed instead of 5.1-reindex.completed

### Chore

#### Agents

- Basic Telemetry for Code Review [CODY-4903] `(PR #3389)`
- [CODY-4830] Update Conversation and Review store patterns `(PR #3259)`
- Remove typebox for runtime type validation `(PR #3214)`

#### Ci

- Migrate rules_oci to MODULE.bazel `(PR #3352)`
- Fixes gazelle issues `(PR #3296)`
- Migrate rules_go and gazelle to bazel mod `(PR #1716)`

#### Cloud

- Update cloud-mi2 wolfi base image `(PR #3199)`

#### Code Intelligence

- Make scip-syntax parallelism configurable `(PR #3206)`
- Use clearer names & error propagation in SCIW initialization `(PR #2997)`

#### Deps

- Upgrade sourcegraph-accounts-sdk-go `(PR #3142)`

#### Dev

- Upgrade to pnpm v9.15.4 `(PR #3266)`
- Delete go.mod for monitoring/ directory `(PR #2951)`

#### Modelconfig

- Remove spammy logs `(PR #3452)`

#### Msp/Cloudsql

- Remove pgx.Acquire span `(PR #3141)`

#### Release

- Update src-cli dependencies for 6.0.0 release `(PR #3186)`
  - Release src-cli 6.0.0

#### Search

- Permanently enable the new web app on dotcom `(PR #3448)`
- Remove new branding branching logic `(PR #3270)`

#### Security

- Auto-update all packages in Sourcegraph base images `(PR #3482)`
- Auto-update all packages in Sourcegraph base images `(PR #3239)`

#### Workspaces

- Remove cody upsell in workspace creation `(PR #3391)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)
- Update ES Cody limits to 2x Enterprise `(PR #3069)`
- Make user metadata available on userauth.UserInfo `(PR #3051)`

#### Workspaces/Blocklists

- Add 'unconfigured' to blocked names `(PR #3043)`

#### Workspaces/Web

- Rename 'quickJoin' vars to 'openInvite' `(PR #2974)`

#### Others

- Update list of allowed headers for untrusted clients `(PR #3486)`
- Add events for hoverables `(PR #3433)`
- Update third-party licenses `(PR #3414)`
- Output formatting updates based on feedback `(PR #3349)`
- Entitle URL updates `(PR #3345)`
- Add more doc comments for file checker types `(PR #3307)`
- Update third-party licenses `(PR #3273)`
- Fix integration tests `(PR #3263)`
- Update teams.yml for product platform changes `(PR #3252)`
- Remove orphaned modules / import to non-exisiting module `(PR #3219)`
- Drop hubspot logging from non-dotcom auth methods `(PR #3132)`
- Update third-party licenses `(PR #3095)`
- Remove gorilla/context `(PR #3089)`
- Layout finetuning of Creating Workspaces and Tenant Onboarding `(PR #3065)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)

### Reverts

- Revert: use max_completion_tokens field for OpenAI and the inclusion of token usage in OpenAI streaming requests `(PR #-1)`
- Revert "Omnibox: route likely code generation commands to Chat (#2969)" `(PR #2969)`

### Uncategorized

#### Others

- Update Cody Web v0.31.0 `(PR #3474)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)
- Gateway: Bump limits for ES `(PR #3409)`
- Gomod: update Zoekt for file language fix `(PR #3408)`
- Msp: use TFC robot email for IAP `(PR #3400)`
- Alexjean baptiste cody 4813 azure gpt model enum update or override `(PR #3380)`
- Web: Make CTA for workspaces correctly reload page for marketing content `(PR #3341)`
- Fix path to pt to updated `useObservables` family of hooks `(PR #3322)`
- Removing DeepSeek V3 model `(PR #3309)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)
- Workspaces: Never show wallet payments `(PR #3304)`
- Sg: Extend the mise check to early-exit if env var is set `(PR #3302)`
- Refactor(cody-gateway) Remove support for OpenAI o1-mini model (CODY-4839) `(PR #3295)`
  - Remove support for OpenAI o1-mini model.
- Refactor(cody-gateway) Deprecate Gemini 1.5 Flash, Claude 3 Opus, Claude 3 Haiku, and Mixtral 8x7B (CODY-4839) `(PR #3293)`
  - Deprecate Gemini 1.5 Flash, Claude 3 Opus, Claude 3 Haiku, and Mixtral 8x7B
- Gomod: bump Zoekt after package restructuring `(PR #3271)`
- Adding O3 mini model to OpenAI `(PR #3254)`
  - Adding O3 mini model to OpenAI `(PR #3254)`
- Telemetry: add ClientFeature for more granular reporting of search events `(PR #3229)`
- Search: enable scip-ctags for C `(PR #3215)`
- Cleanup: simplify search observables and switch to fetch-event-source `(PR #3196)`
- Completions: improve prometheus metrics for code/chat completions `(PR #3181)`
- Partially fix erroneous `svelte-check` errors in local dev `(PR #3180)`
- Adding DeepSeek V3 support through fireworks `(PR #3170)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)
- Lib/marketingtracking: publish module for SAMS to consume `(PR #3169)`
- Web: Some more user menu polish `(PR #3140)`
- Remove builtin rules from code review agent `(PR #3086)`
- Workaround for `sg start minimal-sveltekit` and other "minimal" entrypoints `(PR #3085)`
- Doc/workspaces: fix link to chargeback playbook `(PR #3076)`
- Generate TypeScript types and runtime type validators for Agent API `(PR #3055)`
- Update sg setup for employees `(PR #2990)`
- Chore(Workspaces) Fix repo size increment from 500mb to 1 gig `(PR #2977)`
- Feat(agents) Conversations API DB Tables [CODY-4683]  `(PR #2964)`
  - Adds `agent_conversations` and `agent_conversation_messages` tables as well as `ConversationStore`
- Replace o1 preview model with o1 `(PR #2924)`
  - OPTIONAL; info at [https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c](https://www.notion.so/sourcegraph/Writing-a-changelog-entry-dd997f411d524caabf0d8d38a24a878c)
- Feature(codeintel): add syntax highlighting for Svelte `(PR #2690)`
  - Added syntax highlighting for `.svelte` files
- Mt-router: allow passthrough for instance health check endpoint `(PR #2689)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Fix Gerrit clone URL resolution (#3446) `(PR #3449)`
- Fix inability to update Gerrit code host config URL (#3361) `(PR #3439)`
  - Fix bug where the URL of a Gerrit code host connection could not be updated.(cherry picked from commit e6da1ceb9586bf109339f06220c1fdbbf570a6d9)
- Prompt templates editor supports @ current mentions (#3397) `(PR #3436)`
  - Feat: prompt templates editor supports dynamic @ mentionsPR description tips: [https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e](https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e)
- Roll out new Gemini Models (#3357) `(PR #3412)`
  - Move Gemini 2.0 Flash from Experimental to GA, add Gemini 2.0 Flash-Lite Preview Experimental and Gemini 2.0 Pro ExperimentalCo-authored-by: arafatkatze [arafat.da.khan@gmail.com](mailto:arafat.da.khan@gmail.com)
(cherry picked from commit 4aa5aa41cc0f5e2be80c77e8e8709e198ff54b94)PR description tips: [https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e](https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e)
- Backport 3254 to 6.0.x `(PR #3300)`
- [backport] fix/web: add missing separator under organizations (#3253) `(PR #3282)`
- Auto-update all packages in Sourcegraph base images `(PR #3237)`
- [backport] feat/tenant: fix workspace management UI quirks (#3227) `(PR #3230)`
- [backport] feat/web: Update cloning status to new designs (#2760) `(PR #3158)`
- Layout finetuning of Creating Workspaces and Tenant Onboarding (#3065) `(PR #3139)`
Revert "Fix: Buildkite Pipeline generates images with specific cloud tags for S2 deployments" `(PR #2985)`
Revert "fix: set the tag in the push_all.sh script" `(PR #2989)`
- Fix: Buildkite Pipeline generates images with specific cloud tags for S2 deployments `(PR #2985)`
  - NA - No customer facing changes

{/* RSS={"version":"v6.1.0", "releasedAt": "2025-02-17"} */}

# 6.0 Patch 2

> Attention -  This patch contains security fixes for a know issue in previous 6.0 releases. This issue does not affect
> 6.1 and later Sourcegraph releases. Customers on previous 6.0 releases are advised to upgrade to the latest version of Sourcegraph.
> If you are required to continue on 6.0 release series, please upgrade to 6.0 Patch 2.

## v6.0.12741

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.0.12741)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.0.12741)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.0.12741)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.0.12741)

### Features

#### Dev

- Enable gcloud beta `(PR #3490)`

#### Release

- Fix post-release version selection `(PR #4659)`

#### Others

- Update cody web to 0.31.1 to fix issue with pasting linebreaks (#3696) `(PR #3728)`
- Fix: prompt templates should not fail when pasting linebreaks


### Uncategorized

#### Others

- [Backport 6.0.x] security/fix: don't print access tokens `(PR #4801)`

{/* RSS={"version":"v6.0.12741", "releasedAt": "2025-04-09"} */}

# 6.0 Patch 1

> Attention -  This patch contains a known security issue. This issue does not affect 6.1 and later Sourcegraph releases.
> Customers on previous this release are advised to upgrade to the latest version of Sourcegraph.
> If you are required to continue on 6.0 release series, please upgrade to 6.0 Patch 2.

## v6.0.2687

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.0.2687)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.0.2687)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.0.2687)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.0.2687)

### Features

#### Cody-Gateway

- Roll out new Gemini Models (#3357) `(PR #3412)`
  - Move Gemini 2.0 Flash from Experimental to GA, add Gemini 2.0 Flash-Lite Preview Experimental and Gemini 2.0 Pro ExperimentalCo-authored-by: arafatkatze [arafat.da.khan@gmail.com](mailto:arafat.da.khan@gmail.com)
(cherry picked from commit 4aa5aa41cc0f5e2be80c77e8e8709e198ff54b94)PR description tips: [https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e](https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e)

#### Multitenant

- Add support for alternate default tenant hostname `(PR #3176)`

#### Security

- Create Binary Authorization attestations when promoting images to public `(PR #3478)`

#### Others

- Prompt templates editor supports @ current mentions (#3397) `(PR #3436)`
  - Feat: prompt templates editor supports dynamic @ mentionsPR description tips: [https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e](https://www.notion.so/sourcegraph/Write-a-good-pull-request-description-610a7fd3e613496eb76f450db5a49b6e)

### Fix

#### Multi Tenant

- Fixing paper cuts for mt marketing launch (#3242) `(PR #3281)`
- Misc wording fixes in workspaces onboarding `(PR #3207)`
- Fixes welcome message alert `(PR #3174)`

#### Source

- Fix Gerrit clone URL resolution (#3446) `(PR #3449)`
- Fix inability to update Gerrit code host config URL (#3361) `(PR #3439)`
  - Fix bug where the URL of a Gerrit code host connection could not be updated.(cherry picked from commit e6da1ceb9586bf109339f06220c1fdbbf570a6d9)
- Normalize code host URLs during code host config unmarshaâ€¦ `(PR #3438)`
- Gitserver: Unambiguously identify commit boundaries in git log `(PR #3411)`
  - Commit listing should work correctly for repos which contain arbitrary characters in commit messages. This also affects downstream functionality such as commit graph updates needed for precise code navigation.Backport 2eae8e1 from #3359

### Chore

#### Security

- Auto-update all packages in Sourcegraph base images `(PR #3237)`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 6.0.x] gitserver: Fix API endpoint for installation token creation `(PR #3432)`
- [backport] chore/source: Update src-cli to 6.0.1 (#3365) `(PR #3416)`
  - Update src-cli version to 6.0.1
- [backport] fix/tenant: fix invitation expiry, user management UX improvements (#3353) `(PR #3356)`
- [Backport 6.0.x] tenant: Also allow to add fork repos `(PR #3348)`
- Backport 3254 to 6.0.x `(PR #3300)`
- [backport] feat/prompts: support public prompts/saved-searches in workspaces using RBAC (#3257) `(PR #3294)`
- [backport] fix/web: add missing separator under organizations (#3253) `(PR #3282)`
- [backport] feat/tenant: fix workspace management UI quirks (#3227) `(PR #3230)`

{/* RSS={"version":"v6.0.2687", "releasedAt": "2025-02-12"} */}


# 6.0 Patch 0

> Attention -  This patch contains a known security issue. This issue does not affect 6.1 and later Sourcegraph releases.
> Customers on previous this release are advised to upgrade to the latest version of Sourcegraph.
> If you are required to continue on 6.0 release series, please upgrade to 6.0 Patch 2.

> Attention -  Postgres 12 is no longer supported! If upgrading from Sourcegraph version 5.9 or earlier, this release will update our included database container images from Postgres 12 to Postgres 16.
> Customers are advised to have a database backup before upgrading. See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice for more information.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v6.0.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v6.0.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v6.0.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v6.0.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v6.0.0)

### Features

#### Agents

- Make review agent configurable via program files `(PR #2962)`
  - The Review agent now requires the program file `.sourcegraph/review-agent.json` with at least the content `"{}"` to enable posting Pull Requests review through the GitHub App. The JSON file may contain additional configuration options to override defaults of the `ReviewRequestConfiguration` object (see OpenAPI spec)

#### Ci

- Publish images with branch tag on release branch `(PR #3039)`
- Tag release branch images with branch image tag `(PR #3032)`

#### Cloud

- Add support to collect web vitals metrics to web-svelte `(PR #2735)`

#### Code Intelligence

- Add audit logs for changes to syntactic jobs `(PR #2893)`
- Highlights json files with tree-sitter `(PR #2469)`
  - Improved highlighting for JSON files

#### Cody

- Improve rendering of diagnostics as GitHub comments `(PR #2954)`
  - The Review Agent now includes the rule ID when posting comments on pull requests. By default, the minimum review severity is errors (previously it was warning). When the minimum severity is overridden to be warnings, then the review comments will also include the severity.
- Make Review Agent rule detection configurable `(PR #2913)`
  - Configure custom review rules for the Review Agent by adding `*.rule.md` files nested under `.sourcegraph/` directories in any ancestor director of files in the diff.
- Sourcegraph Agents `(PR #2739)`
  - New `/.api/agents/**` endpoints to manage the creation of Sourcegraph Agents (EAP feature).
  - New support to automatically review GitHub Pull Requests with a Review Agent via GitHub Apps (EAP feature).
- First stab at a Code Review Agent API `(PR #2568)`
  - New `GET /.api/tools` endpoint to list tool definitions for Sourcegraph API endpoints to use with the LLM /chat/completions endpoint for function calling.
  - New `POST /.api/review/diff` endpoint to get a list of code review comments given a git diff (including GitHub pull requests and Gitlab merge requests).

#### Dev

- Add support to export otel metrics to prom in local dev `(PR #2781)`

#### Dotcom

- Support Svelte workspace switcher in dotcom `(PR #2675)`
- Enable workspaces-prod proxy `(PR #2664)`
- Add feature flag to enable React switcher in dotcom POC `(PR #2659)`

#### Msp

- Add client details to MSP audit logs `(PR #2887)`
- Enable CloudSQL Enterprise Plus with postgresql.highAvailability `(PR #2682)`
- Upgrade CloudSQL to POSTGRES_16 `(PR #2667)`
- Support BigQuery table partitioning `(PR #2597)`

#### Multi Tenant

- Enable extension setup step for everyone `(PR #3137)`
- Add org wasn't added modal UI `(PR #3072)`
- Add cancel subscription UI `(PR #3044)`
- Polish join workspace and status pages `(PR #2900)`
- Support 3ds and redirection-based payment flow for workspace creation `(PR #2865)`
- Enable the new Sourcegraph branding by default `(PR #2801)`
- Polish workspace creation flow `(PR #2787)`
- Prepare common svelte UI for workspaces app `(PR #2734)`
- Connect repositories management page to API `(PR #2688)`
- Improve switch tenant UI `(PR #2656)`
- Add workspace billing settings page `(PR #2600)`
- Add workspace settings users page `(PR #2504)`
- Add workspace settings general page `(PR #2503)`
- Add workspace settings main layout `(PR #2502)`

#### Multi-Tenant/Mt-Router

- Add prod deployment `(PR #2622)`

#### Multitenant

- Add UseRandomExternalAccount code host connection option and use it in MT `(PR #2821)`
- Disable web app toggle by default on workspaces `(PR #2771)`
- No pings, no telemetry redaction `(PR #2491)`

#### Rbac

- Add USER_EXTERNAL_ACCOUNTS#READ_ALL_USERS for workspace admin `(PR #2512)`

#### Release

- Address pg12 -> pg16 drift with normalization `(PR #2950)`
  - Normalize drift detection to handle for postgres 12 to 16 upgrade

#### Search

- Code search is homepage for workspaces `(PR #3127)`
- Add upsell menu items `(PR #3122)`
- Update production favicon `(PR #2909)`
- Add omnibox routes `(PR #2797)`
- Add new main navigation (feature flagged) `(PR #2768)`
- Use new brand logo to web apps (feature flagged) `(PR #2767)`
- (new web app) Add download option to file page `(PR #2461)`
- (new web app) Add padding and messages to end of search results `(PR #2455)`

#### Source

- Multitenant: add "edit" state when editing workspace repositories `(PR #2849)`

#### Telemetry

- Allowlist model metadata on `privateMetadata` `(PR #2832)`

#### Tenant/Billing

- Use EstimateWorkspaceSubscriptionSubtotal in UpdateSeatsModal `(PR #2930)`

#### Tenants/Telemetry

- Report external URL for workspace identifier `(PR #2602)`

#### Web/Tenant

- Update selected repos and repo size with pending state `(PR #2925)`

#### Workspace

- Open up instance url inside of vs code `(PR #2782)`
- Add billing link to request-to-join template params `(PR #2596)`

#### Workspaces

- Add background goroutine job that emits telemetry about repo count and size `(PR #3130)`
- Metrics for subscription renewals and debt collection `(PR #2886)`
- Prevent workspace ID prefix from being used in names `(PR #2841)`
- Import suspiciousnames to blocklist `(PR #2803)`
- Add AdministrationService, /internal UI for suspending workspaces `(PR #2786)`
- Add some plans telemetry `(PR #2783)`
- Restrict display name length `(PR #2776)`
- Add suspension states `(PR #2751)`
- Bypass some workspace name checks with SAMS user metadata `(PR #2733)`
- Allow configurable sender address `(PR #2729)`
- Add seat count events `(PR #2665)`
- State transition log `(PR #2661)`
- Required email domains `(PR #2614)`
- Improve wording of name-check errors, add telemetry `(PR #2593)`
- Initial web and service telemetry `(PR #2522)`
- Global creation control `(PR #2498)`
- Status pages for workspace not found and suspended `(PR #2438)`
- Handle SAMS user deletion `(PR #2384)`

#### Workspaces/Billing

- Counter for stripe API usage `(PR #2855)`

#### Workspaces/Internal

- Support ID lookup `(PR #2839)`

#### Workspaces/Routerreconciler

- Make upsert reconcile incremental `(PR #2848)`

#### Workspaces/Settings

- Add workspace ID to sidebar `(PR #2728)`

#### Workspaces/Web

- Add telemetry events for workspace plans `(PR #2840)`
- Set title to Sourcegraph Workspaces `(PR #2834)`

#### Others

- Add CTA for agents API `(PR #2799)`
- Prompt templates now support specific @ mentions `(PR #2793)`
  - Feat: prompt templates now support specific @ mentions
- Propagate bestScoringLine and use that to center chunks in the search UI `(PR #2683)`
  - For broad matches, we now center the best-scoring line in search results
- Add tools support to LLM API (aka. function calling) `(PR #2537)`
  - The `/.api/llm/chat/completions` endpoint now support function calling via the `tools` property. This feature works when using the LLM providers: OpenAI, Anthropic, Fireworks, AWS Bedrock, and Gemini.
- Add ability to boost user-relevant repos for `patterntype:nls` `(PR #2489)`

### Fix

#### Actor

- Better preserve anonymous user ID for telemetry `(PR #2546)`

#### Agents

- Remove leftover printf statement `(PR #3079)`
  -  Backport 9639850855bb169f7dee4fbcff869c77c17f9328 from #3007
- Fix bug in AgentStore.ListByWebhookID and LLMChatClient `(PR #3054)`
  - Fixed bug in Review Agent where it didn't post review comments even
for small diffs
Backport 4710b59 from #3019

#### Auth

- Improve session expiration behavior `(PR #2765)`
  - We are changing the behavior of session expiration to be a hard-cap instead of a rolling window.
`auth.sessionExpiry` will now set a hard-limit on the sessions lifetime, and users will have to re-authenticate after this period.
To preserve the previous behavior where sessions would be invalidated after they haven't been used for a while, a new configuration option named `auth.maxSessionIdleDuration` has been introduced that controls session expiration based on inactivity.
- Don't expire sessions based on OAuth token validity `(PR #2761)`
  - Fixed an issue where Sourcegraph user sessions initiated via OAuth integrations did not respect the `auth.sessionExpiry` configuration and expired much earlier.

#### Ci

- Include push version tag to private registry `(PR #3074)`
- Add handling for unbound variable in push_all.sh `(PR #3036)`

#### Cloud

- Add explicit bucket to lcp metrics `(PR #2846)`
- Typo in metric attrs name `(PR #2804)`

#### Code Intelligence

- Better cleanup in syntactic indexing worker `(PR #3156)`
- Don't create unscoped Logger `(PR #2945)`
- Overwrite old->new commit for syntactic indexing jobs `(PR #2764)`
- Handle missing committer date in policy code `(PR #2696)`
- Add DB constraints for syntactic jobs+policies `(PR #2566)`
  - In the site admin configuration for code graph policies, restricts the creation of policies for syntactic indexing to HEAD-only. This restriction may be lifted in the future. Policies for precise auto-indexing are not affected.
- Enforce auth conditions in repo scheduling `(PR #2549)`

#### Cody

- Add billing metadata to prompt library events `(PR #3116)`
- Make public OpenAPI docs work again `(PR #3081)`
  -  Backport dc8deea005067145855b03a3344675386bc75be7 from #3078
- Minor fixes `(PR #2916)`

#### Cody-Gateway

- Fail-open Enterprise subscription sync `(PR #2775)`

#### Dev

- Fix transitive use of global counters in tests `(PR #2905)`

#### Dev/Svelte

- Send all 'default.' requests to server `(PR #2923)`

#### Dotcom

- Tweaks for dotcom-mode workspace switcher `(PR #2684)`

#### Gitserver

- Return error on no merge base `(PR #2790)`

#### Goroutine

- Do not redact stacktrace `(PR #2571)`

#### Intent

- Remove heuristic for marking one-term queries as searches `(PR #2580)`

#### Multi Tenant

- Fixes welcome message alert `(PR #3174)`
- Fix flashes and incorrect free up seat mutation in user management `(PR #3058)`
- Add support for workspace vscode sign up flow `(PR #2942)`
- Force to keep only one dropdown menu visible `(PR #2903)`
- Fix small paper cuts in workspace-creation flow `(PR #2809)`
- Fix Safari 16.6 billing layout (sub-grids rows) `(PR #2721)`
- Add a better error handling for workspace settings pages `(PR #2707)`
- Fix post workspace delete redirection `(PR #2698)`
- Fix user management reduce seats case `(PR #2647)`
- Fixes update seats modal max count validation `(PR #2616)`
- Fixes general setting page re-submitting problem `(PR #2548)`

#### Multitenant

- Public repositories should no longer be duplicatable `(PR #2828)`
- Only evaluate newly added repositories `(PR #2701)`
- Add telemetry for when repositories are added or removed `(PR #2346)`
  - N/A
- Add telemetry event for when onboarding repository checks fail `(PR #2337)`
  - N/A

#### Navbar

- Add divider after orgs `(PR #2921)`

#### Observability

- Align Cody completions metrics queries with chart names in Grafana `(PR #2476)`

#### Release

- Add handling of cp failure for postgres conf `(PR #3113)`
  - Fix(rel): add handling for permissions errors when handling custom Postgres configurations in database containers.Backport 67bddb2 from #3041

#### Search

- Fix brand logo and colors `(PR #3120)`
- Do not show code search menu item when code search is disabled `(PR #3118)`
- (new web ui) Add search upsell page `(PR #2979)`
- Update breadcrumbs integration test `(PR #2960)`
- Cody marketing page redirect on dotcom `(PR #2952)`
- Update response dashboards to use streaming search `(PR #2932)`
- Insights: fix mouse click cursor behavior when creating new insight `(PR #2851)`
- Accept escaped characters in `content` filters `(PR #2807)`
- Fix repo-rev (button-group) ui `(PR #2806)`
- Add response telemetry for streaming search `(PR #2784)`
- VSCode Search extension - Auth panel not loading when filesystem is case sensitive `(PR #2713)`
  - Fixes `404 errors when trying to load "authSidebar.js"` when the Code Search VS Code extension is used with the VSCode Remote SSH extension
- Remove alert suggesting structural search `(PR #2615)`
- (new web ui) Open files in new tab when clicked on with ctrl/cmd `(PR #2557)`
- Add missing return in SearchQuery.RepositoryRevSpecs `(PR #2521)`
- (new web app) Redirect /cody to /cody/chat `(PR #2475)`
- (new web app) Set correct fuzzy finder request headers `(PR #2449)`
- (new web app) Respect notices settings `(PR #2417)`

#### Source

- Check if user can access installations for public repositories `(PR #2963)`
- Change ListSelectedRepositories to filter for the random external account connection `(PR #2911)`
- Fix UseRandomExternalAccount connection check `(PR #2904)`
- Multitenant: fix nil panic in ListSelectedRepositories multitenant endpoint `(PR #2844)`
- Do not create a connection with no repositories `(PR #2395)`

#### Telemetry

- Uniformly apply marketingtracking, clean up deprecated values `(PR #2601)`

#### Telemetry/Teestore

- Do not write to store concurrently in tx `(PR #2888)`

#### Telemetrygatewayexporter

- Support export target without a port `(PR #2745)`

#### Tenant

- Disable workspaces for SOAP users `(PR #2490)`

#### Tenant/Reconciler

- Use nil-safe field getter when applying feature flags `(PR #2408)`

#### Tenant/Settings

- Fix workspace display name update `(PR #2705)`

#### Tenant/Users

- Only spin on specific action `(PR #2971)`

#### Tenants/Web

- Magic redirect to sign-out -> sign-in if Workspaces requests return Code.Unauthenticated `(PR #2421)`

#### Ui

- Update error page when GitHub account is not yet connected `(PR #3059)`
- Disable adding more MT repositories while repositories are being saved `(PR #3010)`
- Set sideEffects path in client/ui to correct `init.ts` path `(PR #2773)`

#### Workspaces

- Dynamic logout link `(PR #2854)`
- Catch panics in connectrpc handlers `(PR #2837)`
- Remove trace ID from block result `(PR #2831)`
- Include all workspaces in name availability check `(PR #2794)`
- Check for user metadata if 'sourcegraph.com' is a required email domain `(PR #2654)`
- Ignore missing subscription when pruning invitations, rename ReconcileConsumedSeats `(PR #2650)`
- Improve UX when email domain is not allowed `(PR #2618)`
- Error indicates name must be lowercase `(PR #2599)`
- Rename URL fields to URI per AIP `(PR #2595)`
- Prevent panic in billing renewer `(PR #2570)`
- Address seat count problems `(PR #2482)`

#### Workspaces/Billing

- No-op SubscriptionUpdater returns ErrNoSubscriptionUpdateRequired `(PR #2572)`

#### Workspaces/Blocklists

- Relax restrictions around generic terms `(PR #2712)`

#### Workspaces/Dev

- Do not use wrangler with concurrency `(PR #2730)`

#### Workspaces/Settings

- Remove workspace ID on collapse `(PR #2742)`

#### Others

- Respect errors from sql row iterations `(PR #2948)`
- Std upgradetest with pv set doesn't go beyond targetVersion `(PR #2928)`
  - NA
- Add missing error assignment `(PR #2864)`
- Tweak relevant repos heuristic `(PR #2655)`
- Extract runner config into env vars `(PR #2637)`
- Don't show current prompt in suggested area `(PR #2582)`
  - Fix: don't show current prompt in suggestions
- Always saturate the limit when boosting `(PR #2479)`
- Add context to intent call `(PR #2432)`

### Chore

#### Ci

- Add new search team members to teams.yml `(PR #2724)`

#### Code Intelligence

- Log connection stats on cancellation for precise queries `(PR #3003)`
- Remove duplicate IndexEnqueuer interfaces `(PR #2944)`
- Remove spurious "=" in site admin UI for editing policies `(PR #2902)`
- Syntactic policies UI restrict to HEAD `(PR #2774)`
- Introduce experimental olly package with helper functions `(PR #2753)`
- Fix flaky test in syntactic indexing store_test `(PR #2722)`
- Document quirks in various pattern syntaxes `(PR #2687)`
- Use collections.SliceMultiMap in policies API `(PR #2565)`
- Enqueue syntactic jobs in a single query `(PR #2555)`
- Remove reposcheduler.Store interface `(PR #2551)`
- Move unwrap function to check package `(PR #2540)`
- Add test for precise usagesForSymbol `(PR #2535)`
- Add doc comment about precondition `(PR #2534)`
- Add fast path for commit checking `(PR #2532)`
- Bump scip dependency `(PR #2531)`
- Fix wrong napkin math in comment `(PR #2528)`
- Avoid panic on missing committer date `(PR #2527)`
- Avoid panic on nil metadata `(PR #2526)`
- Rename & move codenav.PinnedIndexCommits -> codegraph.PinnedUploadKey `(PR #2454)`

#### Cody

- Use same buckets for completions latency metrics `(PR #2746)`
- Remove codypcw's buf.gen.yaml `(PR #2673)`
- Create proper interface for CompletionsHandler [CODY-4619] `(PR #2623)`
- Measure completions overhead by feature `(PR #2533)`
- Measure sg instance to cody gw network latency `(PR #2501)`
- Refactor completions handler latency metrics `(PR #2496)`
- Measure completions handler overhead `(PR #2478)`
- Add upstream request tracing for completions `(PR #2429)`
- Remove test domain `(PR #2400)`

#### Dev

- Cap number of connections more explicitly `(PR #3001)`
- Document purpose of onconflict linter `(PR #2882)`
- Avoid horizontal scaling for syntactic enqueuer `(PR #2813)`
- Clarify docs for redispool.Store & NewPeriodicGoroutine `(PR #2812)`
- Fix flaky ordering in test `(PR #2811)`
- Add env var to disable assertions `(PR #2810)`
- Add columns to track which policy created an auto-indexing job `(PR #2788)`
- Introduce String() method on api.CommitID `(PR #2757)`
- Replace Id -> ID in internal/codeintel `(PR #2755)`
- Fix typo in function name `(PR #2693)`
- Add helper function for printing error trees `(PR #2692)`
- Improve doc comment for REDMetrics `(PR #2635)`
- Remove unused field in REDMetrics `(PR #2634)`
- Use clearer names & comments in Rockskip `(PR #2624)`
- Rename db -> codeIntelDB in Rockskip for clarity `(PR #2606)`
- Refactor Rockskip service config to dedicated type `(PR #2605)`
- Move codeintel/core.Option to lib/core `(PR #2578)`
- Add collections.SliceMultiMap type `(PR #2564)`
- Add collections.SetMultiMap type `(PR #2556)`
- Migrate other directories from require.NoError to check.MustNoError `(PR #2554)`
- Migrate internal/ from require.NoError to check.MustNoError `(PR #2553)`
- Migrate cmd/ from require.NoError to check.MustNoError `(PR #2552)`
- Filter out archived and forked repos in reposcheduler `(PR #2550)`
  - Auto-indexing is disabled for forks and archived repositories. This is currently not configurable.
- Migrate cmd/ from require.Equal to check.MustEqual `(PR #2541)`
- Minor enhancements to check package `(PR #2530)`
- Introduce generic collections.Stack type `(PR #2511)`
- Move iterext package to lib/ `(PR #2510)`
- Move collections package to lib/ `(PR #2509)`
- Move rapidext package to lib/ `(PR #2508)`
- Introduce types for limiting reads `(PR #2470)`
- Replace ioutil -> io due to deprecation `(PR #2465)`
- Generalize bytesize package to handle more units `(PR #2464)`
- Update prettier ignore file for Svelte app `(PR #2416)`

#### Msp

- Upgrade ConnectRPC `(PR #2710)`
- Upgrade MSP cloud.google.com/go dependencies `(PR #2709)`
- Upgrade TF providers, remove nobl9 `(PR #2681)`

#### Search

- Migrate Button component to Svelte 5 `(PR #2868)`
- Upgrade to SvelteKit v2.16.0 and Svelte v5.19.0 `(PR #2867)`
- (new web ui) Run `pnpm format` `(PR #2850)`
- Vsce: patch release v2.2.20 `(PR #2748)`
- Add changelog entry for PR 2713 `(PR #2747)`
- (new web ui) Update to Svelte 5.16.2 `(PR #2590)`
- (new web app) Update svelte and kit to latest versions `(PR #2567)`

#### Security

- Auto-update all packages in Sourcegraph base images `(PR #2500)`
- Auto-update all packages in Sourcegraph base images `(PR #2360)`

#### Workspaces

- Fix url/text for user menu workspace link `(PR #2843)`
- Style fixes on Workspace Settings, General Settings and User settings `(PR #2798)`
- Refactor name-checking to helper `(PR #2726)`
- Add some improved API docstrings `(PR #2708)`
- Enable MSP rollouts `(PR #2619)`
- Rename 'loginservice' to 'xdomainloginservice' `(PR #2544)`
- Move SPA handler to 'spaservice' subpackage `(PR #2543)`
- Update workspace repo size limit `(PR #2480)`

#### Others

- Layout finetuning of Creating Workspaces and Tenant Onboarding (#3065) `(PR #3139)`
- Polish buy seats modal `(PR #2917)`
- Remove intent heuristic `(PR #2791)`
- Delete unused DeleteOrg code `(PR #2585)`
- Replace NewBuffer([]byte("str")) -> NewBufferString("str") `(PR #2466)`
- Make error message actionable for invalid date format `(PR #2401)`

### Test

#### Tenant/Reconciler

- E2E QA sanity checks on reconciler `(PR #2460)`

### Refactor

#### Dev

- Cleanup and fix new web app build process `(PR #2474)`

### Reverts

- Revert sentry, opsgenie, fix deprecation notice `(PR #-1)`
- Revert "fix/batch: use latest ubuntu LTS in hello world template (#28â€¦ `(PR #28)`
- Revert "fix: set the tag in the push_all.sh script" `(PR #2989)`

### Uncategorized

#### Others

- [Backport 6.0.x] Update Cody Web v0.29.0 `(PR #3162)`
- [backport] feat/web: Update cloning status to new designs (#2760) `(PR #3158)`
- [Backport 6.0.x] onboarding: add input field to selected repo List `(PR #3154)`
- Backport 3148 to 6.0.x `(PR #3151)`
- [Backport 6.0.x] repoupdater: Don't grow backoff bigger than int32 `(PR #3135)`
- [Backport 6.0.x] workspace settings: mention query in info message `(PR #3112)`
-  [Backport 6.0.x] fix(agents): use plural naming convention for API endpoints `(PR #3080)`
  - Renamed REST API endpoints to consistently use plural names in `/.api/review**` and `/.api/tool`. For example, `GET /.api/reviews/diagnostics/ID` instead of `GET /.api/review/diagnostic`. See OpenAPI spec for updated paths. Backport 864c824e184a7dc84df694797c5603883d72ccf1 from #3028
- BACKPORT - Revert "feat: add CTA for agents API (#2799)" `(PR #3048)`
- [Backport 6.0.x] Changes naming "Open" to "Unused" seats `(PR #3029)`
- Omnibox: route likely code generation commands to Chat `(PR #2969)`
- Update Cody Web v0.27.0 `(PR #2968)`
- Update Cody Web v0.26.0 `(PR #2966)`
- Update Cody Web v0.25.0 `(PR #2959)`
- Auth: Fixup check for canSignOut `(PR #2958)`
- Omnibox: hard boost current repo and relevant repos `(PR #2943)`
- Allowlist `language` on `cody-autoedit` `(PR #2941)`
- Tenant(web): Don't advertise upcoming code host support `(PR #2940)`
- Web: Fix page header for create workspace page `(PR #2939)`
- Web: Fix currency localization `(PR #2938)`
- Tenant: Only set feature flags required for the launch `(PR #2937)`
- Tenant: Add structured log message about missing tenant to alert on `(PR #2935)`
- Omnibox: disable intent detection when CG is unavailable `(PR #2934)`
- Update Cody Web to 0.24.0 `(PR #2920)`
  - Update Cody to 0.24.0
- Bug: Adds a link to stripe portal on the Last Payment Failed warning  `(PR #2919)`
- Sg: make `.tool-versions` parsing better and silence mise `(PR #2918)`
- Tenant: Set cody gateway rate limits `(PR #2915)`
- Adds style to pending invited users `(PR #2898)`
  - Adds style to pending invited users `(PR #2898)`
- Tenant: Add back without cancel for dormancy check `(PR #2883)`
- Tenant(repos): Expose mirrorInfo for repos for all repos to admins `(PR #2876)`
- Web: Prevent access to workspace setup and settings for non-admins `(PR #2874)`
- Accessrequest: Don't allow access requests for authenticated users `(PR #2873)`
- Auth: Don't repeat code for mocked providers `(PR #2872)`
- Auth: Code cleanup `(PR #2862)`
- Web: Fix click target for delete workspace button `(PR #2861)`
- Session: Remove sign-out cookie `(PR #2860)`
- Session: Don't invalidate every active user session on sign out `(PR #2859)`
- Tenant: Don't special case user account in onboarding `(PR #2847)`
- Tenant: Enable agentic feature flags `(PR #2830)`
- Web: Use new logo in more places `(PR #2823)`
- Workspaces: Update favicon `(PR #2819)`
- [CODY-4627] Agent Review Tables take 3 `(PR #2815)`
  - Adds implementations for `GET .api/agents/review/{review_id}`,  `GET .api/agents/review/diagnostic/{diagnostic_id}/`, and `POST .api/agents/review/diagnostic/{diagnostic_id}/feedback`
- Web: Temporarily restore logo but break Safari dark mode logo `(PR #2808)`
- Gomod: bump Zoekt for BM25 line scoring `(PR #2780)`
- Disable streaming in LLM API if not explicitly enabled `(PR #2778)`
  - `./api/llm/chat/completions` only streams response if `"stream": true` is passed in the request body
- Workspaces: Apply correct repo size limit `(PR #2772)`
- Added more clarity around workspace deletion `(PR #2769)`
- Workspaces: Add back org namespace to list of selected repos `(PR #2737)`
- Security/fix: always return absolute URLs `(PR #2727)`
- Order by NULLS LAST when sorting repositories in GQL API `(PR #2725)`
- Tenant: Set dormancy threshold to 1 week `(PR #2723)`
- Remove clustering dev script `(PR #2720)`
- Web: Port new user menu to react `(PR #2718)`
- Globalstate: Simplify store and reduce writes `(PR #2717)`
- Only `UPDATE global_state` to set initialized if not initialized `(PR #2716)`
- Globalstate: Don't update row on every call `(PR #2715)`
- Skip pre-exit hook on aspect-default queue `(PR #2694)`
- Web: More alignment of nav dropdown with designs `(PR #2691)`
- Tenant: Small improvements to MT app `(PR #2680)`
- Update Cody Web v0.22.0 `(PR #2678)`
- NLS: support quoted phrases `(PR #2677)`
- Workspaces: Consolidate web config and add web URL `(PR #2670)`
- Auth: Fixup some auth redirections `(PR #2668)`
- NLS: simplify query parsing logic `(PR #2662)`
- Cmd/cloud-ops-interview: init service `(PR #2658)`
- Gomod: bump Zoekt for 'best line match' feature `(PR #2653)`
- Auth: Don't allow CreatePassword when builtin auth is off `(PR #2644)`
- Tenant(githubapp): Expose Sourcegraph repo on resolver list `(PR #2641)`
- Change model to beta `(PR #2639)`
- Gating: Allow cloud init for workspaces instance `(PR #2638)`
- NLS: disable stemming `(PR #2620)`
- Tenant: Enable autoedits in every tenant on creation `(PR #2607)`
- NLS: always rank literal matches first `(PR #2598)`
- Repo: Allow to get totalCount for repositories as non-admin `(PR #2591)`
- Auth: Make sign out more explicit and clean up normalization `(PR #2589)`
- Auth: Clarify integration points and middlewares `(PR #2588)`
- Auth: Consolidate auth provider redirects `(PR #2587)`
- Httpapi Cleanup handler creation `(PR #2586)`
- Auth: Slightly clean up auth code `(PR #2584)`
- Conf: Use sourcegraph controlled default domain `(PR #2583)`
- Restrict auto-edits model to only pro users `(PR #2579)`
- NLS: avoid tokenizing filenames `(PR #2576)`
- NLS: simplify find symbol heuristic `(PR #2561)`
- Respect `count:` for nls search `(PR #2560)`
- Logging: Fix incorrect use of logger `(PR #2525)`
- Change the deployment id for autoedits model `(PR #2507)`
- Sg: add support to retrieve a sams idp client `(PR #2497)`
- Frontend: Reduce amount of dependencies passed around `(PR #2450)`
- Tenant: Mark tenant as seen even if request is cancelled `(PR #2441)`
- Tenant: Add intent detection FF for new hosts `(PR #2437)`
- Ci: Execute backcompat tests as PG16 `(PR #2427)`
- Tenant: Allow to add 100 repos to the GitHub App `(PR #2426)`
- Tenant: Allow to add more than 30 repos to the GitHub App `(PR #2425)`
- Bitbucketcloud: Fix repo perms syncing for inherited permissions and groups `(PR #2398)`
  - Fixed an issue with Bitbucket Cloud permission syncing where inherited permissions and group permissions were not correctly reflected.
- Dotcom, workspaces: propagate 'plg' namespace metadata as feature flags `(PR #2382)`
- Gating: Consolidate License and Subscription resolvers `(PR #2359)`
- Gating: Move repo size and count constraints into provider `(PR #2356)`
- Gating: Implement more parts of workspaces gating `(PR #2355)`
- Gating: Enable workspaces gating provider `(PR #2307)`
- Gating: Add GrantDisplayName to Provider `(PR #2306)`
- Gating: Add provider specific background routines `(PR #2305)`
- Gating: Move TelemetryExportMode and AccessTokenInstanceIdentifier into Provider `(PR #2304)`
- Gating: Reduce number of references to global gating provider `(PR #2301)`
- Gating: Remove license mocks `(PR #2300)`
- Gating: Move license expiration checks fully into CheckGrant `(PR #2299)`
- Gating: Remove unused fields from ProductLicenseInfo `(PR #2297)`
- Gating: Remove unused redundant licenseinfo resolver `(PR #2296)`
- Gating: Unexport Plan and check for all license keys `(PR #2295)`
- Gating: Add MaximumUserCount to provider interface `(PR #2294)`
- Gating: Implement TrueUp feature `(PR #2293)`
- Gating: Remove IsFreePlan `(PR #2210)`
- Redis: Clarify store requirements and improve test setup `(PR #2020)`
- Repo: Expose repository settings page as read-only to non-admins `(PR #1897)`
- Authz: Craft authz provider factory and pass around explicitly `(PR #1893)`
- Repoupdater: Remove in memory scheduler `(PR #1473)`
- Tenant: Mark all views as security_invoker `(PR #744)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Log connection stats on cancellation for precise queries `(PR #3002)`
- Cap number of connections more explicitly `(PR #2999)`
- Auto-update all packages in Sourcegraph base images (5.11.x) `(PR #2494)`
- [Backport 5.11.x] bitbucketcloud: Fix repo perms syncing for inherited permissions and groups `(PR #2399)`
  - Fixed an issue with Bitbucket Cloud permission syncing where inherited permissions and group permissions were not correctly reflected.

{/* RSS={"version":"v6.0.0", "releasedAt": "2025-01-29"} */}


# 5.11 Patch 5

> Attention -  If upgrading from Sourcegraph version 5.9 or earlier, this release will update our included database container images from Postgres 12 to Postgres 16.
> Customers are advised to have a database backup before upgrading. See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice for more information.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.11.6271

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.11.6271)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.11.6271)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.11.6271)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.11.6271)

### Chore

#### Code Intelligence

- Log connection stats on cancellation for precise queries `(PR #3002)`

#### Dev

- Cap number of connections more explicitly `(PR #2999)`

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v5.11.6271", "releasedAt": "2025-01-23"} */}


# 5.11 Patch 4

> Attention -  If upgrading from Sourcegraph version 5.9 or earlier, this release will update our included database container images from Postgres 12 to Postgres 16.
> Customers are advised to have a database backup before upgrading. See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice for more information.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.11.5234

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.11.5234)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.11.5234)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.11.5234)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.11.5234)

### Features

#### Perforce

- Use depot name for label cache `(PR #2805)`

### Fix

#### Source

- Possible Perforce changelists are now converted to their respective git commit during ResolveRevision `(PR #2825)`

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Manual Backport]: update shellcheck to 0.10.0 `(PR #2838)`
  - NA

{/* RSS={"version":"v5.11.5234", "releasedAt": "2025-01-17"} */}


# 5.11 Patch 3

> Attention -  If upgrading from Sourcegraph version 5.9 or earlier, this release will update our included database container images from Postgres 12 to Postgres 16.
> Customers are advised to have a database backup before upgrading. See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice for more information.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.11.4013

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.11.4013)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.11.4013)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.11.4013)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.11.4013)

### Features

#### Security

- Sign release images `(PR #2703)`
  - Publish signatures for release containers.  Backport c11764be4adb377521e4067c4852953d7c434e24 from #2697

#### Others

- Allow single container server to run postgresql-16 `(PR #2714)`
  - Server: runs postgresql from /var/run/postgresql instead of /run/postgresql
 Backport 36c78cdf596e1b22079512931fa526346c2ec821 from #2711

### Fix

#### Release

- Recover from unclean database shutdowns in pgsql entrypoint `(PR #2706)`
  - Fix(rel): fix issue with Postgres docker container failing upgrades after an unclean database shutdown.
  Backport ca5185ce2528b67e1ce6bcb5170f96d3699e11e0 from #2660

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 5.11.x] fix(Bitbucket Cloud): Fix pagination logic for bitbucket cloud permissions `(PR #2700)`
  - Fixed an issue where Bitbucket Cloud permission syncs could produce incomplete results, resulting in lacking permissions.  Backport 389661481f0f0a2385ef4f78f4113ab6ba14f4d5 from #2699

{/* RSS={"version":"v5.11.4013", "releasedAt": "2025-01-11"} */}


# 5.11 Patch 2

> Attention -  If upgrading from Sourcegraph version 5.9 or earlier, this release will update our included database container images from Postgres 12 to Postgres 16.
> Customers are advised to have a database backup before upgrading. See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice for more information.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.11.3601

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.11.3601)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.11.3601)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.11.3601)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.11.3601)

### Features

#### Code Intelligence

- Make syntactic indexing write partial index to disk already GZIP compressed `(PR #2646)`

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v5.11.3601", "releasedAt": "2025-01-08"} */}


# 5.11 Patch 1

> Attention -  If upgrading from Sourcegraph version 5.9 or earlier, this release will update our included database container images from Postgres 12 to Postgres 16.
> Customers are advised to have a database backup before upgrading. See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice for more information.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.11.2732

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.11.2732)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.11.2732)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.11.2732)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.11.2732)

### Fix

#### Search

- Propagate disk space to NewFirecrackerWorkspace `(PR #2574)`
  - Addresses errors similar to: `failed to prepare workspace: failed to create ext4 filesystem in backing file: &quot;mke2fs 1.45.5 (07-Jan-2020)\nThe file losetup: /var/lib/firecracker/loop-devices/workspace-loop-47749-3763347387: Warning: file is smaller than 512 bytes; the loop device may be useless or invisible for system tools.\n/dev/loop13 does not exist and no size was specified.\n&quot;: exit status 1`
  - Affects reading and using the environment variable `EXECUTOR_FIRECRACKER_DISK_SPACE`  Backport 22db2a97a0393cdd233a92da7ade96cd59bb99ef from #2562

### Chore

#### Security

- Auto-update all packages in Sourcegraph base images (5.11.x) `(PR #2494)`

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v5.11.2732", "releasedAt": "2025-01-03"} */}


# 5.11 Patch 0

> Attention -  If upgrading from Sourcegraph version 5.9 or earlier, this release will update our included database container images from Postgres 12 to Postgres 16.
> Customers are advised to have a database backup before upgrading. See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice for more information.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.11.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.11.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.11.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.11.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.11.0)

### Features

#### Ci

- Add bazel mod tidy to ci steps [#1661](https://github.com/sourcegraph/sourcegraph/pull/1661)

#### Cloud

- Add tag field to mt config [#2035](https://github.com/sourcegraph/sourcegraph/pull/2035)

#### Code Intelligence

- Pass limits to scip-syntax and collect summary from it [#2058](https://github.com/sourcegraph/sourcegraph/pull/2058)
- Configurable time and size limits for scip-syntax [#1947](https://github.com/sourcegraph/sourcegraph/pull/1947)
  - Adds configurable limits for file size and parsing time for syntactic indexing

#### Cody

- Update cody web to 0.20.0 [#2396](https://github.com/sourcegraph/sourcegraph/pull/2396)
- Update cody-web to 0.18.0 [#2365](https://github.com/sourcegraph/sourcegraph/pull/2365)
- Add autoedits models to models.json [#1873](https://github.com/sourcegraph/sourcegraph/pull/1873)
- Add `UserShouldUseEnterprise` to `/.api/client-config` (PRIME-596) [#1872](https://github.com/sourcegraph/sourcegraph/pull/1872)

#### Cody-Gateway

- Add Gemini 2.0 Flash experimental model [#2309](https://github.com/sourcegraph/sourcegraph/pull/2309)

#### Codygateway

- Expand flagging to workspaces actors [#2290](https://github.com/sourcegraph/sourcegraph/pull/2290)
- Off-by-default workspaces actor source [#1941](https://github.com/sourcegraph/sourcegraph/pull/1941)

#### Database

- Support drift detection of policies [#2000](https://github.com/sourcegraph/sourcegraph/pull/2000)
  - Drift detection now detects missing table policies.
- Include policies in schema md and json [#1999](https://github.com/sourcegraph/sourcegraph/pull/1999)
  - Schema.md and schema.json now include table policies.

#### Dev

- Adding wait option to sg access command [#1930](https://github.com/sourcegraph/sourcegraph/pull/1930)

#### Gateway

- Add v2 endpoint stubs [#1526](https://github.com/sourcegraph/sourcegraph/pull/1526)

#### Gating

- Extract license validity checks to gating.Provider.CheckGrant [#2018](https://github.com/sourcegraph/sourcegraph/pull/2018)
- Replace licensing.Check with gating.GetGlobalProvider().Check [#2009](https://github.com/sourcegraph/sourcegraph/pull/2009)
- Allow gating.Provider to be global [#2008](https://github.com/sourcegraph/sourcegraph/pull/2008)
- Extract into standalone package, stub out CodyGatewayAuthenticator [#2007](https://github.com/sourcegraph/sourcegraph/pull/2007)

#### Graphql

- Multitenant: add repository restriction validation when adding repos [#2017](https://github.com/sourcegraph/sourcegraph/pull/2017)

#### Local

- Use mac/linux keystores to store secrets instead of plain text file on disk [#2001](https://github.com/sourcegraph/sourcegraph/pull/2001)
- Store entitle token in sg secrets [#1856](https://github.com/sourcegraph/sourcegraph/pull/1856)

#### Memcache

- Add tenancy-friendly LRU memory cache [#1934](https://github.com/sourcegraph/sourcegraph/pull/1934)

#### Msp

- Introduce simple telemetry recorder for managed services [#2146](https://github.com/sourcegraph/sourcegraph/pull/2146)

#### Multi-Tenant

- Add "add repositories" setup flow step [#2112](https://github.com/sourcegraph/sourcegraph/pull/2112)
- Add first UI implementation of GitHub connect setup page [#1966](https://github.com/sourcegraph/sourcegraph/pull/1966)

#### Multi-Tenant/Workspaces

- Add support to query ws by name in integrations svc [#2321](https://github.com/sourcegraph/sourcegraph/pull/2321)

#### Multitenant

- Set maximum repos size to 500mb [#2027](https://github.com/sourcegraph/sourcegraph/pull/2027)

#### Rbac

- Add separate permission for viewing exported telemetry [#1989](https://github.com/sourcegraph/sourcegraph/pull/1989)

#### Release

- Run `sg cut` in buildkite to automate nightly pipeline test [#2116](https://github.com/sourcegraph/sourcegraph/pull/2116)
  - Release: nightly release pipeline is working
- Backcompat test use release registry [#1202](https://github.com/sourcegraph/sourcegraph/pull/1202)

#### Search

- Correctly lower repo name regexes [#2209](https://github.com/sourcegraph/sourcegraph/pull/2209)
  - Special uppercase regex tokens are no longer inverted for repository name search. eg `repo:foo\B` correctly interprets `\B` as `not at ASCII word boundary`. Previously it would transform the expression into `repo:foo\b`.
- Use pattern optimizations for repo ExcludePattern [#2186](https://github.com/sourcegraph/sourcegraph/pull/2186)
  - Searches which exclude repositories are faster on larger instances. We now use the same performance optimizations as repo inclusion.

#### Security

- Add access token ID to audit events [#2034](https://github.com/sourcegraph/sourcegraph/pull/2034)

#### Sg

- Add 'sg user metadata' commands [#2261](https://github.com/sourcegraph/sourcegraph/pull/2261)

#### Source

- MT GitHub App  connections now use generic App connection [#2338](https://github.com/sourcegraph/sourcegraph/pull/2338)
- Add App-level GitHub App code host connections [#2127](https://github.com/sourcegraph/sourcegraph/pull/2127)
  - Sourcegraph now supports App-level GitHub App connections that aren't tied to a specific Installation ID.
- Add maxDeletions option to code host connections [#2003](https://github.com/sourcegraph/sourcegraph/pull/2003)

#### Telemetry

- Include SAMS user ID if monolithsams is configured [#1936](https://github.com/sourcegraph/sourcegraph/pull/1936)
- Propagate x-requested-with headers to request clientâ€¦ [#1775](https://github.com/sourcegraph/sourcegraph/pull/1775)

#### Workspaces

- Add metric to count number of unseen instances [#2303](https://github.com/sourcegraph/sourcegraph/pull/2303)
- Report instances and workspaces status [#2262](https://github.com/sourcegraph/sourcegraph/pull/2262)
- Add features to workspace results [#2171](https://github.com/sourcegraph/sourcegraph/pull/2171)

#### Others

- Extend prompt tags with pagination and increased limit [#2344](https://github.com/sourcegraph/sourcegraph/pull/2344)
  - Feat: extend prompt tags with pagination and increased limit
- Editing tags on prompts [#2278](https://github.com/sourcegraph/sourcegraph/pull/2278)
  - Feat: editing tags on prompts
- (multi-tenant): add invite users and final setup step [#2211](https://github.com/sourcegraph/sourcegraph/pull/2211)
- Management page prompt categories [#2178](https://github.com/sourcegraph/sourcegraph/pull/2178)
  - Feat: management page prompt categories
- Prompt categories nav for web [#2177](https://github.com/sourcegraph/sourcegraph/pull/2177)
  - Feat: add tags as filter to prompts and their navigation
- Add prompt labels to the GraphQL API [#2131](https://github.com/sourcegraph/sourcegraph/pull/2131)
  - Feat: add prompt labels to the GraphQL API
- Call new intent detection model via Gateway [#2113](https://github.com/sourcegraph/sourcegraph/pull/2113)
- Add CommitsIter to `GitserverClient` [#2080](https://github.com/sourcegraph/sourcegraph/pull/2080)
- New intent detection API on Gateway [#2016](https://github.com/sourcegraph/sourcegraph/pull/2016)
- More telemetry for batch changes [#2014](https://github.com/sourcegraph/sourcegraph/pull/2014)
  - Feat(batches): more telemetry events
- Add support to `patterntype:nls` for `type:code` and `type:text` [#1961](https://github.com/sourcegraph/sourcegraph/pull/1961)
- Add OR support for text search pattern types [#1915](https://github.com/sourcegraph/sourcegraph/pull/1915)
- Collect contributor data [#1765](https://github.com/sourcegraph/sourcegraph/pull/1765)
  - Feat: calculate contributor stats

### Fix

#### Code Intelligence

- Reports symbols for TypeScript type aliases [#2339](https://github.com/sourcegraph/sourcegraph/pull/2339)
  - Properly report symbols for TypeScript type aliases

#### Cody

- Update cody web to 0.19.0 [#2376](https://github.com/sourcegraph/sourcegraph/pull/2376)
- Add cody.notices to json schema [#2373](https://github.com/sourcegraph/sourcegraph/pull/2373)
- Fix prompt library UI layouts [#2288](https://github.com/sourcegraph/sourcegraph/pull/2288)
- Fix prompt avatar for generated initials avatar [#2239](https://github.com/sourcegraph/sourcegraph/pull/2239)
- Switch to Snowball stopwords [#2223](https://github.com/sourcegraph/sourcegraph/pull/2223)
  - Narrowed down the stopwords list used in Cody context, to fix an issue where we could miss highly relevant files.
- Disable reranking for airgapped instances [#2168](https://github.com/sourcegraph/sourcegraph/pull/2168)
  - Fixes a bug in Cody context where airgapped instances would attempt to use the reranker model, which increased the context retrieval latency.
- Fix prompt creation telemetry [#2057](https://github.com/sourcegraph/sourcegraph/pull/2057)

#### Codyauditlog

- Inline audit log entry for consistency [#2072](https://github.com/sourcegraph/sourcegraph/pull/2072)

#### Codygateway

- Configurable workspace user ban state cache, lower default [#2357](https://github.com/sourcegraph/sourcegraph/pull/2357)
- Fix listing flagged prompts from workspaces users [#2354](https://github.com/sourcegraph/sourcegraph/pull/2354)

#### Dev

- Fix window context extraction logic for multitenant [#1998](https://github.com/sourcegraph/sourcegraph/pull/1998)

#### Dev/Codygateway

- Partially fix Cody Gateway QA suite [#2005](https://github.com/sourcegraph/sourcegraph/pull/2005)

#### Dev/Msp

- Remove actual interval from error message to fix flakey months [#2031](https://github.com/sourcegraph/sourcegraph/pull/2031)

#### Gateway

- Benchmark: various fixes [#2119](https://github.com/sourcegraph/sourcegraph/pull/2119)

#### Msp

- Fix error message for image tag resolution [#2283](https://github.com/sourcegraph/sourcegraph/pull/2283)

#### Msp/Operationdocs

- Update Entitle request links [#2281](https://github.com/sourcegraph/sourcegraph/pull/2281)

#### Mulitenant

- Add rote tests for repositoryChecker implementations [#2258](https://github.com/sourcegraph/sourcegraph/pull/2258)
  - N/A
- Add rote test for workspaceGitHubAppAccountResolver [#2257](https://github.com/sourcegraph/sourcegraph/pull/2257)
  - N/A
- Add test suite for (s *serviceImpl) listRepositoriesSearch [#2255](https://github.com/sourcegraph/sourcegraph/pull/2255)
- Add test suite for (r *workspaceGitHubAppResolver) ListUserGitHubRepositories [#2199](https://github.com/sourcegraph/sourcegraph/pull/2199)

#### Multitenant

- Enable workspace specific routes only for workspace instance [#2287](https://github.com/sourcegraph/sourcegraph/pull/2287)
- Add rote tests for workspaceGitHubAppRepositoryResolver [#2259](https://github.com/sourcegraph/sourcegraph/pull/2259)
  - N/A
- Add test suite for (r *workspaceGitHubAppResolver) ListPublicGitHubRepositories [#2198](https://github.com/sourcegraph/sourcegraph/pull/2198)
  - N/A
- Graphql: add installation repos test suite [#2174](https://github.com/sourcegraph/sourcegraph/pull/2174)

#### Release

- Fix regressions from 5.10 release process [#2405](https://github.com/sourcegraph/sourcegraph/pull/2405)
  - Refactor and fix bugs in release test&lt;details&gt;

#### Sams

- Fix notification handlers [#1990](https://github.com/sourcegraph/sourcegraph/pull/1990)

#### Search

- Fix small svelte UI paper cuts [#2317](https://github.com/sourcegraph/sourcegraph/pull/2317)
- Executors: set the user/group on the job spec only if configured. [#2203](https://github.com/sourcegraph/sourcegraph/pull/2203)
  - Also validates `KUBERNETES_RUN_AS_USER` and `KUBERNETES_RUN_AS_GROUP`.
  - Must be integers in the range [0, 2147483647].
- Fix fuzzy finder layout in Safari 18.1 [#2061](https://github.com/sourcegraph/sourcegraph/pull/2061)

#### Source

- Use GitHub GraphQL client to do repo searches [#2340](https://github.com/sourcegraph/sourcegraph/pull/2340)
- Decode installationRepos' args.After correctly [#2126](https://github.com/sourcegraph/sourcegraph/pull/2126)
- Fix layout on repo admin search box [#1960](https://github.com/sourcegraph/sourcegraph/pull/1960)

#### Telemetry

- Include anonymous user ID in externalAuthSignup events [#2074](https://github.com/sourcegraph/sourcegraph/pull/2074)

#### Telemetrygateway

- Update generated bindings [#1939](https://github.com/sourcegraph/sourcegraph/pull/1939)

#### Worker/Sams

- Fix userRolesStrings [#1992](https://github.com/sourcegraph/sourcegraph/pull/1992)

#### Workspaces

- Handle missing class name in instances [#2286](https://github.com/sourcegraph/sourcegraph/pull/2286)
- Create: improve cancellation handling [#2167](https://github.com/sourcegraph/sourcegraph/pull/2167)
- CodeUnauthenticated for missing session ID, dont include trace ID in log message [#2032](https://github.com/sourcegraph/sourcegraph/pull/2032)

#### Workspaces/Integrations

- Do not list billing subscriptions if no workspaces [#2233](https://github.com/sourcegraph/sourcegraph/pull/2233)

#### Others

- Set high match limit for NLS [#2352](https://github.com/sourcegraph/sourcegraph/pull/2352)
- Remove surplus typename [#2265](https://github.com/sourcegraph/sourcegraph/pull/2265)
  - Fix: remove surplus typename
- Use byte columns for contributors to support non-utf8 characters [#2122](https://github.com/sourcegraph/sourcegraph/pull/2122)
- Skip revision if not found instead of throwing error [#2121](https://github.com/sourcegraph/sourcegraph/pull/2121)
- Slow down contributor jobs [#2120](https://github.com/sourcegraph/sourcegraph/pull/2120)
- Add internal actor to contributor job [#2101](https://github.com/sourcegraph/sourcegraph/pull/2101)
- Correctly handle overlapping paths in Perforce protection rules [#1745](https://github.com/sourcegraph/sourcegraph/pull/1745)

### Chore

#### Ci

- Enable svelte-check in CI for multi-tenant [#2242](https://github.com/sourcegraph/sourcegraph/pull/2242)
- Skip license-check workflow on draft prs [#2087](https://github.com/sourcegraph/sourcegraph/pull/2087)
- Add -x flag to the script [#2029](https://github.com/sourcegraph/sourcegraph/pull/2029)
- Bazel - Pull static psql as tool dep [#1970](https://github.com/sourcegraph/sourcegraph/pull/1970)
- Pg-utils - Upload static psql [#1969](https://github.com/sourcegraph/sourcegraph/pull/1969)

#### Cloud

- Switch ephemerals to dev enterprise portal [#2090](https://github.com/sourcegraph/sourcegraph/pull/2090)

#### Code Intelligence

- Remove EMPTY_STATS_JSON object [#2363](https://github.com/sourcegraph/sourcegraph/pull/2363)
- Fix incorrect error handling [#2316](https://github.com/sourcegraph/sourcegraph/pull/2316)
- Move cursor last for consistency [#2311](https://github.com/sourcegraph/sourcegraph/pull/2311)
- Refactor uploadhandler logic for clarity [#2086](https://github.com/sourcegraph/sourcegraph/pull/2086)
- Update scip version and use faster parsing API [#2085](https://github.com/sourcegraph/sourcegraph/pull/2085)
- Simplify code to avoid single-implementation interfaces [#2046](https://github.com/sourcegraph/sourcegraph/pull/2046)
- Fix incorrect test inputs [#2043](https://github.com/sourcegraph/sourcegraph/pull/2043)
- Simplify SyntacticIndexingJobStore [#2042](https://github.com/sourcegraph/sourcegraph/pull/2042)
- Remove RepositorySchedulingService [#2041](https://github.com/sourcegraph/sourcegraph/pull/2041)
- Remove IndexEnqueuer interface with a single implementation [#2040](https://github.com/sourcegraph/sourcegraph/pull/2040)

#### Cody

- Add QA's test domain to the enterprise domain list [#2392](https://github.com/sourcegraph/sourcegraph/pull/2392)
- Monitor completions latency by feature [#2345](https://github.com/sourcegraph/sourcegraph/pull/2345)
- Remove retired claude models [#2047](https://github.com/sourcegraph/sourcegraph/pull/2047)
- Fix typos and minor warnings around Cody Gateway [#2025](https://github.com/sourcegraph/sourcegraph/pull/2025)
- Migrate code completion model resolution to use models.json [#1980](https://github.com/sourcegraph/sourcegraph/pull/1980)
- Make LegacyModelRedirects public [#1951](https://github.com/sourcegraph/sourcegraph/pull/1951)

#### Cody-Gateway

- Log model capability mismatch [#2181](https://github.com/sourcegraph/sourcegraph/pull/2181)

#### Dev

- Replace cmp.Diff -> check.(Must)?NoDiff (part 3) [#2154](https://github.com/sourcegraph/sourcegraph/pull/2154)
- Replace cmp.Diff -> check.(Must)?NoDiff (part 2) [#2151](https://github.com/sourcegraph/sourcegraph/pull/2151)
- Replace cmp.Diff -> check.(Must)?NoDiff (part 1) [#2150](https://github.com/sourcegraph/sourcegraph/pull/2150)
- Introduce more type safe testing package [#2049](https://github.com/sourcegraph/sourcegraph/pull/2049)

#### Dotcom

- UI copy, list by instance domain, correctly return invalid argument on update [#1916](https://github.com/sourcegraph/sourcegraph/pull/1916)

#### Gateway

- Fix logged model name format in "not allowed" errors [#2056](https://github.com/sourcegraph/sourcegraph/pull/2056)
- Don't ignore API version when comparing modelRefs for RateLimit filtering [#2024](https://github.com/sourcegraph/sourcegraph/pull/2024)
- Use `models.json` in Cody Gateway (PRIME-600, PRIME-612) [#1759](https://github.com/sourcegraph/sourcegraph/pull/1759)

#### Graphqlbackend

- Remove deprecated monitoring queries [#2075](https://github.com/sourcegraph/sourcegraph/pull/2075)

#### Local

- Pg_version_check - Force db to be postgres [#1979](https://github.com/sourcegraph/sourcegraph/pull/1979)

#### Monolithsams

- Migrate to official SAMS SDK [#1987](https://github.com/sourcegraph/sourcegraph/pull/1987)

#### Plg

- Add Cody Pro upgrade script [#1903](https://github.com/sourcegraph/sourcegraph/pull/1903)

#### Sams

- Enable SDK caching for authentication middleware clients [#1988](https://github.com/sourcegraph/sourcegraph/pull/1988)

#### Search

- Upgrade prettier for web-sveltekit [#2221](https://github.com/sourcegraph/sourcegraph/pull/2221)
- Add private metadata for language on code nav events [#2190](https://github.com/sourcegraph/sourcegraph/pull/2190)
- (new web ui) Upgrade to Svelte 5 [#2183](https://github.com/sourcegraph/sourcegraph/pull/2183)
- Update client side code intel telemetry to include provenance and tab [#2142](https://github.com/sourcegraph/sourcegraph/pull/2142)

#### Security

- Pin otel-collector package version [#2452](https://github.com/sourcegraph/sourcegraph/pull/2452)
- Update src-cli to version 5.11.1 [#2447](https://github.com/sourcegraph/sourcegraph/pull/2447)
  - Update src-cli version to 5.11.1  Backport 2721fd9106eb033afe4cca96164f7ecc5e0b6f88 from #2444
- Update src-cli to version 5.11.0 [#2366](https://github.com/sourcegraph/sourcegraph/pull/2366)
  - Update src-cli version to 5.11.0
- Auto-update package lockfiles for Sourcegraph base images [#2302](https://github.com/sourcegraph/sourcegraph/pull/2302)

#### Source

- Use sghttp CloneURL to make a copy of a URL [#2315](https://github.com/sourcegraph/sourcegraph/pull/2315)
- Simplify oauth middleware [#1946](https://github.com/sourcegraph/sourcegraph/pull/1946)

#### Telemetry

- Remove example values, deprecate SafeAction [#2107](https://github.com/sourcegraph/sourcegraph/pull/2107)

#### Workspace

- Update picker with small changes for current link [#2227](https://github.com/sourcegraph/sourcegraph/pull/2227)

#### Workspaces

- Add seats metadata by listing subscriptions in bulk [#2189](https://github.com/sourcegraph/sourcegraph/pull/2189)
- Make openfga cancelled errors easier to detect [#2117](https://github.com/sourcegraph/sourcegraph/pull/2117)
- ListWorkspaces: concurrently fetch membership [#2104](https://github.com/sourcegraph/sourcegraph/pull/2104)
- Set workspace ID on create span [#2084](https://github.com/sourcegraph/sourcegraph/pull/2084)
- UX Updates for Workspaces service [#2078](https://github.com/sourcegraph/sourcegraph/pull/2078)
- Mark emails as transactional [#1984](https://github.com/sourcegraph/sourcegraph/pull/1984)
- Add tracing on Cloudflare KV ops, improve retry policies [#1957](https://github.com/sourcegraph/sourcegraph/pull/1957)

#### Workspaces/Billing

- Add rehttp on stripe 429 [#2079](https://github.com/sourcegraph/sourcegraph/pull/2079)
- Add traced HTTP client to Stripe SDK [#1962](https://github.com/sourcegraph/sourcegraph/pull/1962)

#### Others

- Update Calendar Release Notifications [#2230](https://github.com/sourcegraph/sourcegraph/pull/2230)
  - N/A
- Add CODENOTIFY files for Cody Prime team [#2185](https://github.com/sourcegraph/sourcegraph/pull/2185)
- Avoid materializing set values just for iteration [#2045](https://github.com/sourcegraph/sourcegraph/pull/2045)
- Enable exhaustruct on syntactic_indexing folder [#2044](https://github.com/sourcegraph/sourcegraph/pull/2044)
- Cleanup stale branches [#1977](https://github.com/sourcegraph/sourcegraph/pull/1977)
- Remove unreferenced scripts [#1942](https://github.com/sourcegraph/sourcegraph/pull/1942)
- Update repo not found for dotcom [#1940](https://github.com/sourcegraph/sourcegraph/pull/1940)
- Cleanup some local dev things [#1906](https://github.com/sourcegraph/sourcegraph/pull/1906)
- Address Gazelle deprecation warnings [#1789](https://github.com/sourcegraph/sourcegraph/pull/1789)
- Use enum for executor runtime instead of boolean flags [#1788](https://github.com/sourcegraph/sourcegraph/pull/1788)
- Rename executor Config fields & simplify code [#1787](https://github.com/sourcegraph/sourcegraph/pull/1787)
- Use collections.Set for marking allowed RepoID values. [#1743](https://github.com/sourcegraph/sourcegraph/pull/1743)
- Move license check types to handler [#1697](https://github.com/sourcegraph/sourcegraph/pull/1697)

### Refactor

#### Ci

- Add DefaultQueue for the default queue to use [#2096](https://github.com/sourcegraph/sourcegraph/pull/2096)

### Reverts

- Revert "feat(cody-gateway): add Gemini 2.0 Flash experimental model  [#-1](https://github.com/sourcegraph/sourcegraph/pull/2326)
- Revert "completions: Use authenticator interface for access token" [#1694](https://github.com/sourcegraph/sourcegraph/pull/2169)
- Revert "chore(ci): temporary exclude diff tests (#1923)" [#1923](https://github.com/sourcegraph/sourcegraph/pull/1926)

### Uncategorized

#### Others

- [Backport 5.11.x] bitbucketcloud: Fix repo perms syncing for inherited permissions and groups [#2399](https://github.com/sourcegraph/sourcegraph/pull/2399)
  - Fixed an issue with Bitbucket Cloud permission syncing where inherited permissions and group permissions were not correctly reflected.
- Worker: Disable routines for codeintel inside routines logic [#2386](https://github.com/sourcegraph/sourcegraph/pull/2386)
- Tenant: Prevent in-app deadlock while initializing globalstate [#2383](https://github.com/sourcegraph/sourcegraph/pull/2383)
- Tenant: Mark tenant as last seen async [#2381](https://github.com/sourcegraph/sourcegraph/pull/2381)
- Nls: add ability to boost results from a repo [#2375](https://github.com/sourcegraph/sourcegraph/pull/2375)
- Intent detection: add heuristics  [#2364](https://github.com/sourcegraph/sourcegraph/pull/2364)
- Autoedits: remove rewrite speculation field for the chat endpoint [#2361](https://github.com/sourcegraph/sourcegraph/pull/2361)
- Hitesh/change direct route method [#2351](https://github.com/sourcegraph/sourcegraph/pull/2351)
- Change deepseek model for autoedits [#2350](https://github.com/sourcegraph/sourcegraph/pull/2350)
- Reapply "feat(cody-gateway): add Gemini 2.0 Flash experimental model" [#2348](https://github.com/sourcegraph/sourcegraph/pull/2348)
- Auth: Simplify middlewares [#2336](https://github.com/sourcegraph/sourcegraph/pull/2336)
- Http: Refactor HTTP_TRACE to use Sourcegraph logger [#2335](https://github.com/sourcegraph/sourcegraph/pull/2335)
- Http: Drop Blackhole middleware [#2334](https://github.com/sourcegraph/sourcegraph/pull/2334)
- Editor: Add missing Gerrit remoteURL resolution [#2332](https://github.com/sourcegraph/sourcegraph/pull/2332)
- Gitserver: Fix input parsing issue in diff searches [#2331](https://github.com/sourcegraph/sourcegraph/pull/2331)
- Tenant: Mention repos that were not found [#2328](https://github.com/sourcegraph/sourcegraph/pull/2328)
- Tenant: Use SiteID for workspace management API interaction [#2327](https://github.com/sourcegraph/sourcegraph/pull/2327)
- NLS: use reranker in batch search too [#2325](https://github.com/sourcegraph/sourcegraph/pull/2325)
- NLS: only rerank keyword matches [#2324](https://github.com/sourcegraph/sourcegraph/pull/2324)
- NLS: fix bug where we could skip reranking [#2320](https://github.com/sourcegraph/sourcegraph/pull/2320)
- Bugfix: anchor include patterns for symbol tree [#2319](https://github.com/sourcegraph/sourcegraph/pull/2319)
  - Fixed a web app bug that could cause symbols to be shown in the symbol tree for files that share a name with the viewed file
- NLS: initial reranker integration [#2298](https://github.com/sourcegraph/sourcegraph/pull/2298)
- Redis: remove unused rcache methods [#2292](https://github.com/sourcegraph/sourcegraph/pull/2292)
- Chore(workspaces) Ensure an api error populating list of workspaces doâ€¦ [#2291](https://github.com/sourcegraph/sourcegraph/pull/2291)
- Gomod: bump Zoekt for BM25 improvement [#2282](https://github.com/sourcegraph/sourcegraph/pull/2282)
- Tenant: Indicate to webapp that workspaces UIs should be shown [#2279](https://github.com/sourcegraph/sourcegraph/pull/2279)
- Repoupdater: Fix panic when traversing public repos [#2273](https://github.com/sourcegraph/sourcegraph/pull/2273)
- Dev/workspaces: get local o11y working again [#2263](https://github.com/sourcegraph/sourcegraph/pull/2263)
- Tenant: Use workspace ID as site id [#2256](https://github.com/sourcegraph/sourcegraph/pull/2256)
- Tenant: Fix missing tenant context in conf validation [#2247](https://github.com/sourcegraph/sourcegraph/pull/2247)
- Ranking: revert changes to concurrency limits [#2236](https://github.com/sourcegraph/sourcegraph/pull/2236)
- NLS: initial support for type:path [#2234](https://github.com/sourcegraph/sourcegraph/pull/2234)
- Enable predicted outputs for S2 instance for fireworks models [#2226](https://github.com/sourcegraph/sourcegraph/pull/2226)
- Dev(search): (new web ui) Upgrade svelte-check [#2220](https://github.com/sourcegraph/sourcegraph/pull/2220)
- Add deepseek completions model for autoedits [#2219](https://github.com/sourcegraph/sourcegraph/pull/2219)
- Workspaces/billing: implement payment charge for purchase extra seats [#2217](https://github.com/sourcegraph/sourcegraph/pull/2217)
- Reranker: make sure to record telemetry [#2188](https://github.com/sourcegraph/sourcegraph/pull/2188)
- Tenant/worker: Add tenant to context for worker in ST mode [#2184](https://github.com/sourcegraph/sourcegraph/pull/2184)
- Tenant: Implement dynamic limits for GitHub App [#2172](https://github.com/sourcegraph/sourcegraph/pull/2172)
- Repo: Drop next_sync_at prioritization [#2160](https://github.com/sourcegraph/sourcegraph/pull/2160)
- Gateway: benchmark: fix http-then-websocket initial request failures [#2159](https://github.com/sourcegraph/sourcegraph/pull/2159)
- Repoupdater: Fix interval out of range [#2155](https://github.com/sourcegraph/sourcegraph/pull/2155)
- Pings: Remove hubspot integration [#2144](https://github.com/sourcegraph/sourcegraph/pull/2144)
- Workspace-reconciler: update tenant name and display name [#2141](https://github.com/sourcegraph/sourcegraph/pull/2141)
- Repoupdater: Make backoff after failure to fetch/clone more exponential [#2140](https://github.com/sourcegraph/sourcegraph/pull/2140)
- Gitserver: Record LastError, LastOutput when hitting a timeout [#2139](https://github.com/sourcegraph/sourcegraph/pull/2139)
- Gitserver: Simpify repo state syncer [#2138](https://github.com/sourcegraph/sourcegraph/pull/2138)
- Tenant: Add context to OIDC verifier [#2137](https://github.com/sourcegraph/sourcegraph/pull/2137)
- Tenant: Fix missing tenant in oauth requests [#2136](https://github.com/sourcegraph/sourcegraph/pull/2136)
- Tenant: Expose configured limits in GQL API [#2123](https://github.com/sourcegraph/sourcegraph/pull/2123)
- Add colorful icons for gitlab and bitbucket [#2114](https://github.com/sourcegraph/sourcegraph/pull/2114)
- Chore(workspaces) Remove an extra quote [#2111](https://github.com/sourcegraph/sourcegraph/pull/2111)
- Tenant: Temporarily bump limit to 10GB again [#2110](https://github.com/sourcegraph/sourcegraph/pull/2110)
- Tenant: Fix multitenant repo selection update [#2109](https://github.com/sourcegraph/sourcegraph/pull/2109)
- NLS: boost literal matches [#2108](https://github.com/sourcegraph/sourcegraph/pull/2108)
- Bug(multitenant): Fix GraphQL resolvers for repo search [#2098](https://github.com/sourcegraph/sourcegraph/pull/2098)
- Batches: Fix trigger function with tenancy [#2092](https://github.com/sourcegraph/sourcegraph/pull/2092)
- Deprecate unused pings, reducing load on local PG instances [#2082](https://github.com/sourcegraph/sourcegraph/pull/2082)
- NLS: perform single search for code and text results [#2081](https://github.com/sourcegraph/sourcegraph/pull/2081)
- Fix cookie name [#2077](https://github.com/sourcegraph/sourcegraph/pull/2077)
- NLS: created dedicated search job [#2076](https://github.com/sourcegraph/sourcegraph/pull/2076)
- Appliance: Remove from UserNav [#2069](https://github.com/sourcegraph/sourcegraph/pull/2069)
- Repo: Fix race condition in code host syncer [#2060](https://github.com/sourcegraph/sourcegraph/pull/2060)
- Authz: Adjust default settings for perms syncing [#2052](https://github.com/sourcegraph/sourcegraph/pull/2052)
  - The default values for repo permission syncing have been adjusted. If you specified overrides, this means no change on your instance.Adjusted defaults:`permissions.syncScheduleInterval` is now 60s instead of 15s, in favor of scheduling more jobs at once (see below).`permissions.syncOldestUsers` and `permissions.syncOldestRepos` have been adjusted to `100` from `10` to schedule pending permission sync jobs faster.`permissions.syncJobCleanupInterval` has been bumped from every minute to every hour. Cleaning completed jobs is purely to prevent unbounded growth and every minute was more aggressive than necessary.The default concurrency for repo- And user-centric sync jobs has been bumped from 1 to 5 to account for larger instances. Historically, GitHub prevented concurrent API access in secondary rate limiting but this has been lifted to be much more lenient long ago. `permissions.syncReposMaxConcurrency` has also been introduced to compliment `permissions.syncUsersMaxConcurrency`.
- Tenant: Fix concurrent creation in DB [#2039](https://github.com/sourcegraph/sourcegraph/pull/2039)
- Tenant: Do not fail on startup [#2038](https://github.com/sourcegraph/sourcegraph/pull/2038)
- Add code_completion feature flag for autoedit model [#2037](https://github.com/sourcegraph/sourcegraph/pull/2037)
- Pings: Move handler code into cmd/pings [#2021](https://github.com/sourcegraph/sourcegraph/pull/2021)
- Authz: Remove unused iteration over authProviders [#2019](https://github.com/sourcegraph/sourcegraph/pull/2019)
- Cody: Fix incorrect language in Cody auth dialog [#2013](https://github.com/sourcegraph/sourcegraph/pull/2013)
- Auth: Bring auth.Providers reads further up [#2011](https://github.com/sourcegraph/sourcegraph/pull/2011)
- Tenant: Restructure multitenant GitHub app implementation [#2010](https://github.com/sourcegraph/sourcegraph/pull/2010)
- Deps: upgrade SAMS SDK [#2006](https://github.com/sourcegraph/sourcegraph/pull/2006)
- Repo: NeedsRepositoryConfiguration is independent of permissions [#1981](https://github.com/sourcegraph/sourcegraph/pull/1981)
- Repoupdater: Enable dbbacked scheduler by default [#1975](https://github.com/sourcegraph/sourcegraph/pull/1975)
- Repoupdater: Split dbworker for clones and fetches [#1974](https://github.com/sourcegraph/sourcegraph/pull/1974)
- Repoupdater: Introduce higher priority for clones [#1972](https://github.com/sourcegraph/sourcegraph/pull/1972)
- Gitserver: Increase duration buckets [#1971](https://github.com/sourcegraph/sourcegraph/pull/1971)
- Added option to create search job from action menu in the results page [#1968](https://github.com/sourcegraph/sourcegraph/pull/1968)
- Tenant: Return multitenantGitHubApp for all users [#1967](https://github.com/sourcegraph/sourcegraph/pull/1967)
- Workspaces: use `time.Now` as the modtime for "index.html" [#1956](https://github.com/sourcegraph/sourcegraph/pull/1956)
- Workspaces: add a quick log to show the modtime of index.html [#1953](https://github.com/sourcegraph/sourcegraph/pull/1953)
- Redis: add warning about using KEYS command [#1913](https://github.com/sourcegraph/sourcegraph/pull/1913)
- Remove debugging code [#1909](https://github.com/sourcegraph/sourcegraph/pull/1909)
- Auth: Craft GatingProvider interface and use in AuthProviders [#1892](https://github.com/sourcegraph/sourcegraph/pull/1892)
- Auth: Small code cleanup [#1891](https://github.com/sourcegraph/sourcegraph/pull/1891)
- Events: Deprecate hashedLicenseKey in events from client [#1887](https://github.com/sourcegraph/sourcegraph/pull/1887)
- Llms: Fixup and streamline cody rate limits [#1700](https://github.com/sourcegraph/sourcegraph/pull/1700)
- Licensing: Implement NonAdmins feature [#1699](https://github.com/sourcegraph/sourcegraph/pull/1699)
- Licensing: Simplify free tier logic a bit [#1695](https://github.com/sourcegraph/sourcegraph/pull/1695)
- Enterprise-portal: add RegisterRoleResources background routine [#1687](https://github.com/sourcegraph/sourcegraph/pull/1687)
- Enterprise-portal: add SAMS notification handler for UserRolesUpdated [#1686](https://github.com/sourcegraph/sourcegraph/pull/1686)
- Security: Auto-update package lockfiles for Sourcegraph base images [#1678](https://github.com/sourcegraph/sourcegraph/pull/1678)
- Workerutil: Move into tenant package [#1533](https://github.com/sourcegraph/sourcegraph/pull/1533)
- Dbworker: RFC for tenant-aware, fast dequeues [#1487](https://github.com/sourcegraph/sourcegraph/pull/1487)

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- [Backport 5.10.x] Context: switch to Snowball stopwords (#2223) [#2225](https://github.com/sourcegraph/sourcegraph/pull/2225)
  - Narrowed down the stopwords list used in Cody context, to fix an issue where we could miss highly relevant files.Backports [https://github.com/sourcegraph/sourcegraph/pull/2223](https://github.com/sourcegraph/sourcegraph/pull/2223)

{/* RSS={"version":"5.11 Patch 0", "releasedAt": "2024-12-19"} */}


# 5.10 Patch 3

> Warning: This release updates the database container images from Postgres 12 to Postgres 16, and begins using Wolfi based images. Customers are advised to have a database backup before upgrading! See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice!
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.10.3940

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.10.3940)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.10.3940)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.10.3940)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.10.3940)

### Features

#### Security

- Introduce UntrustedExternalClient [#2433](https://github.com/sourcegraph/sourcegraph/pull/2433)
  Backport 3f079a57978179aa2ad3f310195346a8c574f9ce from #2349

### Fix

#### Database

- Do not log DSN secrets when changed [#2434](https://github.com/sourcegraph/sourcegraph/pull/2434)
  - We no longer log the postgresql DSN when it changes. Previously this could contain the secret PGPASSWORD.
  Backport 2bd9c09969fff536c6fb29108656658d3f875047 from #2272

### Reverts

  There were no reverts for this release

{/* RSS={"version":"5.10 Patch 3", "releasedAt": "2024-12-19"} */}


# 5.10 Patch 2

> Warning: This release updates the database container images from Postgres 12 to Postgres 16, and begins using Wolfi based images. Customers are advised to have a database backup before upgrading! See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice!
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.10.2832

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.10.2832)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.10.2832)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.10.2832)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.10.2832)

### Features

#### Cody

- Update cody web to 0.17.0 version `(PR #2285)`
- Update cody web to 0.16.0 version `(PR #2284)`  Backport 964eceae584e4eff56df9711da68fef7047cbc40 from #2254

### Fix

#### Bazel

- Syft checksum update `(PR #2218)`

#### Cody

- Disable reranking for airgapped instances `(PR #2194)`

#### Release

- Remove `--link` and add optional args env var `(PR #2216)`
  - Fix(rel): change `pg_upgrade` behavior to use copy instead of hard links  Backport 13caa807d96dd4b5dd872fec2a38322d1888134a from #2192
- Remove -x flag in readiness check on database containers `(PR #2135)`
  - Fix(rel): address issue with readiness check outputting passwords to logs.
  Backport 655a739e8e791d7aab1977d2c26543a3a4871809 from #2132

### Chore

#### Ci

- Bzlmod migration for rules_syft `(PR #2193)`
  -  Backport fbf92aedbb81f00766d7107015b7697352b5c482 from #1812

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 5.10.x] Context: switch to Snowball stopwords (#2223) `(PR #2225)`
  - Narrowed down the stopwords list used in Cody context, to fix an issue where we could miss highly relevant files.Backports [https://github.com/sourcegraph/sourcegraph/pull/2223](https://github.com/sourcegraph/sourcegraph/pull/2223)
- [Backport 5.10.x] bugfix: do not load commit history eagerly `(PR #2201)`
  - Fixes a bug where the new web app may consume an outsized amount of backend resources when browsing large repositories.  Backport 79546146e2bfa4e3fcee1a8e825ad48823c8cd77 from #2197
- [Backport 5.10.x] Cody context: clean up resolvers `(PR #2187)`

{/* RSS={"version":"v5.10.2832", "releasedAt": "2024-12-12"} */}


# 5.10 Patch 1

> Warning: This release updates the database container images from Postgres 12 to Postgres 16, and begins using Wolfi based images. Customers are advised to take a database backup before upgrading! See our [Postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice!
>
> Warning: `automatic` upgrades will require setting the environment variable `SRC_AUTOUPGRADE_IGNORE_DRIFT=true` on the `sourcegraph-frontend` deployment/container.
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.10.1164

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.10.1164)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.10.1164)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.10.1164)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.10.1164)

### Fix

#### Database

- Remove 5.10 deprecation dates on out of band migrations `(PR #1996)`
  - We are removing the deprecation dates on out of band migrations which deprecated in 5.10. This is to unblock MVU and autoupgrades which are encountering a bug with deprecated out of band migrations.  Backport f654dcc9200e2dda2deddc8f98bcd972e6a873fd from #1995

#### Search

- Disable zoekt go-git optimization by default `(PR #2051)`
  - Disabled an indexed search optimization which would skip files accidentally (`ZOEKT_DISABLE_GOGIT_OPTIMIZATION=true`).  Backport 34ada948bdcee3d75499c98f4db5c32986943e88 from #2050

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 5.10.x] oob: Actually run for all tenants `(PR #1994)`

{/* RSS={"version":"v5.10.1164", "releasedAt": "2024-12-03"} */}


# 5.10 Patch 0

> Warning: Admins are advised to upgrade directly to v5.10.1164 circumventing this release.
>
> Warning: This release updates the database container images from Postgres 12 to Postgres 16, and begins using Wolfi based images. Customers are advised to have a database backup before upgrading! See our [postgres 12 end of life](https://sourcegraph.com/docs/admin/postgres12_end_of_life_notice#postgres-12-end-of-life) notice!
>
> Warning: `automatic` and migrator `upgrade` command will not work for this release, please upgrade directly to `v5.10.1164`, or to a 5.9 version and conduct a standard upgrade using migrator's default `up` command!
>
> Also be sure to check your deployment type's [upgrade notes](http://sourcegraph.com/docs/admin/updates#instance-specific-procedures)!

## v5.10.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.10.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.10.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.10.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.10.0)

### Features

#### Autoedit

- Add autoedit model to use chat completions end point `(PR #1809)`

#### Ci

- Move rules_pkg to MODULE.bazel `(PR #1660)`

#### Cody

- Fix ootb prompt details page `(PR #1902)`
- Update cody web to 0.14.0 version `(PR #1895)`
- Add support for out-of-the-box prompts `(PR #1726)`
- Support openai predicted outputs `(PR #1625)`
  - Cody Gateway: add support for OpeanAI predicted outputs
- Added `systemPreInstruction` (CODY-4032) `(PR #1402)`
  - Adds `systemPreInstruction` to the `modelConfiguration` key in site admin config that allows injecting a prelude prompt into every chat request for an enterprise

#### Cody-Gateway

- Add gpt-4o-mini model `(PR #1591)`
  - Cody Gateway: add `gpt-4o-mini` to Cody Gateway allow list
  - Cody Gateway: add `gpt-4o-mini` to DotCom models list

#### Conf/Deploy

- Add 'workspace' deploy type `(PR #1710)`

#### Dev

- Use svelte-dev for multi-tenant `(PR #1843)`
- Add alias 'sg bz cf' for 'sg bz configure' `(PR #1827)`
- Add '-open=false' option for 'sg sams login' `(PR #1498)`
- Adding sg command to request Entitle bundles `(PR #1370)`

#### Gateway

- Add `/models.json` endpoint (PRIME-601) `(PR #1728)`
- Disable flagged model blocking for enterprise (PRIME-602, PRIME-605) `(PR #1659)`

#### Github

- Add client ID support for GitHub App authentication `(PR #1622)`
  - The GitHub app authentication package now supports authenticating a GitHub app via the OAuth client ID following the announcement of [https://github.blog/changelog/2024-05-01-github-apps-can-now-use-the-client-id-to-fetch-installation-tokens/](https://github.blog/changelog/2024-05-01-github-apps-can-now-use-the-client-id-to-fetch-installation-tokens/)

#### Graphql

- Add support for reading GitHub App Installation repos from GitHub REST API `(PR #1711)`
  - A new GraphQL query, `GithubAppRepositoriesForInstallation`, has been added that provides a paginated list of all the GitHub repositories that are accessible to the GitHub app with the provided installation id.
- Add endpoint for getting github app installations scoped by user `(PR #1606)`
  - A new graphql endpoint has been added, GithubAppInstallationsForUser, that returns installation information for the global GitHub multi tenant app when running in multitenant mode.

#### Internal/Github

- Add pagination support and test for GetUserInstallations `(PR #1572)`
  - The Github API client's [GetUserInstallations](https://docs.github.com/en/rest/reference/apps#list-app-installations-accessible-to-the-user-access-token) route, which lists of GitHub App installations the user has access to, now has pagination support.

#### Lib/Cloudapi

- Add support for workload identity to auth roundtripper `(PR #1623)`

#### Local

- Add bazel mod tidy to `sg bazel configure` step `(PR #1656)`

#### Msp

- Apply default max DB conns of 8*CPU `(PR #1394)`

#### Msp/Cloudsql

- Annotate cloudsql trace spans with target database `(PR #1398)`

#### Mt-Router

- Add support for SOAP redirect `(PR #1510)`

#### Multi-Tenant

- Redirect to workspaces/join on user-not-found `(PR #1604)`

#### Multitenant

- Rework GraphQL resolvers and add back App installation link `(PR #1819)`
- Add temporary UI for workspace repository management `(PR #1791)`
- Add helper routine for instantiating github app from multitenant credentials `(PR #1758)`
  - A simple helper routine to the multitenantenv package that automatically populates a github app struct with the provided validated credentials.
- Use default cookie for github app oauth login `(PR #1571)`
  - The routing logic for multitenant mode now has a new route that uses the "last seen tenant" cookie to route github app login authorization callbacks to the appropriate tenant.

#### Release

- Add pg16 and pg16 codeinsights to published images `(PR #1731)`
  - Feat(rel): Add Postgresql 16 and Postgresql 16 codeinsights images to published image list.
- Add pg 16 codeinsights entrypoint and tests `(PR #1730)`
  - Feat(rel): Add self updating to Postgres 16 codeinsights db image.
- Add pg 16 entrypoint and tests `(PR #1718)`
  - Feat(rel): Add self updating to Postgres 16 container image.
- Add wolfi postgres 16 codeinsights-db base image `(PR #1619)`
  - Feat(rel): Add Postgres 16 CodeInsights Wolfi image
- Add wolfi postgres 16 base image `(PR #1617)`
  - Feat(rel): Add Postgres 16 Wolfi image

#### Release

- Handle postgres version upgrades in upgrade test `(PR #1918)`
  - Refactor upgradetest
  - Introduce proper handling of the postgres version upgrade
 Backport 9ccdf4200e3e08cea56bffe5779ca8a6cda2909c from #1894

#### Search

- Include file paths in reranker items `(PR #1866)`
  - Cody context now incorporates filename information in reranking, improving context quality when the reranker is enabled.
- (new web ui) Add 'open in code host' button to repo root and folder pages `(PR #1776)`
- (new web ui) Copy URL to clipboard when clicking 'Permalink' `(PR #1774)`
- (new web ui) Show file/folder name in title instead of full path `(PR #1735)`
- (new web ui) Add survey toast `(PR #1453)`
- (new web ui) Show loading indicator when navigating up the file tree `(PR #1465)`

#### Sg

- Add workspaces common operations `(PR #1845)`
  - Support `get`, `list`, and `delete` workspaces to `sg`

#### Source

- Allow GitHub code host connections to specify an external account as the authenticator `(PR #1842)`
- Multitenant: add worker job for inserting github multitenant app credentials `(PR #1668)`
  - A new worker job has been added that updates the database with the credentials for the global github app when running in multitenant mode.

#### Telemetry

- Add request client name and version to telemetry gateway payload `(PR #1607)`

#### Tenant/Reconciler

- Report backpressure when tenants > 0.85*targetMaxTenants `(PR #1719)`
- Exclude DESTROY_SUCCESS from global reconcile `(PR #1534)`

#### Workspaces

- Check basic email validity to create invite `(PR #1849)`
- Always set displayName=name if displayName is not set `(PR #1838)`
- Email all workspace admins when a user joins a workspace `(PR #1824)`
- Add CheckWorkspaceName RPC `(PR #1822)`
- Initial iteration of new creation flow `(PR #1806)`
- Check billing seats when joining and inviting `(PR #1770)`
- Always apply DEFAULT_WORKSPACE_INSTANCE_CLASS on workspace create `(PR #1763)`
- Accept instance class `(PR #1752)`
- List eligible-to-join workspaces in UI `(PR #1672)`
- Explicit invites POC `(PR #1624)`
- Error-log illegal state transitions for Sentry `(PR #1616)`
- List includes workpsaces a user can join via open invite `(PR #1586)`
- Make membership limits configurable `(PR #1584)`
- Name, display name, and open invite email domain blocklists `(PR #1539)`
- Free up assigned workspace slot when workspace is DESTROY_SUCCESS `(PR #1535)`
- Prevent management API from reading workspaces in deletion state `(PR #1508)`
- Prune iam store on deletion `(PR #1504)`
- Implement router pruning, add 'pruned_router_at', 'pruned_iam_at' `(PR #1480)`
- Delete and reconcile routes `(PR #1440)`

#### Workspaces/Blocklists

- Improve heuristics and errors `(PR #1801)`

#### Workspaces/Instances

- Add UNAVAILABLE, CAPACITY_PRESSURE states `(PR #1712)`

#### Workspaces/Integrations

- Provide workspace uri `(PR #1477)`

#### Workspaces/Web

- As-you-type name validation POC `(PR #1858)`

#### Others

- Switch to buildkite for nightly release pipeline `(PR #1690)`
  - N/A
- Add new telemetry v2 events for server side batch changes `(PR #1666)`
- Add events for interactions with search input toggle buttons `(PR #1469)`
- Add events for codenav actions `(PR #1441)`
- Make filters sidebar collapsible `(PR #1437)`
  - Search filters sidebar is now collapsible
- Add dynamic filters and aggregation for repo metadata and topics `(PR #1420)`
  - Added dynamic filters and the ability to aggregate by repo metadata and repo topic
- Render mdx as markdown `(PR #1392)`
  - Render .mdx files as markdown

### Fix

#### Batch Changes

- Titles now break over multiple lines if they are too long `(PR #1582)`
  - Fix(batches): titles now break over multiple lines if they are too long
- Do not ignore bool env var parsing error `(PR #1537)`

#### Client

- Address pnpm lint:js:web issues and add job in CI `(PR #1520)`

#### Code Intelligence

- Align repo batch settings between syntactic and precise indexing `(PR #1663)`
- Fix wrong offset in policy iteration `(PR #1546)`

#### Cody

- Use models from model config for PLG chat `(PR #1870)`
- Sync allowed models in dotcom user rate limits with models.json `(PR #1864)`
- Filter allowed models based on subscription tier `(PR #1636)`

#### Database

- Drop unique slug contraint from github app table `(PR #1689)`
  - The github_apps table has removed an erroneous unique constraint that accidentally incorporated an app's slug (which is mutable) as part of the unique identifier for an app.

#### Database

- Update generated squash and schemas `(PR #1917)`

#### Dev

- Fix kill pubsubemulator `(PR #1850)`
- Correctly pick up error message from 'sg sams login' `(PR #1482)`

#### Enterpriseportal

- Allow list to accept display name query of 2 characters `(PR #1603)`

#### Gateway

- Add blocked phrase if request was blocked due to flagged models list (PRIME-603) `(PR #1670)`
- Make model cost a pointer (CODY-4007) `(PR #1427)`

#### Graphql

- Refactor getGithubAppFromEnvvar to use multitenantEnv.Config.AsGithubApp `(PR #1767)`
  - The logic in the new multitenant GraphQL resolvers has been reworked to use the new helper methods introduced in the Multitenant GitHub app configuration logic introduced in [https://app.graphite.dev/github/pr/sourcegraph/sourcegraph/1758/](https://app.graphite.dev/github/pr/sourcegraph/sourcegraph/1758/).

#### Insights

- Fix incorrect line counts in non-default config `(PR #1517)`
  - Code insights should show correct line counts when enhanced language detection is turned off (note: this setting is on by default).

#### Local

- Display external env overrides when displaying environment variables `(PR #1595)`
- Sg - Fix images query to point to correct rule `(PR #1430)`

#### Release

- Fix oob migrations hanging `(PR #1959)`
  - NA
  Backport a943412a99852332f921b52a0ee3179dc3331d20 from #1958
- Add vacuum after reindex in Postgres upgrade script `(PR #1779)`
  - Fix(rel): Add vacuum to Postgres upgrade process
- Install `sg` in the nightly pipeline GHA `(PR #1675)`
  - N/A

#### Release

- Correct views drift in postgres 16 `(PR #1878)`
  - Add migrations to handle database drift caused during postgres 12 to postgres 16 upgrade
- Fix drift check in local upgradetest `(PR #1832)`
  - Fix bug in local upgrade test preventing final stage drift check via private monorepo

#### Search

- Consistently marshal SearchTypeRegex as regexp `(PR #1919)`
  - We sometimes would emit `patternType:regex` instead of `patternType:regexp`. We now always do regexp as well as treating regex as an alias for regexp.
  Backport a095b39ac39cfcbe3526ecf85ed6d50cb5fa3d9d from #1808
- Executors on Kubernetes: propagate user and group from Executor env vars to batch change job pod `(PR #1863)`
  - The environment variables `KUBERNETES_RUN_AS_USER` and `KUBERNETES_RUN_AS_GROUP` contribute to the Job `PodSpec`'s `SecurityContext`.
  - The default value for those variables is `-1`, which could cause errors with some Kubernetes clusters.
- (new web app) Only update user activity data once on load `(PR #1797)`
- (new web ui) Respect 'window.context.disableFeedbackSurvey' flag `(PR #1778)`
- (search input) Treat not, and, or as keywords regardless of case `(PR #1733)`
- (new web ui) Fix dimensions of line selection marker `(PR #1417)`
- (new web ui) Add rollover effect to RadioButtonGroup `(PR #1416)`
- (new web ui) Fix duplicate lint suggestion insertion `(PR #1413)`
- (new web ui) Remove unintentional vertical scrollbars `(PR #1411)`
- (new web ui) Only show specific repo menu items when features are enabled `(PR #1401)`

#### Security

- Do not expand env vars in executor logs `(PR #1811)`
  - This change reduces the risk of secrets being emitted in executor logs even if there are bugs in the secret redaction logic.

#### Sg

- Remove noop -d declaration for psql `(PR #1455)`
- Specify postgres database for psql commands `(PR #1450)`

#### Source

- P4-fusion now decodes encode file paths from Perforce `(PR #1347)`
  - When cloning Perforce depots, Sourcegraph will now decode encoded paths correctly (paths that include characters like `@` and `#`)

#### Tenant/Reconciler

- Do not check dormancy if still in PROVISION states, only check if needed `(PR #1605)`
- On getTenantErr, report destroy state if in destroy state `(PR #1563)`

#### Workspaces

- Properly represent workspace state to management API `(PR #1816)`
- Fix DESTROY_PENDING proto adapter, improve handling of unknown states `(PR #1814)`
- Improve CreateWorkspace resilience `(PR #1773)`
- Remove broken down-migration statements `(PR #1754)`
- Support creating workspaces over API `(PR #1714)`
- Do not list all workspaces if user has no memberships `(PR #1671)`
- Tidy up email-disabled error log `(PR #1667)`

#### Workspacesreconciler

- Fix double-counting of checked workspaces `(PR #1753)`

#### Others

- Prompt page tweaks `(PR #1899)`
- Revision picker growth `(PR #1875)`
- More contrast updates `(PR #1871)`
- Reranker: recreate from config on every call `(PR #1865)`
- Prompt library visual updates `(PR #1852)`
- Use standard protojson library for reducing memory `(PR #1846)`
- Increase contrast everywhere `(PR #1840)`
- Make owner nullable in prompts `(PR #1746)`
- Only retry queries `(PR #1706)`
- Reranker: listen to config changes, do not mutate config `(PR #1705)`
- Retry graphql on 502 errors `(PR #1683)`
  - Fix(web): retry graphql requests on network errors
- Styling changes to explore panel and badges `(PR #1528)`
- Increase contrast of highlighted code background and line numbers in selected area `(PR #508)`

### Chore

#### Ci

- Container structure test bzlmod migration `(PR #1818)`
- Migrate protobuf and rules_proto rules to bzlmod `(PR #1749)`
- Move buildifier prebuilt to bzlmod `(PR #1709)`
- Increase buildifier timeout to 6m `(PR #1658)`
- Move bazel_skylib to bzlmod `(PR #1654)`
- Bazel - Remove build_tests_only flag for db tests `(PR #1610)`
- Bazel - Add config settings to switch between pg-12 and pg-16 binaries `(PR #1601)`
- Refactor bazel migrations `(PR #1583)`
- Update github workflow for pg-12 and pg-16 package variants `(PR #1580)`
- Upgrade aspect bazel lib `(PR #1425)`
- Upgrade to latest rules proto grpc `(PR #1424)`
- Enable db tests task to run on ci agents with postgres 16 `(PR #1293)`
- Upgrade rules_pkg `(PR #976)`
- Upgrade aspect cli `(PR #975)`

#### Code Intelligence

- Remove unused return value & pass TraceLogger `(PR #1551)`
- Enable exhaustruct for more subfolders (part 2) `(PR #1547)`
- Document why RepositoryID field is nil `(PR #1545)`
- Add helper types for relationships `(PR #1542)`

#### Dev

- Delete tracking-issue package `(PR #1556)`
- Add iterator helper for pagination `(PR #1555)`
- Fix links to sg monorepo in Markdown `(PR #1554)`
- Add more helper functions to iterext `(PR #1549)`
- Enable exhaustruct for more subfolders `(PR #1544)`
- Add helper package for property-based testing `(PR #1540)`
- Introduce helper package for iter.Seq `(PR #1522)`
- Fix links to sg monorepo `(PR #1519)`
- Simplify language detection code in inventory `(PR #1518)`
- Flip polarity of boolean for language detection `(PR #1516)`
- Use a lazyFile type to consolidate lazy file content fetching `(PR #1515)`
- Rename functions for clarity `(PR #1514)`
- Remove direct usages of enry.IsVendor `(PR #1513)`
- Simplify sorting logic `(PR #1512)`
- Rename type Lang -> LanguageStats `(PR #1511)`
- Migrate from sync.WaitGroup to conc APIs `(PR #1495)`
- Fix warning about missing integrity field `(PR #1494)`
- Update for loops for newer syntax `(PR #1488)`
- Factor out offset & limit logic `(PR #1486)`
- Switch to alternate orderedmap library `(PR #1414)`
- Clarify docs & naming in debugserver code `(PR #1384)`

#### Dev/Mt-Router

- Silence cache miss on default `(PR #1565)`

#### Dotcom

- Rename 'cody services' to just 'cody gateway' `(PR #1466)`

#### Frontend

- Store model config in global var `(PR #1805)`

#### Gateway

- A few small docs fixes `(PR #1751)`
- Make provider type more specific `(PR #1750)`

#### Local

- Small improvements to sg entitle `(PR #1794)`

#### Msp/Iam

- Suggest standard IAM_MAX_DB_CONNS as env var `(PR #1499)`

#### Release

- Remove postgres-12 wolfi from published images `(PR #1737)`
  - Chore(rel): remove unused Postgres 12 images
- Remove appliance from published images and codebase `(PR #1732)`
  - Chore(rel): remove appliance from published images

#### Release

- Remove check against latest full version in `--post-release-version` code path `(PR #1585)`

#### Search

- (new web ui) Improve search home page SG logo rendering `(PR #1813)`
- Add NodeJS 20 to the Bundled Executor image `(PR #1569)`
- Update search web app title and description for SEO on dotcom `(PR #1509)`
- Add JDK 17 and 21 to the Bundled Executor image `(PR #1502)`
- (new web ui) Remove beta badge from search progress popover `(PR #1418)`
- Update CPU and MEM panels for zoekt `(PR #1368)`
  - We have updated the CPU and MEM monitoring panels for Zoekt on Grafana. The new panels reduce redundancy and provide more insight into MEM distribution.

#### Source

- Simplify oauth middleware `(PR #1876)`
- Update the gitserver image lockfile to contain the latest p4-fusion `(PR #1410)`
- Default perforce changelist mapping to enabled `(PR #1376)`

#### Telemetry

- Align billing metadata values with 'sourcegraph/cody' `(PR #1396)`

#### Telemetry/Geolocation

- Update DB-IP Lite database `(PR #1468)`
  - The local geolocation inference database used in telemetry and audit logs has been updated.

#### Telemetrygateway

- Bump slow-request threshold `(PR #1647)`

#### Tenant/Reconciler

- Add some additional diagnostics `(PR #1795)`

#### Workspaces

- Include longer s&p500 names for fuzzy matching `(PR #1844)`
- Make unexpected errors more friendly `(PR #1821)`
- Add spans on write interactions `(PR #1807)`
- Instantiate large blocklists once in store `(PR #1562)`

#### Workspaces/Web

- Use unified client constructor `(PR #1828)`

#### Others

- Rename method to indicate lack of redaction clearly `(PR #1790)`
- Reorder fields in executor Config `(PR #1785)`
- Remove custom Set type `(PR #1742)`
- Rename Set.Values() -> ValuesNonDet() for clarity `(PR #1741)`
- Avoid materializing Set Values() just for length `(PR #1739)`
- Add env var to disable precise & syntactic `(PR #1707)`
- Bump autoindexing image SHAs `(PR #1703)`
- Move CodyGatewayRateLimit calculation to where it's used `(PR #1693)`
- Remove env lock mechanism `(PR #1593)`
  - Fix(dev): remove env.Get lock that could cause a runtime panic
- Update event names `(PR #1500)`
- Remove robert from many CODENOTIFYs `(PR #1421)`
- Update new search events to make them easier to use `(PR #1395)`

### Refactor

#### Local

- Move reset-pg to internal/db `(PR #1573)`

### Reverts

- Revert "chore/dev: upgrade aspect_bazel_lib to 2.9.4 (#1713)" `(PR #1713)`

### Uncategorized

#### Others

- [Backport 5.10.x] Revert "chore(source): simplify oauth middleware" `(PR #1928)`
- Githubapp: Expose monolith GitHub app ClientID `(PR #1904)`
- Pnpm: Remove leftover appliance links in workspace `(PR #1900)`
- Core: Fixup pnpm lockfile `(PR #1886)`
- Tenant: Hide unlink button for SAMS external accounts `(PR #1885)`
- Auth: Hide unlink button for external accounts that cannot be unlinked `(PR #1884)`
- Svelte: Correctly hide navbar entries `(PR #1883)`
- Svelte: Add back settings link `(PR #1882)`
- Workspaces/billing: attach metadata and context without cancel whenever possible `(PR #1881)`
- Web: respect `expanded` in the search results URL `(PR #1880)`
  - Fixed an issue where searches from saved URLs may now show aggregations by default
- Add timeout to gateway calls `(PR #1879)`
- Workspaces: Align styling for join page `(PR #1860)`
- Workspaces: Add tables for listing workspaces `(PR #1857)`
- Workspaces: Slightly tweak style `(PR #1851)`
- Workspaces: Directly link to installation target `(PR #1848)`
- Tenant: Suppress some irrelevant missing_context pprof traces `(PR #1847)`
- Workspaces: Fix workspace picker rendering in React `(PR #1841)`
- Fix permissions connection resolver ordering `(PR #1839)`
- Workspaces: Add seat selector on plan page `(PR #1835)`
- Workspaces/billing: create RPC for purchasing seats `(PR #1831)`
- Workspaces/billing: extract subscription attribute computation into a `Plan` helper `(PR #1830)`
- Workspaces: Add updated workspace pickers for tenant `(PR #1829)`
- Workspaces: Add field to pre-purchase extra seats `(PR #1826)`
- Workspaces/billing: implement periodic workers for subscription renewal `(PR #1823)`
- Auth: Fix background contexts in validate authz provider `(PR #1802)`
- Redispool: support more configuration options `(PR #1799)`
- Workspaces/billing: add tests to `cmd/workspaces/internal/billing` `(PR #1786)`
- Workspaces/billing: update test for `ManagementService.CreateWorkspace` `(PR #1784)`
- Workspaces/billing: add database tests for customers `(PR #1783)`
- Workspaces/billing: add database tests for transactions `(PR #1782)`
- Require `X-Requested-With` for Cody API (CODY-4209) `(PR #1781)`
  - `X-Requested-With` is now a required HTTP header for Cody API calls
- Context: narrow down stopwords list `(PR #1780)`
- Workspaces/billing: ignore invoices that are not for the current instance `(PR #1777)`
- Workspaces/billing: support soft-deleting subscriptions `(PR #1772)`
- Feature/internal: upsert github credentials on tenant creation `(PR #1769)`
  - The multitenant reconciler now proactively inserts the credentials for the shared multitenant GitHub app whenever a new tenant is created.
- Lib/cloudapi: add mt instance type `(PR #1766)`
- Tenant: Add configuration for MT GitHub App to localdev `(PR #1756)`
- Seed builtin prompts `(PR #1755)`
  - Prompts including "Document Code", "Explain Code", "Generate Unit Tests", "Find Code Smells"
- Tenant: Enable onebox on tenant creation `(PR #1748)`
- Onebox: introduce 'nls' patterntype `(PR #1744)`
- Workspaces/billing: implement Stripe webhook handler `(PR #1740)`
- Cody-gateway: update deployment id for model `(PR #1729)`
- Workspaces/billing: implement seat purchase and consumption `(PR #1723)`
- Localdev: Disable precise, syntactic codeintel in multitenant mode `(PR #1720)`
- Workspaces/billing: use the "correct" way to list customer payment methods `(PR #1717)`
- `sg start sveltekit-minimal` for quickly running the new UI `(PR #1702)`
- Conf: Move more types to conftypes `(PR #1692)`
- Remove experimental admin onboarding v2 `(PR #1691)`
- Telemetry: Implement telemetry exports for workspaces `(PR #1677)`
- Autoedit: add speculative decoding `(PR #1673)`
  - Autoedit: Add speculative decoding support from fireworks
- Fix `marketingTracking` sending null `(PR #1669)`
- Prompts: fix prompt name validation and prompts migration  `(PR #1664)`
- Add GraphQL resolvers to read and set a list of repositories for a GH App installation ID `(PR #1657)`
- Fixup: remove Git conflict marks in `sg.config.yaml` `(PR #1649)`
- Require prompt field before successful submission `(PR #1639)`
- Add builtin prompts field to prompts `(PR #1633)`
- Zoekt: refactor memory dashboards `(PR #1618)`
- Workspaces: add billing prototype for subscription creation `(PR #1611)`
- Admin: Update report an issue link `(PR #1608)`
- Change default autoedit model `(PR #1589)`
- Feat(cloud) sg cloud eph deploy: support ms env `(PR #1581)`
- Add Cody.promptLibrary telemetry `(PR #1568)`
- Worker: Group tasks by purpose `(PR #1566)`
- Improve policy iterator tests to not rely on SQL for insertion `(PR #1560)`
- Repoupdater: Fix slow scheduling of cloned->uncloned repos `(PR #1552)`
- Repoupdater: Fix reporting of background routines `(PR #1550)`
- Update Prompts Library UI (list page) `(PR #1548)`
- Update prompt detail header UI `(PR #1538)`
- Context: remove experimental intent routing `(PR #1536)`
- Add 'recommended' checkbox to new creation UI. `(PR #1531)`
- Dormancy: Also fall asleep tenants that never see traffic `(PR #1530)`
- Fix reranker not being applied `(PR #1529)`
- Sg: Fix local dev pguser setup `(PR #1506)`
- Context: ensure we propagate timeouts and missing repos `(PR #1505)`
- Make Visual Studio Experimental `(PR #1503)`
- Context: always use more items for reranker `(PR #1476)`
- Remove insert prompt mode `(PR #1475)`
- Add missing Cody Web Alert CSS variable override `(PR #1474)`
- Repoupdater: Fix no rows returned error `(PR #1472)`
- Add autoedits to cody gateway `(PR #1459)`
- Ci: bump go-mod-tidy step timeout `(PR #1452)`
- Add commands to prompts migration `(PR #1449)`
- Repoupdater: Speed up repo_update_job dequeues `(PR #1448)`
- Repoupdater: Clean up metrics `(PR #1447)`
- Repoupdater: Speed up and simplify not fetched metric `(PR #1446)`
- Migration: Checkpoint new repo_update_jobs migration `(PR #1445)`
- Gomod: bump Zoekt for query perf fix `(PR #1438)`
- Implement prompt detail page re-design `(PR #1423)`
  - Re-designed prompt detail page.
- Add page faults to Zoekt memory metrics `(PR #1422)`
- Chore/source Update src-cli version to 5.8.2 `(PR #1415)`
  - Chore/source Update src-cli version to 5.8.2
- Siteadmin: Reset pagination cursors after filter change `(PR #1404)`
- Bugfix: fix settings link `(PR #1393)`
- Gomod: bump Zoekt for go-git optimization `(PR #1391)`
- Update Marketing URLs in the site footer links `(PR #1390)`
- Soft delete prompts `(PR #1386)`
- Widen blocked phrases, but only confine blocked phrases to expensive (aka flagged) models `(PR #1344)`
- Repoupdater: Drop support for gitUpdateInterval `(PR #1339)`
  - The site config setting `gitUpdateInterval` has been deprecated and removed. We are removing it in favor of smarter heuristics like webhooks, user traffic, and repo staleness.
- Repoupdater: Remove total from schedule and update queue state `(PR #1338)`
- Add system workspace admin role `(PR #1327)`
- Add syntactic worker to images so it gets updated in helm charts `(PR #1323)`
- Feature/source: adjust exclude definition in github schema to disallow using name, id with other filter conditions `(PR #1250)`
  - The github code host connection schema for `exclude` has been updated to enforce that the name and id fields can't be combined with any other fields.
- Add gitSSHCipher for git code hosts `(PR #1175)`
- RFC: Dormancy and tenant states `(PR #756)`
- Web telemetry: update `marketingTracking` to retrieve latest cookies set on web `(PR #460)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Fix wrong offset in policy iteration `(PR #1559)`
- Release: Prep stitched migration graph for release (#1388) `(PR #1389)`
  - N/a

{/* RSS={"version":"v5.10.0", "releasedAt": "2024-11-27"} */}


# 5.9 Patch 4

## v5.9.17785

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.9.17785)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.9.17785)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.9.17785)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.9.17785)

### Fix

#### Cody

- Allow specification of additional chat GPT models for Cody `(PR #3434)`
Backport 5190f43a4d09810e69400c5d0e6d9176b3c4b815 from #3380

# 5.9 Patch 3

## v5.9.1590

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.9.1590)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.9.1590)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.9.1590)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.9.1590)

### Fix

#### Code Intelligence

- Fix wrong offset in policy iteration `(PR #1559)`

#### Cody

- Fix broken homepage redirect for cody only plans `(PR #1626)`
  - When using an instance with a Cody-only license, accessing the home page now correctly redirects you to /cody/dashboard, instead of a non-existent /cody page.
  Backport a4cb5a0723bad18e1c215d81231db457d1abfbdb from #1621

#### Search

- (new web ui) Disable persistence for history/explore panel `(PR #1614)`

### Chore

#### Release

- Remove extra v identifier for version in artifact exporter `(PR #1594)`
  Backport c4b838103ce2f71e7591ade720e8bdf17f9a5b39 from #1490

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 5.9.x] azure: Add support for repositoryPathPattern `(PR #1629)`
  - Added support for the `repositoryPathPattern` property to Azure DevOps code host connections.
  - Fixed an issue where Azure DevOps repo names included a port number - Aligning with other code host connection implementations  Backport 762bd89a12825ff05de98d9c2d8adfcf1ef5bf4a from #1543

{/* RSS={"version":"v5.9.1590", "releasedAt": "2024-11-13"} */}


# 5.9 Patch 2

## v5.9.347

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.9.347)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.9.347)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.9.347)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.9.347)

### Fix

#### Dev

- Hoist env vars init to avoid repo-updater panic `(PR #1527)`

### Reverts

  There were no reverts for this release

{/* RSS={"version":"v5.9.347", "releasedAt": "2024-11-06"} */}


# 5.9 Patch 1

## v5.9.45

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.9.45)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.9.45)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.9.45)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.9.45)

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- "Add syntactic worker to images so it gets updated in helm charts"" `(PR #1483)`

{/* RSS={"version":"v5.9.45", "releasedAt": "2024-11-05"} */}


# 5.9 Patch 0

## v5.9.0

- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.9.0)

- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.9.0)

- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.9.0)

- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.9.0)

### Features

#### Api

- Added a better error message for 429 errors for `/.api/cody/completions` (CODY-4097) `(PR #1380)`

#### Audit

- Add tenant to audit logs, fix log stack `(PR #960)`

#### Batch Changes

- Show name of additional fields that cause errors `(PR #799)`
  - Feat(batches): show name of additional fields that cause errors

#### Ci

- Generate frozen files as part of stich_migration_graph generation `(PR #957)`
- Record Test infrastructure failures `(PR #884)`
  - Add library that writes to TEST_INFRASTRUCTURE_FAILURE_FILE if it is defined for test failures

#### Cloud

- Allow monolithsams instances to have no conf auth providers `(PR #1247)`
- Add support to override target managed service endpoints `(PR #1238)`
- Add support to override license generation public key from cloud site config `(PR #1193)`

#### Code Intelligence

- Syntactic indexing grafana monitoring dashboard `(PR #1263)`

#### Cody

- Add more API docs content `(PR #1378)`
- Add CLI tool to compute PCW `(PR #1349)`
- Add Claude 3.5 Sonnet (Latest) & Claude 3 Opus (Latest) `(PR #1244)`
- Add Cody Audit Log `(PR #1232)`
- Add cody audit log table and store `(PR #1182)`
- Expose token usage in the LLM API `(PR #1070)`
  - The `/.api/completions/stream` API now includes used input/output tokens and the upstream model name in the response body when using the query parameter `api-version=5` or higher. Does not apply to: Vertex Anthropic, Azure OpenAI (mo model name, and no token usage in streaming response), Gemini (no model name in streaming response)
  - LLM chat completions now support `stream: false` when using Azure OpenAI and OpenAI-compatible providers.
- Update telemetry feature prefix for Cody API `(PR #1023)`
- Add embedded API docs via OpenAPI/Redocly `(PR #1014)`
  - New OpenAPI API docs within the instance at the URL `$SRC_ENDPOINT/api/openapi/public`. Alternatively, reach the page at "User > Settings > OpenAPI Reference".
- Add basic telemetry recording for Cody API `(PR #943)`
- Add support to format raw API responses for Cody `(PR #877)`
  - The raw HTTP API now accepts the query paramter `format=cody` or header `Accept: application/cody` to render files and directories as context items for Cody. Example request path: `/github.com/sourcegraph/cody/-/raw/agent/src/index.ts?format=cody`.

#### Cody-Gateway

- Add new claude-3-5-haiku-latest model `(PR #1471)`
Cody Gateway: add new claude-3-5-haiku-latest dotcom models list  Backport 11e7481ba3c810ae5b47d32b8cf32066e2f0b2bb from #1470
- Deprecate old claude 3.5 sonnet `(PR #1248)`

#### Dev

- Add externalSecret support for commandsets `(PR #1027)`
- Sg sams login and cookie-less workspace creation `(PR #913)`

#### Graphql

- Upload graphql schemas to GCS bucket `(PR #1245)`

#### Internal/Requestclient

- Have HTTP middleware populate all response headers with observed X-Forwarded-For and calculated IP for debugging purposes `(PR #524)`
  - All of Sourcegraph's HTTP responses now contain two new headers for easier debugging purposes.
- `Observed-X-Forwarded-For`: echos the `X-Forwarded-For` header
that we observed on the user's incoming request
- `Observed-Calculated-IP-From-Forwarded-For`: indicates the IP address that we derived from the user's `X-Forwarded-For` header

#### Local

- Use pending spinner for build waiting in cloud ephemeral `(PR #1039)`
- Add format for displaying env `(PR #918)`

#### Monitoring

- Set decimals to 1 for standard heatmap `(PR #1361)`

#### Monolithsams

- Load SAMS provider and creds from env `(PR #1024)`

#### Msp

- Package 'auditlog' `(PR #1223)`

#### Msp/Pg

- Updated o11y for pool acquire, add overrides for pgxpool.Config `(PR #1375)`

#### Search

- (new web ui) Show loading feedback for hovercards `(PR #1239)`
- (new web ui) Add ability so switch search scope in fuzzy finder `(PR #1201)`
- (new web ui) Make view modes available when opening a file at a commit `(PR #1090)`
- (new web ui) Render relative images in rich text documents `(PR #841)`

#### Sg

- Make workspaces endpoint configurable `(PR #998)`
- Implement show-env flag `(PR #883)`

#### Site Admin

- Site config 'telemetry: \{ disableLocalEventLogs \}' to disable event_logs `(PR #1275)`
  - Long-term local retention of user telemetry as 'event logs' can now be disabled entirely via the `telemetry: { disableLocalEventLogs }` site configuration.

#### Sub_repo_perms

- Add conditional logging for seeing if sub_repo_permisisons are working `(PR #673)`
  - The sub repository permissions implementation now emits logs that describe the rules that were evaluated for a given request whenever tracing is enabled. (We limit these logs for only when tracing is enabled since they can be quite verbose).

#### Telemetry

- Log estimated LLM cost telemetry (CODY-4007) `(PR #1312)`
  - Adds cost estimates to the ModelConfiguration returned by `.api/llm/supported-models.json`
  - Adds `llmTokenUsageCostEstimate` telemetry value with estimates of each requests LLM cost in pennies
- Add check for PGDATASOURCE `(PR #1281)`
- Add source.server.server_client.user_agent to telemetry payload `(PR #1120)`
  - Add the sourcegraph API client user-agent to telemetry payload types under `source.server.server_client.user_agent`.
- Check for external dbs `(PR #1083)`
- Propagate new x-sourcegraph-api-client-* Headers to request clients `(PR #1025)`
  - Propagates new X-Sourcegraph-API-Client-Name and X-Sourcegraph-API-Client-Version headers to request clients

#### Telemetry-Gateway

- Improve logging on processing done `(PR #1252)`

#### Telemetrygateway

- Implement publishusermetadata RPC `(PR #1095)`
- Spec PublishInstanceUserMetadata and pubsub format `(PR #1053)`

#### Telemetrygatewayexporter

- Log export duration, use better duration buckets `(PR #1305)`

#### Tenant/Reconciler

- Full membership reconcile `(PR #953)`
- Handle tenant-exists, new-tenant, and error combination paths `(PR #895)`

#### Worker

- Delete legacy event_logs exporter `(PR #859)`

#### Worker/Telemetrygatewayexporter

- Opt-in user metadata exporter `(PR #1096)`

#### Workspaces

- Notify user state updates `(PR #1316)`
- Allow join-by-email to be provided on creation `(PR #1280)`
- Add management GetWorkspace that allows view-by-email-domain `(PR #1277)`
- Guard against excessive join-workspaces `(PR #1251)`
- Restrict memberships/admins before allowing workspace creation `(PR #1212)`
- Join by email domain POC `(PR #1162)`
- Configure join by email domains `(PR #1158)`
- Only recently seen instances are candidates for hosting workspace `(PR #1031)`
- Ban 'default' as a workspace name `(PR #992)`
- Forbid 'src-'-prefix workspace names `(PR #920)`
- Refactor workspace states with reconcile and dormancy `(PR #819)`

#### Workspaces/Management

- Always return roles `(PR #1358)`
- Provide workspace URI `(PR #1055)`

#### Workspacesreconciler

- Add WORKSPACESRECONCILER_INSTANCE_STATE_OVERRIDE and 'AT_CAPACITY' state `(PR #1297)`
- Global periodic reconciler `(PR #997)`

#### Others

- Surface result precision in the explore panel `(PR #1359)`
- More complete search backend events `(PR #1257)`
- Add embedded file snippet page `(PR #1196)`
  - Added embeddable page for file snippets
- Add embedded file snippet component `(PR #1122)`
- Add search aggregations to svelte webapp `(PR #1093)`

### Fix

#### Api-Docs

- Added OpenAPI Urls to static page info `(PR #1379)`

#### Batch Changes

- Enable request splitting by default `(PR #1229)`
  - Fix(batches): enable request splitting by default
- Handle spec being nil for suffix salt `(PR #1228)`
  - Fix(batches): handle spec being nil for suffix salt
- Enable GQL request splitting via BATCH_CHANGES_REQUEST_SPLITTING `(PR #1150)`
  - Fix(batches): enable GQL request splitting via BATCH_CHANGES_REQUEST_SPLITTING
- Display "Deleted Namespace" instead of throwing an error `(PR #778)`
  - Fix(batches): display "Deleted Namespace" instead of throwing an error

#### Ci

- Remove dependsOn key for PG16 step `(PR #1295)`
- Disable db test task temporarily `(PR #1292)`
- Generate coreos iptable BUILD.bazel file `(PR #1230)`
- Cap branch names in image tags `(PR #1103)`

#### Code Monitor

- Fail monitors with missing/unverified primary email address `(PR #938)`
  - Fix(code-monitor): fail monitors with missing/unverified primary email address

#### Code Intelligence

- Add more limits in auto-indexing inference code `(PR #1170)`
  - Introduces new limits for auto-indexing inference to reduce the risk of continuously growing auto-indexing queues.
  - The number of jobs spawned per round of auto-indexing inference per repo is capped (default: 100) to reduce risk of clogging of auto-indexing queues. Excess jobs will be discarded.
  - The number of paths inspected for a single round of auto-indexing inference per repo is capped (default: 500) to reduce risk of timeouts. Excess paths will be discarded.
- Handle annotated tag hashes passed as 'commit' for uploads `(PR #1135)`
  - Fixes handling of SCIP uploads when the hash passed to the `-commit` flag of `src-cli` corresponds to the hash of an annotated tag instead of the hash of a commit. Previously, these uploads were not accessible for code navigation.
- Propagate error collector to fix retention tab GraphQL API call `(PR #847)`
  - Fixes a bug where the retention tab for precise indexes would show
a nil pointer exception instead of retention information.

#### Code Nav

- Trigger hovers for all programming languages `(PR #1076)`
  - Fixes a bug where hovers were not triggered for less mainstream languages like F#,
Standard ML, Visual Basic, Pkl, Hack, MATLAB etc.

#### Cody

- Convert nil message content parts for OpenAI compatability `(PR #1467)`
- Guard against completion usage missing (CODY-4135) `(PR #1218)`
- API telemetry `(PR #1026)`
- Reset usage when rate limit value or interval decreased `(PR #1015)`
- Fix CodyLLMConfiguration resolver `(PR #839)`

#### Codyapi

- Restrict audit log retrieval to site admins only `(PR #1285)`
- Add usage to completions/chat (CODY-3498) `(PR #1131)`
  - Added token usage information to `.api/llm/chat/completions`

#### Completions

- Clear out usage information on the completions API when version < 5 (CODY-4114) `(PR #1153)`

#### Dev

- Correctly propagate error key-value pairs `(PR #1258)`
  - Fixes a bug where logs and traces were sometimes missing key-value pairs recorded alongside errors.
- Fix sg db reset-pg PGUSER overwrite `(PR #1220)`
- Fix secrets deadlock `(PR #1032)`
- Fix workspaces client in local dev `(PR #1028)`
- (new web ui) Properly initialize local dev defaults `(PR #961)`
- Remove removed table from MT migration `(PR #910)`
- Report warning if workspace creation failed `(PR #909)`
- Fix workspaces flakey test `(PR #862)`

#### Frontend

- Place requestclient as one of the first middleware `(PR #1215)`

#### Local

- Move env into correct grouping `(PR #1332)`
- Specify default database when checking psql version in `sg setup` `(PR #924)`
- Fix issue with sg start monitoring ignoring dockerCommands `(PR #848)`

#### Mt-Router

- Prevent infinite oauth redirect `(PR #1118)`

#### Release

- Rename generated changelog file `(PR #1136)`
- Add stitched migration graph override (#935) `(PR #941)`
  - NA

#### Search

- Disable hybrid search with index:no `(PR #1462)`
  - `index:no` will now avoid the index completely. Previously it would still consult the index via a process called hybrid search. Search jobs always uses `index:no`, so if you notice a performance problem please reach out to Sourcegraph support. Setting `SRC_DISABLE_RESPECT_INDEX_FIELD` environment variable on the frontend and worker pods will disable this new behaviour in 5.9.x only.Stacked on `(PR #1456)` Closes [https://linear.app/sourcegraph/issue/SPLF-663/disable-hybrid-search-for-search-jobs](https://linear.app/sourcegraph/issue/SPLF-663/disable-hybrid-search-for-search-jobs)  Backport 7aced46a7bc3526695a77e492ee69ad2cfa7bb17 from #1460
- (new web ui) Render submodules differently in file trees `(PR #1377)`
- Fix document highlights in certain situations `(PR #1343)`
- (new web ui) Fix relative links to folders `(PR #1331)`
- (new web ui) Fix file tree sidebar not staying at top level directory `(PR #1328)`
- (new web ui) Show informative message when repo has no README or description `(PR #1240)`
- (new web ui) Fix linkifying files `(PR #1236)`
- (new web ui) Make blob view readonly `(PR #1234)`
  - Prevents default browser shortcuts from modifying the file content locally.
- (new web ui) Prevent uncaught error when navigating back to file page `(PR #1199)`
- (new web ui) Show helpful message for root commit/change list page `(PR #1138)`
- (new web ui) Do not show loading spinner for empty commit ranges on compare page `(PR #1126)`
- (new web ui) Fix search aggregation styles `(PR #1125)`
- Exclude content filters from phrase boosting `(PR #1038)`
  - This fixes a bug where we would apply a phrase boost if a `content:` filter was specified with keyword search enabled. This led to inconsistent behavior (regexp vs keyword search) and it also rendered the `content:` filter ineffective, because we ran a general text search instead of a just a content search.
- (new web ui) 'File not found' when quickly navigating between files `(PR #959)`
- (new web ui) Blame view not visible for files that use `\r` as line separators `(PR #929)`
- (new web ui) Show settings link to site admins when repo error occurs `(PR #817)`

#### Sg

- Workaround dangling dev resources `(PR #1048)`

#### Source

- Correct Name() documentation for gitserver's ReadDirIterator `(PR #1278)`
  - The documentation for gitserver's ReadDir method has been clarified to reflect that the return iterator's Name() method returns the full path of the file, as opposed to just the basename.
- Multiple GitHub external accounts to the same URL now refresh correctly `(PR #1260)`
  - When there are multiple auth providers configured that point to the same GitHub URL, as can be the case when using private GitHub Apps, user external account tokens will now refresh correctly.
- Clarify exclude docs in github connection schema to say that individual expressions within block are `and`-ed together `(PR #1249)`
  - The documentation for the "exclude" section in the github code host connection schema has been clarified to explain that each block is OR'd together, and the expressions within each block are AND'd together.
- Fix Azure Devops OnPrem connection editing and repo name `(PR #1184)`
- The sync of a GitHub repositoryQuery failing will no longer cause repos to be deleted `(PR #1177)`
  - GitHub code host connections using `repositoryQuery` will no longer delete repositories if the sync fails for reasons like a GitHub outage or a token expiring.

#### Sourcegraphaccounts

- Use native openidconnect provider `(PR #1030)`

#### Telemetry

- Only log Cody API events to a remote data store, do nâ€¦ `(PR #1304)`

#### Telemetry-Gateway

- Fix configuration `(PR #1129)`

#### Tenant/Reconciler

- Avoid illegal state transitions `(PR #1133)`
- Double-check assigned instance ID `(PR #1092)`
- Try to audit log after tenant context creation `(PR #1051)`

#### Workspaces

- Build full redirect_to URL `(PR #1315)`
- Apply 'secure headers' to SPA `(PR #1313)`

#### Others

- Copy changes to prompt settings `(PR #1286)`
- Remove call to possibly nil error `(PR #973)`

### Chore

#### Ci

- Add TAG_DB_TEST to all go_tests that depends on dbtest `(PR #1288)`
- Add test task in workflows for dbtest to run on postgres 16 agents `(PR #1287)`
- Use bazel 7.4.0 `(PR #1284)`
- Nix - Update pg-utils for patch renames `(PR #1172)`
- Move //client/svelte:e2e_test to Integration/E2E_test step `(PR #1148)`
- Upgrade platform rules `(PR #1020)`
- Move rustfmt flags to ci bazelrc `(PR #1017)`
- Upgrade rules_ts and rules_js `(PR #1006)`
- Upgrade aspect rules swc `(PR #988)`
- Update rules rust v0.52.2 `(PR #985)`
- Set test label prefix for backcompat tests `(PR #984)`
- Upgrade rules_buf `(PR #974)`
- Skip check if author is sg teammate `(PR #969)`
- Bazel skylib 1.7.1 `(PR #936)`
- Upgrade rules_go, gazelle, buildifier_prebuilt & rules_proto `(PR #791)`

#### Code Intelligence

- Remove unused parameter `(PR #1204)`
- Rename flag -update -> -update-jobs-snapshots `(PR #1203)`
- Use HTTPError type in uploadhandler code paths `(PR #1174)`
- Remove unused parameters `(PR #1166)`
- Introduce new FileContentsMap type for clarity `(PR #828)`
- Use consistent casing for op strings `(PR #789)`
- Clarify state transitions in GetUsages `(PR #755)`

#### Database

- Remove residual event_logs export stuff `(PR #864)`
- Drop product_licenses and product_subscriptions `(PR #264)`

#### Database

- OOB migration for setting non-null columns via page `(PR #885)`
  - An out of band migration is introduced to set slowly set the value of a new column on all tables. If you have a large postgres database for Sourcegraph (1tb+) please ensure you deploy 5.9 instead of doing a multi-version upgrade past it.

#### Dev

- Use clearer names in health server initialization `(PR #1383)`
- Make syntactic-code-intel-worker config uniform `(PR #1382)`
- Enable metrics for precise-code-intel-worker in dev `(PR #1365)`
- Merge fileutil package into fsext `(PR #1351)`
- Migrate gitserver APIs from fs.FileInfo to fsext.FileInfo `(PR #1318)`
- Introduce new package with FileInfo type `(PR #1317)`
- Document footguns around escaping trace data writers `(PR #1291)`
- Rename errors.ErrCollector -> errors.Collector `(PR #1265)`
- Introduce new o11y-friendly RichError interface `(PR #1264)`
- Replace WithErrors -> With for simplicity `(PR #1261)`
- Generalize 'observation.With' for custom errors `(PR #1233)`

#### Gitserver

- Inline one-liner for error checking `(PR #1108)`

#### Msp

- Upgrade openfga dependency `(PR #1357)`

#### Mt-Router

- Disable proxy for s2 `(PR #1186)`
- Use bazel to run generator `(PR #1065)`
- Setup sentry for stage environment `(PR #1064)`
- Add scripts to interact with local kv `(PR #1056)`

#### Search

- (new web ui) Enable new web UI by default `(PR #1373)`
- Fix description for KUBERNETES_JOB_STEP_IMAGE `(PR #1360)`
- Remove all non-single job pod code from Executors on Kubernetes. `(PR #1163)`
  - The environment variable `KUBERNETES_SINGLE_JOB_STEP_IMAGE` is now `KUBERNETES_JOB_STEP_IMAGE`.
  - Both environment variables are read, with preference given to `KUBERNETES_JOB_STEP_IMAGE`, to preserve backward compatibility, but reading of `KUBERNETES_SINGLE_JOB_STEP_IMAGE` may be removed in a future version.
- (new web ui) Improve search input CSS `(PR #962)`

#### Security

- Update rules_apko and fix issues with sg wolfi v2 `(PR #901)`
  - Build containers using latest version of apko and rules_apko

#### Telemetry

- Report token usage per request to telemetry `(PR #1165)`
  - Added LLM token usage telemetry

#### Telemetrygatewayexporter

- Bump default TELEMETRY_GATEWAY_EXPORTER_EXPORT_INTERVAL `(PR #1303)`

#### Telemetrytest

- Add working example `(PR #1274)`

#### Others

- Fix storybook `(PR #1335)`
- Add searchSource to new search events `(PR #1306)`
- Make core-services internal/telemetry codeowners `(PR #1272)`
- Upgrade Mocha from 8.3.4 to ^10 `(PR #1246)`
- Move web app into child layout group to make room for embedded pages `(PR #1128)`
- Run prettier `(PR #906)`
- Upgrade hermetic cc toolchain `(PR #844)`
- Upgrade rules_oci `(PR #818)`

### Test

#### Others

- Implement structure for e2e tests `(PR #108)`

### Refactor

#### Cody-Gateway

- Support max_completion_tokens for o1 models `(PR #947)`
  - Refactor(cody-gateway): support max_completion_tokens for o1 models

#### Search

- (new web ui) Update folder page table styling `(PR #1221)`

#### Others

- Move all business logic out of context resolvers `(PR #821)`

### Reverts

- Revert filtering out deprecated models on server `(PR #1276)`

### Uncategorized

#### Others

- [Backport 5.9.x] oob: Run without tenant iterator for older versions `(PR #1429)`
- Release: Prep stitched migration graph for release (#1388) `(PR #1389)`
  - N/a
- Move cody.serverSideContext out of experimentalFeatures in site config `(PR #1385)`
- Bugfix: add key to search result file header `(PR #1374)`
- Gitserver: Parse LastChanged, LastFetched as nulltime `(PR #1372)`
- Add code llama 7B model for ab test `(PR #1371)`
  - Adding code llama 7B for completions
- Hide auto submit checkbox and add promoted badge `(PR #1367)`
- Enable reranker by default if Gateway is enabled `(PR #1366)`
  - Cody Chat: the context engine now uses the reranker by default everywhere where Cody Gateway is enabled.
- Db: Set default permissions to RLS user as well `(PR #1362)`
- Remove promote-to-public dependency on bazel-push-images step `(PR #1356)`
- Release: Only fail SBOM step if all uploads fail `(PR #1355)`
- Source: Fix code host connection editor validation `(PR #1354)`
- Bugfix: fix symbol tree hover selector `(PR #1353)`
- Dev: Exclude generated code from prettier `(PR #1341)`
- Prompt library: fix input description for prompt name `(PR #1337)`
- Workspaces: Various mini fixes and a landing page `(PR #1336)`
- Tenant: Fix gRPC in local dev `(PR #1334)`
- Reapply "worker: Fix configuration error reporting" `(PR #1311)`
- Search: document choice for ZoektScoreBoost `(PR #1310)`
- Bugfix: escape file paths `(PR #1308)`
- Change clickable elements to buttons `(PR #1298)`
- Allow users to insert chips according to cursor position `(PR #1296)`
- Change prompt creation flow feature flag name `(PR #1294)`
- Pass Context to scip-syntax invocation to propagate cancellation `(PR #1290)`
- Gomod: bump Zoekt for metrics improvement `(PR #1276)`
- Redis: rename RedisWrapper `(PR #1273)`
- Connectutil: UnexpectedError handler `(PR #1271)`
- Add recommended flag to Prompt Templates `(PR #1268)`
  - Adds ability to mark prompts as recommended and then sort the recommended prompts at the top.
- Bugfix: remove possibility of infinite recursion from the symbol tree `(PR #1256)`
- Update cody web to 0.10.0 `(PR #1254)`
- Bugfix: use short OID for file popover `(PR #1242)`
- Remove outdated install instructions for sg `(PR #1227)`
- Site: Fix missing unredaction in site config `(PR #1226)`
- Update the sg docs link `(PR #1225)`
- Multi-tenant: support synchronized user sign-out `(PR #1222)`
- Sg: Fix db reset with default local settings `(PR #1217)`
- Db: Improve error message for failed version update `(PR #1216)`
- Only push final images on specific default runtypes `(PR #1211)`
- OpenaI completions response type fixing for gpt-3.5-turbo-instruct and gpt-4o-mini `(PR #1207)`
- Sg: Always run with lower privileges in dev `(PR #1197)`
- Tenant: Deactivate OOB migrations `(PR #1192)`
- Update Enterprise footer link on dotcom `(PR #1191)`
- Bugfix: escape spaces in repo filter names `(PR #1187)`
  - Fixed a bug that would cause filters added from the search sidebar to not be correctly escaped
- Attempt to fix flaky database test `(PR #1181)`
- Chore/search - Remove runner.Spec.Image and use command.Spec.Image instead `(PR #1161)`
- Dev: Disable otel in MT dev `(PR #1157)`
- Bug(release): remove semver check for release branch in `sg backport`  `(PR #1156)`
- Make GetCodyContextAlternatives usable for evals `(PR #1152)`
- Multi-tenant: list workspaces for the authenticated user `(PR #1146)`
- Saml: Prevent logspam from context cancel `(PR #1143)`
- Sg: Update localdev migration `(PR #1132)`
- Tenant: Exclude product subscription tables from OOB migrator `(PR #1124)`
- Add prompt mode `(PR #1123)`
  - Adds mode (CHAT, EDIT, INSERT) to prompt.
- Gitserver: Clarify annotated tags behavior in ResolveRevision `(PR #1107)`
- Rate limit: rename GlobalLimiter to DistributedLimiter `(PR #1100)`
- Rate limit: make GlobalLimiter tenant-aware `(PR #1099)`
- Saml: Fix nil panic `(PR #1098)`
- Tenant: Disable migrator for ranking tables `(PR #1097)`
- Rate limit: avoid using KeyValue within GlobalLimiter `(PR #1082)`
- Rate limit: simplify inMemoryLimiter `(PR #1081)`
- Tenant: Use frozen schema for OOB migration `(PR #1077)`
- Make user emails soft-deletable `(PR #1071)`
- Fix prompt duplication name `(PR #1067)`
- Sg: Add no-open flag to workspaces create `(PR #1057)`
- Creating/Editing Prompts Re-design `(PR #1054)`
  - The prompt creation/edit page has been redesigned.
- GraphQL: remove anonymous rate limiter `(PR #1052)`
- Oob: Make out of band migration runner tenant-aware `(PR #1047)`
- Fix the CTA to point to chat `(PR #1044)`
- Fix bug where text pushed buttons out of the container `(PR #1043)`
- Dev: Implement wrangler router provider `(PR #1035)`
- Router: Ensure HTTPS protocol on auth redirect `(PR #1034)`
- Workspaces: Fix race condition registering state listener `(PR #1033)`
- Dev: Introduce devDNS helper to resolve testdomains `(PR #1029)`
- Add ability to duplicate existing prompts `(PR #1022)`
  - Users can now duplicate existing prompts.
- GraphQL: simplify rate limit interface `(PR #1021)`
- Add autoSubmit & includeViewerDrafts to Cody prompts `(PR #1003)`
  - Adds options to set prompts to "Auto Submit", which would automatically execute the prompts in one-click.
- Vsce: patch release v2.2.19 `(PR #1002)`
- Workspacesreconciler: fix grpc tls transport `(PR #1000)`
- Tenant: Move externalhttp to separate package `(PR #996)`
- Goroutine: reenable recording when multitenancy is enabled `(PR #995)`
- Rename globaldbtenant to servicetenant `(PR #994)`
- Ci/mt-router: add bazel build `(PR #990)`
- Search: populate rev in select repo `(PR #989)`
- Search: correct has.commit.after query example `(PR #987)`
- Mt-router: import repo `(PR #986)`
- Tenant: add mt-router to local dev `(PR #968)`
- Tenant: Remove tenant auth redirect in monolith `(PR #967)`
- Do not fail if link parsing fails in relative fix processing `(PR #966)`
- Dev/msp: improve tfc creation error message `(PR #964)`
- Goroutine: remove unused support for concurrency `(PR #963)`
- Ci: Bump backcompat test target to 5.8.0 `(PR #954)`
- Tenant: Mark tenant as initialized in db `(PR #950)`
- Bug(release): workspace cash time dance `(PR #948)`
- Tenant: Fix missing tenant in auth check `(PR #933)`
- Db: Use non-superuser in DB tests `(PR #930)`
- Db: Migrator can provision RLS user permissions `(PR #919)`
- Ci: Bump backcompat target to 5.7 `(PR #916)`
- Sg: Add default tenant to hosts `(PR #915)`
- Remove "Don't commit private code yet" from PR template `(PR #908)`
- "Prompt Library" in navbar (capitalize the L for consistency) `(PR #907)`
- Blob View: Ensure copy button copies full path and not displayed path `(PR #903)`
  - Fixes a bug where certain copy path buttons were only copying the visible path and not the full path of a file.
- Sg: Fix reference to deleted table in localdev MT migration `(PR #898)`
- Tenant: Separate store package and create tenant1, tenant2 via workspaces `(PR #897)`
- Tenant: skip some global Prometheus metrics `(PR #892)`
- Sg: Fix startup of workspaces service `(PR #891)`
- Ci: do not run executors e2e for eph `(PR #886)`
- Perforce IP enforcement integration test `(PR #876)`
- Goroutine: Make iterator required `(PR #875)`
- Dev/msp: add project id validation `(PR #874)`
- Db: Drop unused user_public_repos table `(PR #873)`
- Deprecate long-running OOB migrations `(PR #872)`
- Lib/cloudapi: add support for multi tenant mode `(PR #871)`
- Event_logs: add new `aggregatedMetrics` ping `(PR #869)`
- Redis: refactor rcache interface `(PR #860)`
- Add extra reranker metrics to Gateway events `(PR #838)`
- Sourcegraph teammate approval GH action `(PR #824)`
- Redis: remove KEYS call in completions token usage `(PR #820)`
- Tenant: Properly initialize RBAC `(PR #754)`
- Sg: Provision RLS user during setup `(PR #749)`
- Tenant: Add database migration to enable RLS policies `(PR #743)`
- Tenant: Add workspace ID and display name `(PR #741)`
- Tenant: Check that all tables have RLS policy set `(PR #734)`
- Tenant: Simplify dev migration `(PR #726)`
- Db: Mark tenant_id columns as non-nullable `(PR #707)`
- Feature: add internal/tracelog: a log.Logger that only logs if tracing is enabled `(PR #634)`
  - Added a new `internal/tracelog` package that provides a conditional logger for tracing. This logger only logs when tracing is enabled, improving performance by reducing unnecessary logging.
- Hackathon: SBOMs feat. bazel `(PR #566)`
  - Feature(security): Publish SBOMs for Sourcegraph releases
- Tenant: Unique constraint migration `(PR #430)`
- Security: Auto-update package lockfiles for Sourcegraph base images `(PR #246)`
- (feature): site-config: add ipParseCacheSize to schema for enforce IP restrictions schema `(PR #220)`
  - Added a new `ipParseCacheSize` configuration option for sub-repo permissions to control the caching of Perforce "Host" to IP address translations.
- Feature/source: implement core logic for parsing / evaluating Perforce IP addresses for sub repo permissions `(PR #46)`
  - For the Perforce IP permissions implementation, this PR introduces machinery that implements the ability to parse the [IP address expressions from the perforce protections table](https://www.perforce.com/manuals/p4sag/Content/P4SAG/protections.set.html#IP_address) and compare them against the user's IP address (that's advertised from the incoming X-FORWARDED-FOR header.Namely, this PR:
  - Introduced parsePerforceIPString, which parses Perforce IP strings (e.g., CIDR expressions, specific IP addresses) into an ipMatcher for IP validation.
  - Implemented multiple ipMatcher types, including:
    - AddrMatcher for exact IP matches.
    - CidrMatcher for checking IPs within a CIDR range.
    - AlwaysTrueMatcher for wildcard * Expressions.
  - Added toggleableIPMatcher, which either enables or disables IP enforcement based on site configuration settings.
  - Created matcherCache for caching recent IP string to ipMatcher translations, improving efficiency.
  - Updated NewRequestClientIPSource to properly derive IP from the x-forwarded-for header.
- Feature/site-config: add site configuration setting for enforcing IP restrictions `(PR #45)`
  - Added enforceIPRestrictions setting to the SubRepoPermissions section in site configuration, allowing IP-based enforcement using the X-FORWARDED-FOR header.Updated JSON schema to require SubRepoPermissions to be enabled when enforceIPRestrictions is enabled.Added validation in Perforce external service configuration to ensure IgnoreRulesWithHost and enforceIPRestrictions cannot be enabled simultaneously.Updated internal implementation to associate each Perforce rule with an IPMatcher for IP-based rule enforcement.
- Feature/plumbing: sub_repo_perms: do pumbling to thread comparing IP addresses alongside paths `(PR #23)`
  -

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Check for external dbs (#1083) `(PR #1121)`
- Bug(release): workspace cash time dance (#948) `(PR #949)`

{/* RSS={"version":"v5.9.0", "releasedAt": "2024-11-04"} */}



# 5.8 Patch 1

## v5.8.1579
- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.8.1579)
- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.8.1579)
- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.8.1579)
- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.8.1579)

### Features

#### Telemetry

- Check for external dbs (#1083) `(PR #1121)`

### Fix

#### Search

- Fix Apollo related error in Safari `(PR #1016)`

#### Others

- Fix OOB migration for batch changes table `(PR #1113)`

### Chore

#### Security

- Upgrade src-cli version to address CVE `(PR #1117)`
  - Upgrade src-cli version to 5.8.1 to address CVE-2024-24788, CVE-2024-24790, CVE-2024-34156 Backport b8da20f6fa148f30fe97d9267a536bd5a84502f1 from #1112

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- Backport 566 to 5.8.x: SBOMs with Bazel `(PR #1089)`
  - Feature(security): Publish SBOMs for Sourcegraph releases
- [Backport 5.8.x] Update src-cli MinimumVersion from 5.5.0 to 5.8.1 `(PR #1087)`
  - Chore(release): Update minimum supported version of src-cli to 5.8.1 Backport 8f039bdcb5425071dd6e4dfddfb2cb436e124b05 from #1079

{/* RSS={"version":"sourcegraph 5 Release 8 Patch 1", "releasedAt": "2024-10-16"} */}

# 5.8 Patch 0

## v5.8.0
- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.8.0)
- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.8.0)
- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.8.0)
- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.8.0)

### Features

#### Accessrequests

- Allow to file another request when original one has been processed `(PR #416)`

#### Appliance

- Refactor install flow, status, state, stage `(PR #352)`

#### Batch Changes

- Verbose error logging for batch syncer with BATCH_CHANGES_SYNCER_VERBOSE_ERROR_LOGGING `(PR #639)`
  - Feat(batches): verbose error logging for batch syncer with BATCH_CHANGES_SYNCER_VERBOSE_ERROR_LOGGING
- Add experimental feature to add a fork name suffix to avoid name collisions `(PR #230)`
  - Feat(batches): add experimental feature to add a fork name suffix to avoid name collisions

#### Ci

- Enable workflows telemetry `(PR #774)`
  - Enable aspect workflows ci telemetry
- Convert onconflict gen to bazel `(PR #486)`
  - Generate `constraints.go` using bazel for onconflict linter

#### Search

- (new web ui) Prefill search input with selected text when pressing '/' `(PR #577)`

#### Code Intelligence

- Updates the autoindexing images for TypeScript and Ruby `(PR #805)`
  - TypeScript: Fixes references to object properties in various places
  - Ruby: Fixes references to `Opus::` in Ruby tests
- Syntactic indexing go evaluation suite and fix tests on CI in general `(PR #482)`

#### Cody

- Update public OpenAPI spec `(PR #796)`
- Add basic support for server-rendered prompts `(PR #723)`
  - `/.api/completions/stream` endpoint now accepts `"file"` and `"repo"` parts alongside `"text"` and `"image_url"`
- Add vision support `(PR #546)``/.api/completions/stream` now supports vision using the OpenAI-compatible base64 encoding of images. Example `"content": [{"type": "image_url", "image_url": { "url": "data:image/png;base64,{{IMAGE_BASE64}}" } }]`. Requires the query parameter `api-version=3` or higher.
- Document internal APIs with TypeSpec/OpenAPI `(PR #505)`

#### Cody-Gateway

- Log requestinteraction in events `(PR #814)`

#### Database

- BestEffortForce will kill blocking transactions in migrator `(PR #781)`
  - DB Migrator is given the ability to automatically run pg_terminate_backend on transactions blocking a migration. This is done best effort and is opt-in per migration.

#### Dev

- (new web UI) Make it easier to run tests without proxying `(PR #798)`
- Add obvious 'target service' notice to `sg msp` commands `(PR #725)`

#### Local

- Add cody-gateway version endpoints `(PR #685)`
  - Add cody-gateway environments for subcommand `live`
- Sg - Install pgvector `(PR #520)`
  - Mac: install pgvector from sourcegraph/pgvector-12
  - Ubuntu: install postgresql-12-pgvector

#### Msp

- Make databasetest shared `(PR #393)`

#### Msp/Databaseutil

- Make 'upsert' package shared `(PR #394)`

#### Release

- Remove test from promotion ci during release pipeline `(PR #495)`
  - Remove upgradetest from the release promotion ci
- Stop releases from going out if there's a PR with the release-blocker label `(PR #472)`
  - Allow PRs to block a release from going out ðŸ˜ˆ
- Use releaseregistry for release banner [REL-145] `(PR #429)`
  - Implement using the release-registry for the banner

#### Search

- Bump Zoekt for ranking and memory improvements `(PR #816)`
  - Reduce peak memory required for Zoekt indexing
  - Improve search ranking by using repo freshness as a scoring signal
- (new web ui) Add split view support to commit page `(PR #775)`
- Enable similarity search by default `(PR #772)`
  - With this change we rank repository search results by similarity. Before, repository search results were ordered by star count instead. This affects suggestions and repository search results. To disable this feature and return to the previous behavior, set `{ "experimentalFeatures": { "disableOrderBySimilarity": true}}` in global settings.
- (new web ui) Add /cody/dashboard page `(PR #764)`
- (new web ui) Add account connection modal `(PR #731)`
- (new web ui) Image previews `(PR #623)`
- Respect match order for search.results.repositories resolver `(PR #575)`
  - The GraphQL endpoint `search.results.repositories` now returns the list of repositories in the order of the matches we
found. Before, repositories were sorted by id.
- Remove fzf star tiebreaker for repo suggestions `(PR #541)`
- Preserve ranking for repo suggestions `(PR #447)`
- (Svelte) open documentation links in new tabs `(PR #401)`
- Open documentation links in a new tab `(PR #359)`

#### Source

- Add ssh auth support for more code hosts `(PR #615)`
  - BitBucket Cloud, BitBucket Server,  GitLab, Gerrit, Gitolite, AWS CodeCommit Azure DevOps code host connections now support configuring SSH key authentication from the UI instead of mounting from disk.
- Add support for ssh auth to github `(PR #597)`
  - GitHub and generic Git code host connections now support configuring SSH key authentication from the UI instead of mounting from disk.
- Support Azure Devops Server (onPrem) with NTLM authentication `(PR #217)`

#### Tenant

- Allow configuring host instance id `(PR #826)`
- Add initial Workspaces reconciler `(PR #594)`

#### Wolfi

- Update server + postgresql-12 images `(PR #519)`
  - Add pgvector to server and postgresql-12 images
- Add pgvector-12 package `(PR #513)`
  - Build and add pgvector extension

#### Workspaces

- Implement integrations listworkspaces `(PR #794)`
- Implement management listworkspaces `(PR #793)`
- Delete workspace RPC `(PR #729)`
- Add DB list workspaces `(PR #728)`
- Add destroy state internally `(PR #644)`
- Init database schemas, add Workspaces store handler `(PR #395)`
- Add and demo notifications SDK `(PR #356)`

#### Others

- Add reranker support to Cody Gateway `(PR #670)`
- Embeddings: v2 `(PR #507)`
  - Introduce a new experimental embeddings index and context retriever.
- Make scip-syntax process multiple languages in a single invocation `(PR #364)`
- Add OpenAI o1 models and early-access models support to Cody Gateway `(PR #323)`
  - [feat(code gateway): add support for OpenAI o1 models and early-access models handling.](feat: add OpenAI o1 models and early-access models support to Cody Gateway)
- Implements pagination for syntactic usages `(PR #310)`

### Fix

#### Batch Changes

- Stamp the executor binary with version information `(PR #665)`
  - Override `internal/version.version` with `x_defs` at build time in executor
- Disabled "select all" checkbox if all nodes are already disabled `(PR #483)`
  - Fix(batches): disabled "select all" checkbox if all nodes are already disabled

#### Ci

- Add runfile initialization to upgradetest file `(PR #890)`
- Use generated json in migrations filegroup `(PR #802)`

#### Search

- (new web ui) Show correct document highlights when codegraph data is available `(PR #620)`
- 'Save search' action on search results page does not navigate to the saved search creation page `(PR #549)`

#### Code Intelligence

- Correctly escape special characters in repo names and identifiers `(PR #710)`
  - The new usagesForSymbol API correctly searches repos whose names contain spaces or other special characters.
- Use multiple language: filters for search-based usages in case of ambiguity `(PR #708)`
- Cleanup button title `(PR #581)`
- Fetch tags for scip-go auto-indexing jobs `(PR #371)`
  - Go cross-repo navigation for tagged versions should work better when using scip-go for auto-indexing. Navigation based on SCIP indexes generated using scip-go in CI or cron jobs should be unaffected.

#### Cody

- Return client-side model config via API `(PR #713)`
- Disable ModelAPIEnabled for Dotcom `(PR #678)`
  - `modelsAPIEnabled` is always false for dotcom
- Allow accuracy category in JSON site config `(PR #641)`
- Use "balanced" instead of "accuracy" category for SOTA models `(PR #640)`
- Allow empty `finish_reason` in `/.api/llm/chat/completions` `(PR #539)`
  - The `/.api/llm/chat/completions` endpoint will now return an empty string `""` for `finish_reason` instead of the string `"unknown_please_report_bug()"`.

#### Database

- Use native UUID in telemetry export queue `(PR #669)`

#### Database

- Correctly find CreateIndexConcurrentlyPhases in migrator `(PR #809)`
  - INFO logs for migrations that create index concurrently will always correctly report the phase we are in. Previously we sometimes would report a phase of -1.

#### Dev

- Use 9002 for pubsubemulator, simplify shutdown `(PR #780)`
- Give pubsub pings a more generous timeout locally `(PR #732)`
- Use key value for PGDSN in SAMS, EP `(PR #689)`

#### Graph

- Prevent duplicate results when performing find references `(PR #497)`

#### Local

- Add no-xattrs when running schema descriptions target locally `(PR #905)`
- Sg - Return the error when checking for remote branch/commits `(PR #485)`
  - Dump more information out about the branch if it is out of sync

#### Release

- Remove embeddings from promotion script (#360) `(PR #361)`
  - Remove embeddings in promotion script

#### Sams-Notifications

- Make subscriber tenant-aware `(PR #668)`

#### Search

- (new web UI) Fix cody dashboard background colors in dark mode `(PR #845)`
- (new web ui) Fix list styles in rich text documents `(PR #835)`
- (new web ui) Fix styling of rich text documents `(PR #834)`
- (new web ui) Show added lines content `(PR #832)`
- Fix client-side query validation for rev: filters `(PR #810)`
  - We have updated the client-side query validation to allow combining `rev:` filters with query-based search contexts.
- (new web ui) Clicking 'Code search' in then navbar of the old UI does not redirect to the new UI `(PR #761)`
- (new web ui) Use a Map to group symbol names `(PR #721)`
- VSCode Search extension: Update bug-reporting URL `(PR #693)`
- VSCode Search extension: fix and improve proxy settings `(PR #679)`
- In search jobs, don't time out fetches `(PR #666)`
  - For very large repositories, search jobs could time out while fetching the repository. Now, search jobs can fetch and search over repositories, even if they take a long time to fetch.
- (new web ui) Use CodeGraph data to validate hover occurence `(PR #656)`
- (new web ui) User menu feature parity `(PR #628)`
- Add index for search jobs janitor `(PR #624)`
  - We added a new database index to speed up a janitor job which is run as part of Search Jobs. Before, the janitor job might have significantly delayed migrations during an upgrade.
- (new web ui) Respect 'experimentalFeatures.structuralSearch' setting `(PR #621)`
- VSCode Search extension forgetting endpoint URL and PAT `(PR #560)`
- Fix logo links in the VSCode Search extension `(PR #547)`
- Update help router for local development `(PR #271)`

#### Sg

- Config.GetEnv uses GetEnv for os.Expand `(PR #380)`

#### Sg/Msp

- Make embed template fmt-compliant, add docstring `(PR #412)`

#### Telemetry

- Ensure telemetry export only occurs once at a time `(PR #565)`
  - Fix an issue where duplicate telemetry can be exported when the `worker` service is scaled horizontally

#### Tenant

- Prevent race condition in MockEnforceTenant `(PR #837)`
- Stop Iterate if it breaks `(PR #387)`

#### Test

- Make workspaces waitforupdate test more reliable `(PR #813)`

#### Others

- Make rerank metric name distinguishable `(PR #846)`
- Use correct label in splitting metric in embeddings indexing `(PR #771)`
- Add rerank API token variable to sg.config.yaml `(PR #716)`
- Adjust formatting when using unix sockets `(PR #653)`
  - Fix PGDATASOURCE format when using unix sockets
- Move deletion inside nil check `(PR #556)`
- Incrementally updating embeddings index `(PR #555)`
- Decrease parallelism in embeddings indexing `(PR #543)`
- Filter out empty context items in resolver `(PR #537)`
- VIP user access to allowed models in Cody Gateway `(PR #528)`
- Properly escape email in URL query `(PR #426)`
- Use preferred mermaid APIs `(PR #397)`
  - Fixes a bug that can cause errors when rendering many mermaid diagrams on a page.

### Chore

#### All

- Use constraint names in ON CONFLICT statements `(PR #473)`

#### Batch Changes

- Add description for env var `(PR #652)`

#### Ci

- Remove stale CODENOTIFY entries `(PR #439)`
- Bump Go to 1.23.1 `(PR #391)`
- Update gomod lint `(PR #382)`
  - Remove lint that checks  for promotheus/common 0.32.1 since we are using 0.48
- Upgrade golang.org/x/tools to 0.24 `(PR #373)`
  - Address printf linter flagged issues
- Add annotation for no merge base `(PR #345)`
  - Post an annotation if there is no merge base

#### Code Intelligence

- Bump autoindexing image SHAs `(PR #831)`
  - Upgrades default auto-indexing images to the latest versions (1) scip-go to v0.1.21 (2) scip-typescript to v0.3.14
- Initialize test to consistent state `(PR #825)`
- Unify GetUsages logic at Service level `(PR #752)`
- Unify local phase usage extraction logic `(PR #748)`
- Document code nav logic & limitations `(PR #742)`
- Factor out & document package mentions code `(PR #740)`
- Bump autoindexing image SHAs `(PR #681)`
  - Upgrades the default scip-go auto-indexing image to v0.1.20
- Log number of paths in auto-inference logic `(PR #635)`
- Add context to timeout error for commit listing `(PR #607)`
- Clarify doc comment for NewCanonicalDocument `(PR #480)`
- Document scip.Document and range canonicalization code `(PR #459)`
- Split inverted ranges extraction code & add comments `(PR #458)`
- Use UploadRelPath instead of string `(PR #438)`
- Bump auto-indexing image SHAs `(PR #403)`
  - Bumps default auto-indexing scip-go image to use Go 1.23.1 and scip-go v0.1.19

#### Cody

- Add HTTP record/replay test case for AWS Bedrock backend `(PR #452)`
- Add HTTP record/replay test case for Anthropic LLM backend `(PR #448)`
- Add HTTP record/replay test case for Azure OpenAI `(PR #446)`
- Add HTTP record/replay test case for OpenAI LLM backend `(PR #445)`
- Add HTTP record/replay test case for Fireworks LLM backend `(PR #441)`
- Add HTTP record/replay test case for Google LLM backend `(PR #410)`

#### Database

- Set app.current_tenant outside of multitenant `(PR #502)`

#### Database

- Remove unused redis_key_value table `(PR #688)`
- Update oobmigration min version to 4.0 `(PR #540)`
- GetRepositoriesForIndexScanQuery uses constraint `(PR #534)`
- Handle failed transactions in setTenant `(PR #533)`
- Use new constraints for on conflict `(PR #510)`
- Constraint for unique indexes used in on conflict `(PR #504)`

#### Dev

- Bump Go version to 1.23.2 `(PR #830)`

#### Frontend

- Sync.Once to sync.OnceValue in service connections `(PR #376)`

#### Gomod

- Update zoekt's dependencies `(PR #462)`

#### Local

- Fix ill-formed go.mod file `(PR #434)`
- Update sg installation docs `(PR #390)`

#### Release

- Prepare stitch graph for 5.8 `(PR #852)`
  -  Backport 6b58d4b62bba8f558c097fa97a751e51b178c537 from #850

#### Release

- Clarify backport error `(PR #784)`

#### Reranker

- Clean up resolvers, improve perf, add more useful spans `(PR #776)`

#### Search

- (new web ui) Add telemetry for opt-out/in `(PR #766)`
- Remove codeintel ranking code `(PR #719)`
- Remove cursor based repo pagination `(PR #663)`
- VSCode Search extension: remove "SOURCEGRAPH SEARCH" stutter in favor of "Info" `(PR #559)`
- Update wording from "Sourcegraph extension" to "Sourcegraph Search extension" `(PR #558)`

#### Semgrep

- Add upload artifact step `(PR #616)`

#### Sg

- Remove enforce-tenant-id --disable `(PR #705)`

#### Tenant

- Restructure tenant package into internal subpackages `(PR #587)`

#### Trace

- Prevent parallel calls to ConfigureStaticTracerProvider `(PR #467)`

#### Others

- Enable reranker by default `(PR #804)`
  - Reranker for context retrieval is turned on by default
- Disable IDF jobs `(PR #783)`
- Clean up visible uploads initialization `(PR #739)`
- Rename gatherLocations -> gatherUsages `(PR #737)`
- Cleanup metadata generation code in Gateway `(PR #714)`
- Remove unused endpoints from 969 prototype `(PR #712)`
- Trigger changelog audit on label event `(PR #562)`

### Refactor

#### Svelte

- Introduce extensible GraphQL store `(PR #309)`

#### Others

- Move cody context business logic outside of resolvers `(PR #647)`
- Remove search mode `(PR #629)`
- Rename NonLocal -> Global in scip_strict parser `(PR #366)`

### Reverts

- Revert "pgdsn: Allow to fall back to default variables and overwrite â€¦ `(PR #369)`

### Uncategorized

#### Others

- Bug(release): workspace cash time dance (#948) `(PR #949)`
- [Backport 5.8.x] tenant: Improve OOB migration from learnings `(PR #939)`
- [Backport 5.8.x] Revert "migrator: Backfill IDs from overrides into right schema only" `(PR #914)`
- [Backport 5.8.x] migrator: Backfill IDs from overrides into right schema only `(PR #894)`
- [Backport 5.8.x] Revert "fix(migration-graph): add no op migration to backfill overrides" `(PR #888)`
- [Backport 5.8.x] Update lockfiles with newer version of apko `(PR #882)`
  -  Backport 7f2c3bacf6778fef5f2ef444db2ebd873903c5e6 from #881
- [Backport 5.8.x] Revert "Update rules_apko and fix issues with `sg wolfi` (#696)" `(PR #880)`
- [Backport 5.8.x] db: Bump date for schema migrations stitch date `(PR #878)`
- Tenant: OOB migrator covers more tables `(PR #842)`
- Tenant: Default to ID 1 for inserts `(PR #840)`
- Migrator: Correctly render indexing progress `(PR #812)`
- Adding code qwen 2p5 and deepseek long prompt optimized model `(PR #811)`
  - Adding code qwen 2p5 and deepseek long prompt optimized model `(PR #811)`
- Security: Update docker dind to latest release `(PR #808)`
- Saml: Record requests `(PR #788)`
- Saml: Return error instead of appending to it `(PR #787)`
- Add password for sourcegraph-rls `(PR #786)`
- Cmd/workspaces: setup routes during ws creation `(PR #782)`
- Db: Fix missing globaldbtenant `(PR #779)`
- Trace: Fix span pollution in authenticateByCookie `(PR #753)`
- Sg: Make sure sourcegraph_rls user also has permissions on future tables `(PR #750)`
- Tenant: Fix license check missing tenant `(PR #747)`
- Migration: Skip CREATE TABLE if possible `(PR #746)`
- Tenant: Fix more tenant-less contexts `(PR #745)`
- Tenant: Mark tenants tables as data tables `(PR #738)`
- Feat(Cody Reranker): clean up site config and add license-based auth for Cody Gateway `(PR #724)`
- Sg: Fix go generate `(PR #722)`
- Tenant/db: Safer ordering of migration statements `(PR #718)`
- Gitserver: Fix some missing tenant contexts `(PR #717)`
- Refactor(cody gateway): update model list for autocompletes `(PR #711)`
- Db: Add tenant_id to last remaining columns `(PR #709)`
- Db: Add OOB migration to backfill tenant ID `(PR #706)`
- Tenant: pass correct context to SetCloneStatus `(PR #701)`
- Sg: Reject empty workspace names `(PR #700)`
- Sg: Fix enforce-tenant-id after redis_key_value was dropped `(PR #697)`
- Update rules_apko and fix issues with `sg wolfi` `(PR #696)`
- Redis: don't check tenant for system commands `(PR #695)`
- Tenant: only skip goroutine recording if tenancy is enabled `(PR #694)`
- Search jobs: set high timeout to protect against stuck jobs `(PR #692)`
- Tenant: fix remaining goroutine recorder errors `(PR #691)`
- Reapply "feat(cody): add vision support (#546)" (#686) `(PR #687)`
- Add detailed intent-score pairs to chat intent response `(PR #682)`
- Jsm/disable model api `(PR #680)`
- Site admin: simplify goroutine recording `(PR #677)`
- Update client/vscode/CHANGELOG.md for PR #560 `(PR #676)`
- Tenant: Mapper returns more precise error `(PR #675)`
- Tenant: add missing IteratorFactory `(PR #674)`
- Tenant: Make migrations on startup pass in local dev `(PR #667)`
- Msp: report error when PGDSN does not have expected template variable `(PR #664)`
- Final ranker config for context v2 `(PR #659)`
  - Changing the ranker configuration -- Number of items fetched from zoekt
- Sg: Make enforce-tenant-id idempotent again `(PR #655)`
- Refactor(cody gateway): add deprecated models back to dotcom model list `(PR #649)`
- Gomod: bump Zoekt for memory debugging `(PR #646)`
- Dev: ensure multi-tenant migration has been run `(PR #645)`
- Refactor(cody gateway): update dotcom models list `(PR #643)`
  - Cody Gateway: update default model list for dotcom.
- Bump Cody Web to 0.9.0 version `(PR #642)`
- Sg cloud eph deploy:  --wait flag `(PR #637)`
- Executors: Check for rows affected instead of running into unique constraint error `(PR #632)`
- Symbols: hide scary error messages from users `(PR #631)`
- Add postgres as datasource for Grafana `(PR #627)`
- Add time to first token for upstream as header `(PR #618)`
- Workspaces: implement `managementv1.UpdateWorkspaceMembership` RPC `(PR #613)`
- Ci: add cloud ephemeral pipeline `(PR #611)`
- Add sourcegraph ranker `(PR #610)`
- Workspaces: implement GetWorkspaceMembership rpc `(PR #609)`
- Workspaces: implement `ReportInstanceState` RPC `(PR #604)`
- Workspaces: implement `ListWorkspaceMemberships` RPC `(PR #603)`
- Tenant: Add method to create a new tenant in database `(PR #593)`
- Workspaces: support []iam.Role in WorkspaceMembership `(PR #590)`
- Cody Web: bump cody web to 0.8.3 `(PR #589)`
- Cody context: fix bug in 'archived' change `(PR #588)`
- Workspaces: Add WorkspaceState to GetWorkspace rpc `(PR #585)`
- Tenant: Add support for reading tenant by hostname from database instead of hard-coded `(PR #580)`
- Workspaces: implement user `CreateWorkspace` API `(PR #574)`
- Workspaces: implement GetWorkspace RPC `(PR #573)`
- Gomod: bump Zoekt for indexing memory optimization (again) `(PR #572)`
- Use direct routing by default if present in the backend `(PR #571)`
- Workspaces: database get/upsert instances `(PR #568)`
- Workspaces: implement `ReportWorkspaceState` RPC `(PR #564)`
- Gomod: bump Zoekt for indexing memory optimization `(PR #557)`
- Bump Cody Web to 0.8.2 version `(PR #545)`
- Clean up rerankers for Cody Context `(PR #544)`
- Sg(tenant): Add migration for constraints to local dev `(PR #542)`
- Rockskip: use full ctx from emitIndexRequest `(PR #532)`
- Add billing metadata for core search, batch, and insights events `(PR #529)`
- Cody context: support archived and forked repos `(PR #527)`
- Vsce: patch release v2.2.18 `(PR #526)`
- Fix context v2 zoekt subqueries `(PR #523)`
- Repo-updater: continue start-up if hydration fails `(PR #521)`
- Cody Web: bump cody web to 0.8.1 `(PR #518)`
- Cody-gateway: do not PING Redis too often `(PR #517)`
- Rockskip: Remove another duplicative BTREE index `(PR #516)`
- Rockskip: Remove duplicative BTREE index `(PR #515)`
- Db(tenant): lock between setTenant and exec to ensure session variable is set atomically `(PR #512)`
- Perf: reduce allocations in `evalKeywordExpansions` `(PR #506)`
- Local/nix: add pgvector extension `(PR #503)`
  - Enable pgvector in nix managed postgres db
- Redispool: allow call sites to custmoize their `TestOnBorrow` and `Dial` `(PR #499)`
- Cody-gateway: wait for Redis connection `(PR #498)`
- Cody-gateway: set `MaxActive` for Redis `(PR #496)`
- Bump Cody Web to 0.8.0 version `(PR #492)`
- Recorder: remove RegistrationDone method `(PR #489)`
- Repo-updater: add tenancy `(PR #479)`
- Tenant: Basic support in worker `(PR #476)`
- Cody context: return matched ranges of chunks `(PR #474)`
- Add(cody): `api-version=2` for incremental streaming LLM responses `(PR #470)`
  - The `/.api/completions/stream` endpoint now accepts an `api-version=2` query parameter that returns incremental text text responses when using `"stream": true` to improve performance and reduce bandwidth.
- Remove Neovim from Cody dashboard `(PR #469)`
- Fix flaky test by bringing down memory utilization of POS filter `(PR #468)`
- Msp/iam: fixup checks for `ErrNoRows` `(PR #465)`
- Gomod: bump Zoekt for zoekt-git-index profiling `(PR #453)`
- Worker: Make resetter a periodic goroutine `(PR #450)`
- Gomod: bump Zoekt for index optimization `(PR #449)`
- Http: Add context to more requests `(PR #437)`
- Conf: Remove alias for ExternalURL `(PR #436)`
- Frontend: Drop unused orgs_open_beta_stats table `(PR #435)`
- Msp/iam: do not close connection pool on startup `(PR #433)`
- Filter out terms based on POS and expand Zoekt queries `(PR #432)`
- Authn: Create providers on the fly with current request context `(PR #424)`
- Tenant: Use request context when creating OIDC provider `(PR #422)`
- Redis: Add optional tenant isolation `(PR #421)`
- Tenant: Add context to LogBackendEvent `(PR #420)`
- Remove debug log statement `(PR #418)`
- Minor doc change `(PR #413)`
- Sg: Use custom site-config for multitenant runset `(PR #405)`
- Retrieve and display change log during upgrades. `(PR #400)`
  - [Appliance] Retrieve live changelog and display information about the release to be upgraded.
- Svelte: fix text wrapping for file popover `(PR #399)`
  - Fixed a bug in the web app rewrite where long paths would cause file popovers to wrap
- Svelte: fix loading for ref panel `(PR #398)`
  - Fix loading behavior for the reference panel in the web app rewrite
- Gomod: bump Zoekt for index optimization `(PR #389)`
- Svelte: SymbolTree followups `(PR #388)`
- Repo-updater: hack so it uses tenant 1 for now `(PR #386)`
- Gitserver: inherit tenant for repoUpdateOrClone `(PR #385)`
- Chore: close rows `(PR #379)`
- Database: use keyword value format if connecting via unix socket `(PR #378)`
- Frontend: always use DSN from ServiceConnections `(PR #375)`
- Reapply "pgdsn: Allow to fall back to default variables and overwrite..." `(PR #374)`
- Postgresdsn: support PGHOST as a filepath `(PR #372)`
- Release: specifiy download directory for changelog `(PR #365)`
  - Specify download directory for changelog
- Frontend: Don't double-close readiness channel during auto upgrades `(PR #358)`
- Workspaces: initial IAM schema and implement `iam.Store` `(PR #353)`
- Enterprise-portal: implement `iam.Store` and add tests `(PR #351)`
- Enterprise-portal: create `internal/iam` package and run schema tests in CI `(PR #350)`
- Tenant: Add tenants 1 and 2 in localdev `(PR #340)`
- Sg: Introduce first multitenant runset `(PR #335)`
- Pgdsn: Allow to fall back to default variables and overwrite frontend `(PR #332)`
- Remove k8s utils dependency `(PR #320)`
- Msp/iam: fixup migration PG 12 compatibility and sanity test migrations `(PR #301)`
- Tree-sitter based chunker for embeddings indexing `(PR #298)`
- Context: return multiple chunks per file from Zoekt results `(PR #294)`
  - We can improve recall by fetching multiple chunks per file from Zoekt results by turning on the `cody-reranker` feature flag.
- Add(cody): `api-version=2` incremental streaming LLM response `(PR #293)`
  - The `/.api/completions/stream` endpoint now accepts an `api-version=2` query parameter that returns incremental text text responses when using `"stream": true` to improve performance and reduce bandwidth.
- Context: improve ranker integration + loosen the tap `(PR #291)`
  - Ranker for chat context is now available behind `use-reranker` feature flag.
- Hook Upgrade page to Release Registry API `(PR #276)`
- Move IDF repository stats into Postgres and compute them with the background worker `(PR #270)`
- Svelte: add symbol tree `(PR #209)`
  - Adds a symbol tree to file page in the experimental webapp
- Redis: respect context when connecting `(PR #194)`
- Appliance Admin UI `(PR #168)`
  - [Appliance]: Adds the upgrade path for the Appliance Admin UX

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Remove the other embedding reference `(PR #362)`
  - N/a

{/* RSS={"version":"v5.8.0", "releasedAt": "2024-10-08"} */}

# 5.7 Patch 1

## v5.7.2474
- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.7.2474)
- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.7.2474)
- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.7.2474)
- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.7.2474)

### Fix

#### Batch Changes

- Workaround for a bug in GitHub `(PR #584)`
  - Fix(batches): workaround for a bug in GitHub
  Backport aad3a04f8c93561a61c404e69132e70a22d0acba from #576

#### Release

- Remove the other embedding reference `(PR #362)`
  - N/a

#### Search

- Remove query expansion `(PR #586)`
  - This fixes a bug where we added &quot;readme&quot; too often to the context.    Backport 28ff196a663f537c6cb6340f976a91431509a90e from #582

### Reverts

  There were no reverts for this release

### Uncategorized

#### Others

- [Backport 5.7.x] Search: allow queries with only lang filters `(PR #583)`

{/* RSS={"version":"v5.7.2474", "releasedAt": "2024-09-18"} */}

# 5.7 Patch 0

## v5.7.0
- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.7.0)
- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.7.0)
- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.7.0)
- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.7.0)

### Features

#### Appliance

- Enable frontend form and stub out, no backend routes yet `(PR #80)`

#### Batch Changes

- Add a container registry deny list `(PR #109)`
  - Add a container registry deny list to complement the allow list.
  - Configure in site config via `"batchChanges.containerRegistryDenylist"`.
  - Mutually exclusive with `"batchChanges.containerRegistryAllowlist"`.
- Add support for registry allowlist `(PR #105)`
  - Add support to configure container registry allowlist for containers use from batch changes via `batchChanges.containerRegistryAllowlist` in Site Configuration.

#### Cody

- Add `/.api/cody/context` API `(PR #66)`
  - New `POST /.api/cody/context` REST endpoint to retrieve a list of relevant source locations given a natural language query.

#### Dotcom

- Add account ID in subscriptions list view `(PR #192)`
- Forward license check to Enterprise Portal `(PR #19)`

#### Enterpriseportal

- Use file-based migrations with `goose` `(PR #216)`
- Add Salesforce Account ID `(PR #176)`
- Internal instances record detected instance `(PR #139)`
- Return unknown license as result `(PR #134)`

#### Licensecheck

- Check against Enterprise Portal directly `(PR #22)`

#### Msp/Runtime

- Standardised migrations `(PR #242)`
- First-class redis support `(PR #241)`

#### Releases

- Scoped releases `(PR #33)`
  - Feat(release): scoped releases

#### Sg

- MSP database migrations with `goose` `(PR #215)`

#### Site Admin

- Monitoring/telemetry: add v1 teestore write alerts and v2 export queue write alerts `(PR #321)`

#### Svelte

- Add repository sync status indicator to search results `(PR #260)`
- Sentry: Ignore errors from third party scripts `(PR #171)`
- Add status notifications `(PR #141)`
- Add support for indent-based code folding `(PR #75)`

#### Telemetry/Sensitivemetadataallowlist

- Allow string list and nulls `(PR #27)`

#### Others

- Syntactic support for go `(PR #328)`

### Fix

#### Batch Changes

- Omit headRepositoryId if empty `(PR #200)`
- Avoid "Name already exists on this account" from creating fork by fetching the repo when the error happens `(PR #159)`
  - Fix(batches): avoid "Name already exists on this account" from creating fork by fetching the repo when the error happens

#### Code Intelligence

- Ensure syntactic worker marks itself as "ready" on startup `(PR #341)`

#### Code Nav

- Return ALL references in the same file as the definition `(PR #240)`

#### Cody

- Correctly parse queries containing 'or' `(PR #267)`
  - Fixes a regression in Cody context where questions containing the word 'or' could return noisy or no results.
- Use reverse proxy for Gemini API `(PR #208)`
- Address critical bug from code review `(PR #179)`
- Return valid `finish_reason` in `/.api/llm/chat/completions` `(PR #154)`
  - LLM API `/.api/chat/completions` now returns OpenAI-compatible `finish_reason`.
- Fix error handling in LLM API `(PR #153)`
  - LLM API endpoints (`/.api/llm`) now return JSON-encoded HTTP bodies for non-200 status codes.
- Use `testdata` instead of `golly-recordings` directory name `(PR #152)`
- Give names to LLM API handlers `(PR #151)`
- Allow `Bearer TOKEN` header for all LLM APIs `(PR #150)`
  - For compatibility with OpenAI clients, it's possible to use `Bearer TOKEN` header with all API endpoints that start with the prefix `/.api/llm`.
- Deepseek-coder-v2-lite-base model name mapping for dotcom users `(PR #135)`

#### Cody-Gateway

- Ignore schema errors on otel init `(PR #237)`

#### Enterpriseportal

- Normalize instance domain on create subscription `(PR #163)`
- Add subscription ID to trace, other diagnostics improvements `(PR #130)`

#### Enterpriseportal/E2e

- Fix test case for check license `(PR #162)`

#### Frontend

- Do not sign-out users when accessing a file path containing /login `(PR #57)`

#### Local

- Check for rogue files and folders in svelte routes `(PR #337)`
  - Prevent `web-sveltekit` commands from running if there are untracked files under src/routes
- Expand _after_ accumulating the whole env `(PR #257)`

#### Oobmigration

- Remove migrations targeting licenses/subscriptions `(PR #263)`

#### Repo-Updater

- Add WARN level logs every time we sync a code host `(PR #44)`
  - Repo-updater now emits logs that log the result of every code host sync.

#### Sams-Notifications

- Mockrequire.Values incorrectly used `(PR #315)`

#### Search

- Skip if git diff not found in hybrid `(PR #333)`
  - When searching an unindexed commit we would consult indexed commits for speeding up results. If our index contained a commit that no longer existed in git we would error out due to a regression in v5.4.5099. This is now fixed.
- Add "Create batch change" back to Actions dropdown in search results `(PR #143)`

#### Sg

- Make start commands cancel fn be sync.OnceFunc `(PR #319)`
  - The cancel funcs used by sg commands are now wrapped in `sync.OnceFunc` to prevent duplicate execution
- Add deprecation notice to sg wolfi update-hashes `(PR #289)`
  - Sg: fix panic when using `wolfi update-hashes`
  - Sg: add deprecation notice for `wolfi update-hashes`
- Check if we are ephemeral before getting lease time `(PR #256)`
  - Sg - Fix panic in Cloud Ephemeral listing when listing instances that are not Ephemeral
- Clamp deployment name consistently in cloud ephemeral `(PR #117)`
  - Ensure deployment / instance names are clamped in all places for cloud ephemeral
- Implement env priority to improve env var ordering `(PR #31)`

#### Svelte

- Preserve history panel scroll position after selecting an entry `(PR #251)`
- Update existing query filters when including suggested filters `(PR #115)`
- Remove 'Code Ownership' top navigation `(PR #87)`
- Update main navigation to match React app `(PR #74)`
- Fix regex generation for routes that contain parameters `(PR #73)`
- Fix Bazel production build `(PR #43)`
- Workaround for handling client-side redirections in production `(PR #14)`

#### Others

- Switch to larger runner for scip-go jobs `(PR #221)`
- Add deepseek virtual model string `(PR #211)`
- Set webRoot to /client/web in launch.json `(PR #83)`
- Speed up auto-index job expiration query `(PR #3)`

### Chore

#### Dotcom

- Fix typo in subscriptions page `(PR #195)`
- Delete subscriptions, licensing, and cody gateway usage `(PR #21)`

#### Dotcom/Subscriptions

- Minor UX tweaks `(PR #175)`

#### Embedding

- Delete cmd/embeddings `(PR #181)`

#### Enterpriseportal

- Declare required scopes in schema and use schema-based enforcement `(PR #305)`
- Add Cody Access override case to manual E2E tests `(PR #224)`
- Improve formatting of duplicate usage message `(PR #177)`
- Remove dotcomdb connection and testing infra `(PR #20)`

#### Gomod

- Update for a bunch of CVEs `(PR #343)`

#### Local

- Stop using deprecated `docker-compose` command `(PR #206)`

#### Pubsub

- Upgrade to disable OpenTelemetry tracing `(PR #210)`

#### Pubsubemulator

- Init tool `(PR #272)`

#### Release

- Simplify changelog download in release `(PR #227)`
  - Simplify `changelog` cli download by using `gh` cli

#### Search

- Tell EditorConfig to stop messing with snapshot files `(PR #275)`
- Remove Beta label from code monitors webhooks option. `(PR #274)`

#### Search-Jobs

- Deprecate experimental site setting `(PR #122)`
  - The site setting `experimentalFeatures.searchJobs` is not read anymore. To disable Search Jobs, set `DISABLE_SEARCH_JOBS=true` for the "frontend" and "worker" services.
- Remove EXPERIMENTAL from gql API `(PR #116)`
- Remove beta badge `(PR #114)`

#### Svelte

- Upgrade dependencies and cleanup configs `(PR #279)`
- Fix type import `(PR #277)`
- Reduce build log noise `(PR #252)`
- Ingore 'RepoNotFoundError's in Sentry `(PR #113)`

#### Tenant

- Iterate does not enforce no tenant unlike Inherit `(PR #334)`

#### Tooling

- Bump Go to 1.23.0 `(PR #126)`

#### Wofli

- Update images `(PR #290)`
  - Update images to use latest p4-fusion binary

#### Workspaces

- Define initial Workspaces proto schemas `(PR #262)`
- Stub service and directory `(PR #244)`

#### Others

- Fix onUserRolesChanged `has SiteAdmin role` test name `(PR #314)`
- Update github.com/openfga/openfga to v1.6.0 `(PR #295)`
- Updates Rust toolchain to 1.80.1 `(PR #287)`
- Re-enable SCIP uploads to Demo `(PR #222)`
- Create github action for changelog audit `(PR #198)`
- Undo unneeded upgrades `(PR #164)`
- Upgrade sourcegraph-accounts-sdk-go version `(PR #160)`
- Simplify semaphore-based code using conc.Iterator `(PR #146)`
- Bump autoindexing image SHAs `(PR #131)`
- Migrate httpserver to use sg/log `(PR #112)`
  - Update httpserver to use sourcegraph/log instead of log15
- Updates tree-sitter version `(PR #93)`
- Delete a bunch of unused LSIF-related code `(PR #77)`
- Clean up CODENOTIFY for Joe `(PR #28)`

### Refactor

#### Svelte

- Make repo page integration test setups reusable `(PR #249)`
- Refactor temporary settings to remove Apollo dependency `(PR #156)`
- Lazy load mermaid `(PR #16)`

### Reverts

- Revert reverse proxy usage to access Gemini API `(PR #236)`

### Uncategorized

#### Others

- Bump Cody Web to 0.7.7 version `(PR #347)`
- Bug: fix slice init length `(PR #339)`
- Add migration to create sourcegraph_rls user in local dev `(PR #331)`
- Add tenant1 and tenant2 hostnames to caddy setup `(PR #330)`
- Deglobalize SiteID `(PR #329)`
- Gomod: bump zoekt for indexing observability improvements `(PR #327)`
- Searcher: check for zoekt empty repo commit in hybrid search `(PR #326)`
- Conf: do not log missing tenant `(PR #318)`
- Database: introduce globaldbtenant package `(PR #317)`
- Database: rm unused Transact, Done, ShareableStore from ConfStore `(PR #316)`
- [perforce] Store label cache file in .p4home `(PR #308)`
- Convert trivial chunk/batching functions to use slices.Chunk `(PR #307)`
- Bump cody web to 0.7.6 `(PR #304)`
- Handle error case where anthropic api returns an empty response `(PR #303)`
- Msp/iam: use runtime standardized migrations mechanism `(PR #300)`
- Frontend: update permissions runs per tenant `(PR #299)`
- Tenant: avoid FromContext logging in Inherit `(PR #297)`
- Validation: pass in ctx for validateAuthzProviders `(PR #296)`
- Siteadmin: Make recoverUsers idempotent `(PR #292)`
  - The recoverUsers endpoint failed with a spurious error when some of the given users were already active. It is now idempotent.
- Remove (old friend) storm project `(PR #286)`
- All: skip slow tests when -short `(PR #284)`
- Licensing: fix flaky uses of MockGetConfiguredProductLicenseInfo `(PR #283)`
- Gitserver: fix RemoveBadRefs on darwin `(PR #280)`
- Cody Web: Remove old cody web logic `(PR #273)`
- Move package `(PR #269)`
- Add unit test for idf index `(PR #268)`
- Worker: fix flake in repo syncer test `(PR #266)`
- Clean unused flag `(PR #265)`
- Bump own and repos test timeouts to long `(PR #258)`
- Upgrade SCIM package to allow Microsoft Entra string values `(PR #253)`
- Add(cody): support for Sonnet 3.5 "fast edit" model `(PR #250)`
- Enable route outside Site Admin into Appliance service. `(PR #247)`
- Add common access token for direct routing `(PR #245)`
- Redis: pass context through remaining methods `(PR #239)`
- Bump Cody Web to 0.7.3 for react version `(PR #238)`
- Dev: remove compare-hash.sh `(PR #234)`
- Doc: update search links for monorepo to be on s2 `(PR #233)`
- Change the default model from starcoder to deepseek `(PR #232)`
- Database: capture missing tenant for queries `(PR #231)`
- Goroutine: support tenants `(PR #229)`
- Rearrange auth provider middlewares `(PR #228)`
- Add option to cache label data with p4-fusion `(PR #225)`
  - Perforce connections now support a `cacheLabels` option to cache Perforce label data from the server, speeding up consecutive syncs on systems with a large number of labels.
- Lib/cloudapi: introduce features config `(PR #223)`
- Lib/cloudapi: add auth pkg `(PR #214)`
- Shortcut noop `(PR #213)`
- Dev/msp: expose more runtime values to gotmpl `(PR #212)`
- Worker: add OnUserRolesUpdated SAMS notification handler `(PR #204)`
- Tenant: use marshal method instead of strconv `(PR #203)`
- [fix] Perforce auth provider panics when only IP is provided `(PR #199)`
- Redis: pass context to hash and ttl methods `(PR #196)`
- Redis: introduce KeyValue.Info() `(PR #193)`
- Respect context in Stop methods `(PR #191)`
- Telemetry: wait for v1 writes in tests on teestore `(PR #190)`
- Tenant: factor out marshalling `(PR #189)`
- Allow AWS tokens in the repository `(PR #188)`
  -
- Tenant: prevent parallel test runs when mocking enforcement `(PR #187)`
- Configure and activate Admin UI `(PR #186)`
  - [Appliance] Activate appliance updates on Code Search admin UI
- Sg: skip dev-private check if OFFLINE set `(PR #185)`
- Updating owner tag `(PR #183)`
- Security: Ensure sourcegraph will run with uid randomisation `(PR #182)`
- Tenant: add context to gitserver's filesystem interface `(PR #178)`
- Change re-ranking method from public to private `(PR #173)`
- Web: encode file path for blame `(PR #172)`
  - Fixes an issue that would cause blame view to fail on files that contain some special characters.
- Fix main lint `(PR #169)`
  - [Fix] code linting
- Redis: add context to httpcache and rcache `(PR #167)`
- Fixing the limit text for autocompletes `(PR #166)`
- Bug: Fix file/directory popover regression `(PR #165)`
  - Fix File and directory popovers in the file tree when code search is scoped to a perforce depot.
- Ci/srcgql-compat: fix workflow `(PR #161)`
- Guardrails: temporary cache for incident `(PR #158)`
- Security: Remove root from some containers, and make it clearer which containers run as root `(PR #157)`
- Update site.schema.json `(PR #155)`
- All: update OWNERS and CODENOTIFY to match new team names `(PR #148)`
- Migrations: remove read on pg_attribute for tenant_id `(PR #147)`
- Cody Web: Update cody web to 0.7.1 `(PR #144)`
- Dev/cloud-relay: add msp delivery target for rollout `(PR #142)`
- Cody Web: fix cody web in svelte safari `(PR #138)`
- Instrument request latency in Cody Gateway `(PR #136)`
- Dev/cloud-relay: import repo `(PR #132)`
- All: upgrade staticcheck and unparam `(PR #128)`
- Cody Web: Update cody web to 0.6.1 (svelte and react) `(PR #127)`
- Ci/cloud-gql-compat: only report error on remote workflow failure `(PR #125)`
- Add perforce support for git references table and labels `(PR #124)`
  - Code Search now supports labels for Perforce Depots
- Iterator: add Map function `(PR #123)`
- Symbols: skip rockskipintegration on dev if missing binaries `(PR #121)`
- Syntactic-indexing: skip tests on dev if scip-syntax is missing `(PR #120)`
- Keyring: t.Parallel safe MockDefault `(PR #119)`
- Appliance: inject os.Getenv to ensure clean environment `(PR #118)`
- Db: add event_logs_export_allowlist and own_signal_configurations to DataTables `(PR #111)`
- Expand special case handlers for context endpoint `(PR #110)`
- More context improvements `(PR #104)`
- Adding cohere reRanker in the cody context `(PR #102)`
- Don't use markdown header symbols in graphql docs `(PR #99)`
- Appliance: check ShouldRunSetupEnvTests in integrationtest `(PR #97)`
- Fix hardcoded version number in security release approval message `(PR #96)`
- Blobstore: support tenant isolation `(PR #94)`
- Make syntactic indexing policies non exclusive to precise indexing `(PR #92)`
- Add --build flag to `sg cloud ephemeral upgrade` `(PR #91)`
- Turn off minification for cody web worker `(PR #90)`
- Redis: add context arg for list methods `(PR #89)`
- Basic custom context handler `(PR #86)`
- Security: Auto-update package lockfiles for Sourcegraph base images `(PR #85)`
- React: Bump Cody Web to 0.5.1 `(PR #79)`
- Lib/cloudapi: restructure pkg to reduce nesting `(PR #68)`
- Nix flake update to go 1.23 `(PR #62)`
- Nix: local is a string for GOTOOLCHAIN `(PR #61)`
- Sg CLI: Use correct pipeline when retrieving annotations `(PR #60)`
- Security: Auto-update package lockfiles for Sourcegraph base images `(PR #56)`
- Nix: set GOTOOLCHAIN=local `(PR #55)`
- Search: improve indexing delay dashboards `(PR #54)`
- Telemetry: always best-effort write to v1 store `(PR #53)`
- Database: limit concurrent event log inserts `(PR #52)`
- Only commits in policy commitmap `(PR #49)`
- Lib/cloudapi: import cloud-api proto def `(PR #40)`
- Ctags/6.1.0 package update `(PR #38)`
- Redis_exporter/1.62.0 package update `(PR #37)`
- Docker-client/27.1.2 package update `(PR #36)`
- P4-fusion/1.13 package update `(PR #35)`
- Jaeger/1.60.0 package update `(PR #34)`
- [Stream API]: Add external_service_type field to the SearchedRepo type `(PR #32)`
  - Searched repo, commit, path, symbol and file match responses will now include external service type.
-  Directory mentions: extract and test buildKeywordQuery `(PR #30)`
- Lib/background: fix flaky test of monitor routines with context cancel `(PR #29)`
- Direct route for fireworks models `(PR #26)`
- Repos: use passed in ctx for SystemsInfo `(PR #18)`
- Removing featureflag for expanded audit logs `(PR #15)`
  - More auditlogs for sensitive admin actions will be automatically logged.
- Perforce UI Elements: Add perforce UI elements to history panel `(PR #12)`
- Add typescript parser for SCIP symbols `(PR #10)`
- Migrations: run squash targetting v5.3.0 `(PR #9)`

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:

- Support SAST Scanning with both GHAS and Custom post processing scripâ€¦ `(PR #67)`
  - Sast scans are reported without any issues
- Added better GHAS check (#64537) `(PR #65)`
  - Chore(security): Fix GHAS check as non-zero exit code

{/* RSS={"version":"v5.7.0", "releasedAt": "2024-09-04"} */}

# 5.6 Patch 2

## v5.6.2535
- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.6.2535)
- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.6.2535)
- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.6.2535)
- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.6.2535)

{/* RSS={"version":"v5.6.2535", "releasedAt": "2024-08-22"} */}

### Chore


#### Security

- Security: added better GHAS check (#64537) `(PR #65)`
  - Chore(security): Fix GHAS check as non-zero exit code

### Uncategorized

- Support SAST Scanning with both GHAS and Custom post processing scripâ€¦ `(PR #67)`
  - Sast scans are reported without any issues
- [Backport 5.6.x] fix(search): fix query parsing bug around quoted phrases #59 `(PR #70)`
- [Backport 5.6.x] fix(batches): fix broken forking workflow `(PR #81)`fix(batches): fix broken forking workflow
  Backport f833c4a3bf2210c127ffbf1146be69e1f461a449 from #48
- [Backport 5.6.x] svelte: add slash to path scope `(PR #98)`
  - Fixes a bug in the new web app that causes incorrect links to be generated for collapsed file names
 Backport 23dad06bb2af1e7eb6a2f3847ad7f2c76c2a89a5 from #95
- [Backport 5.6.x] feat(cody): add deepseek-coder-v2-lite-base support `(PR #103)` Backport f71fe081aa43ca40fef66c067c8eaf49d62d491e from #4
- Backporting #106 `(PR #107)`

# 5.6 Patch 1

## v5.6.185
- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.6.185)
- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.6.185)
- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.6.185)
- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.6.185)

{/* RSS={"version":"v5.6.185", "releasedAt": "2024-08-08"} */}

### Uncategorized

- [Backport 5.6.x] Changing azureUseDeprecatedCompletionsAPIForOldModels to default to true [#64371](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64371) Backport 3b16059588e5eff69e00ed56a489ac8560a70d8e from #64347
- [Backport 5.6.x] Fix Cody Web CSS [#64373](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64373)
  - Make Cody Web styles more accessible.  Backport 2dd38b3ffd828a1596249c2780ca91bf4bce4bdd from #64370

# 5.6 Patch 0

## v5.6.0
- [sourcegraph](https://github.com/sourcegraph/sourcegraph/releases/tag/v5.6.0)
- [docker-compose](https://github.com/sourcegraph/deploy-sourcegraph-docker/releases/tag/v5.6.0)
- [helm](https://github.com/sourcegraph/deploy-sourcegraph-helm/releases/tag/v5.6.0)
- [kustomize](https://github.com/sourcegraph/deploy-sourcegraph-k8s/releases/tag/v5.6.0)

{/* RSS={"version":"v5.6.0", "releasedAt": "2024-08-07"} */}

### Feature

#### Codenav

- Codenav: Add symbol support for the Hack language [#64015](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64015)

#### Frontend

- Frontend: do not embed frontend assets anymore [#63946](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63946)
  - Frontend: assets are no longer bundled with binary through `go:embed`. Instead assets are now added to the frontend container at `assets-dist`.

#### Local

- Local: sg tail  [#64146](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64146)
  - Adds a new `sg tail` command that provides a better UI to tail and filter log messages from `sg start --tail`.

#### Appliance

- Appliance: implement re-direct on all unknown endpoints [#64059](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64059)
  - Feat(appliance): implement re-direct on all unknown endpoints
- Appliance: Adopt Frontend Service + Ingress [#63893](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63893)
  - Feat(appliance): Appliance adopts Frontend's `Ingress` + `Service`
- Appliance: Merge unstructured objects from helm serialization and appliance cfg defaults [#64021](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64021)
  - Feat/appliance: Include existing objects when constructing Frontend's `Service` & `Ingress`
- Appliance: self-update [#63780](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63780)
  - Appliance can automatically self-update up to 2 minor revisions beyond the currently-deployed sourcegraph version.
- Appliance: introduce mock up database configuration step in install flow [#64162](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64162)
- Appliance: self-update can update multiple deployments [#64132](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64132)
- Appliance: Frontend Pulls Version Info from RelReg [#64089](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64089)
  - Feat(appliance): frontend pulls versions from relreg
- Appliance: Change site-admin updates button to point to Appliance based on env var [#64167](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64167)
  - Feat(appliance): change update endpoint based on env var
  - Misc: add type to storybook

#### Enterpriseportal

- Enterpriseportal: db layer for cody gateway access [#63737](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63737)
- Enterpriseportal: support DevOnly in list subscriptions [#63837](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63837)
- Enterpriseportal: db layer for subscription licenses [#63792](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63792)
- Enterpriseportal: db layer for subscription conditions [#63812](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63812)
- Enterpriseportal: ignore context cancellation error in GetCodyGatewayUsage [#64016](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64016)

#### Search

- Search: remove smart search logic [#64215](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64215)Smart search is no longer supported in the Sourcegraph backend. Old searches that specify 'smart search' mode will be run in the default 'precise' mode. If your query now doesn't behave as expected, you can update it to use the new `patterntype:keyword`.
- Search: update Zoekt [#64238](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64238)
  - Added support for all Apex language extensions
  - Shard merging for Zoekt is now enabled by default. This reduces MEM requirements for Zoekt webserver and improves performance for some queries. See our [documentation](https://sourcegraph.com/docs/admin/search#shard-merging) for more information.
- Search: Add support to all Apex language extensions [#64194](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64194)
- Search: Enable improved symbol parsing for large repos (when using Rockskip) [#63988](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63988)

#### Svelte

- Svelte: Improve commit page layout on mobile [#63920](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63920)
- Svelte: Change branch and tags page design, including mobile [#63914](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63914)
- Svelte: Add support for creating search jobs from search results [#64308](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64308)
- Svelte: Improve small screeen behavior [#63859](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63859)
- Svelte: Add compare page [#63850](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63850)
- Svelte: Add search query syntax introduction [#63753](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63753)
- Svelte: Add 'y' shortcut to navigate to permalink  [#63719](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63719)

#### Dotcom

- Dotcom: use Enterprise Portal for Cody Gateway usage [#63653](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63653)

#### Build

- Build: Add exhaustruct linter (codeintel POC) [#63965](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63965)

#### Others

- Add support for precise usagesForSymbol [#64126](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64126)
  - Adds support for precise code navigation to the experimental `usagesForSymbol` API,
which can be used to implement a reference panel or similar functionality.
- Order search filters alphabetically [#63976](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63976)
- Show current email during password reset and auto-populate text-box after successful completion [#59645](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59645)

#### Bazel

- Bazel: read binary version info from accompanying files in OCI images instead of stamping //internal/version [#63977](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63977)

#### Sg

- Sg: prototype 'sg start sourcegraph-accounts' [#63894](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63894)
- Sg: add 'sg sams client create' [#63885](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63885)
  - `sg sams client create` can now be used to create IdP clients for SAMS.
- Sg: support correct completions on 'sg start -cmd' [#63861](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63861)
  - Completions for `sg start -cmd` now offer valid suggestions.
- Sg: report user os information via analytics [#64280](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64280)
- Sg: do not persist external secrets [#63890](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63890)
- Sg: allow sg commands to default to local-dev SAMS-dev credentials [#63883](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63883)
  - `sg` commands requiring SAMS client credentials now load shared SAMS-dev client credentials by default.

#### Cody

- Cody: Refactor completions API to use new modelconfig (support more models) [#63797](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63797)Update the Cody APIs for chat or code completions to use the "new style" model configuration. This allows for great flexibility in configuring LLM providers and exposing new models, but also allows Cody Enterprise users to select different models for chats.This will warrant a longer, more detailed changelog entry for the patch release next week. As this unlocks many other exciting features.
- Cody: add circuit breaker to handle timed-out requests and rate limit hits [#64133](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64133)

#### Requestclient

- Requestclient: propagate original User-Agent as X-Forwarded-For-User-Agent [#64113](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64113)

### Fix


#### Appliance

- Appliance: don't include is_development builds in list of versions [#64138](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64138)
  - Fix(appliance): don't allow installation of development builds
- Appliance: Make Appliance URL envvars strings [#64227](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64227)
  - Fix(appliance): make environment variables strings to be passed around

#### Own

- Own: Prevent infinite UI update loop in own pages [#64312](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64312)

#### Docs

- Docs: update quickstart guide links [#64202](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64202)

#### Cody

- Cody: use client-provided timeout for completions requests [#63875](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63875)
  - Use the provided timeout from request parameters if available; otherwise use the default maximum request duration (8 minutes)
- Cody: allow pre-release versions for clients [#63913](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63913)
- Cody: remove client check for context filters [#63855](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63855)

#### Search

- Search: correctly handle select:symbol.enum [#64170](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64170)Fix a bug in `select:symbol.enum` filters where they returned no results

#### Bazel

- Bazel: surface error message when gazelle cant process glob expression [#64214](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64214)

#### Search_jobs

- Search_jobs: prevent job state flip-flopping between 'queued' and 'processing' [#64098](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64098)
- Search_jobs: remove trailing `*` from URL [#63821](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63821)
- Search_jobs: progress reporting [#64287](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64287)
  - Show detailed progress only while job is in status "processing"
  - Remove dependency of download links on job state
- Search_jobs: fail validation for repo searches [#64300](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64300)
- Search_jobs: flickering placeholder component [#64009](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64009)

#### Enterpriseportal

- Enterpriseportal: drop old gorm fk constraints [#63864](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63864)

#### Svelte

- Svelte: Properly redirect to cody marketing page [#64331](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64331)
- Svelte: Make /cody/dashboard work with the new web app [#64295](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64295)
- Svelte: Show correct line numbers in unified diff [#63778](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63778)
- Svelte: Fix and cleanup compare page [#63928](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63928)
- Svelte: Update top-level route list [#64272](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64272)
- Svelte: Ctrl+backspace in fuzzy finder [#63804](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63804)
- Svelte: respect default pattern type in toggles [#63795](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63795)
- Svelte: Better preloading in file tree [#64327](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64327)
- Svelte: Center file tree loading indicator [#64309](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64309)

#### Ci

- Ci: reduce push_all concurrency even further due to ratelimits [#64111](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64111)
- Ci: check command out for error when git fails [#63993](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63993)
- Ci: reduce push_all concurrency due to ratelimits [#64106](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64106)
- Ci: only emit bazel execlog artifact for 'test' commands [#63916](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63916)

#### Release

- Release: check for marker in container files instead of binary [#64205](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64205)
  - Release: check contiainer directory `/assets-dist` for marker instead of frontend binary


#### Sg

- Sg: cloud ephemeral - Do no trigger builds on main-dry-run [#64190](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64190)
  - Sg: deny deployment of `main-dry-run` branches on Cloud Ephemeral.
- Sg: better err msg for when we fail to insert to bigquery [#63873](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63873)
  - Sg: provide a better error message when we fail to insert into bigquery
  - Sg: stop puslishing to bigquery if we get 3 errors in a row
- Sg: do not try to publish analytics when it is disabled [#63800](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63800)
  - Sg - Only start the analytics background publisher when analytics are enabled
- Sg: return different error types depending on secret failure [#63779](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63779)
- Sg: provide suggestions we fail to get local gcp account email address [#64325](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64325)sg - Provide steps a user can follow if we fail to get the local gcp email address
- Sg: acknowledge command execution state to avoid recursion when executing short running commands [#64181](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64181)

#### Batches

- Batches: switch github app installation handling from redirect flow to webhooks [#64036](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64036)
  - When installing a GitHub app for batch changes, the instance now waits for a callback from GitHub to complete the installation to avoid issues from eventual consistency.
- Batches: don't request unnecessary info that's likely to cause GH errors [#64299](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64299)
  - Fix(batches): improve GitHub Apps integration reliability by simplifying the data requested from GitHub
- Batches: show warning instead of error when the changeset status is not FAILED [#64243](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64243)
  - Batch changes that are still retrying now show a warning instead of an error.

#### Others

- Try workaround for bad index choice when updating execution logs [#64328](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64328)
- Block URLs without a hostname [#64248](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64248)
- Uses the same base64 for decoding we use for encoding the UsageCursor [#64290](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64290)
- Don't propagate un-translated source ranges [#64263](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64263)
- Handle sub-repo permissions in CodeGraphData API [#64241](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64241)
- Fixes incorrect highlighting for comments at the start of a file [#64235](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64235)Fixes incorrect syntax highlighting when a comment is present at the start of a file.
- Connection pending alert and alert content alignment [#64120](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64120)
- Set timeout for web-sveltekit/unit_tests to moderate [#63879](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63879)
- Add Exists method to dbworker Store to avoid COUNT(*) [#64297](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64297)
- Prefer SCIP uploads over LSIF uploads [#64217](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64217)Fixes a bug where old LSIF uploads would also be used for code
navigation even when newer SCIP uploads were available for the
same language, potentially leading to duplicate results in the reference
panel. With this change, scip-go uploads shadow the uploads
for lsif-go, and similarly for other indexers following the scip-X/lsif-X naming
convention.
- Synchronize access to reads of fields in retry test [#63967](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63967)
- Add extra check for code intelligence inference [#64083](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64083)
- De-dup and concurrent-ify file content requests & splitting [#64169](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64169)
- Handle potential nil reference properly [#64265](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64265)
- Add commit signing filter to `credentialForGitHubAppExists` [#64128](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64128)
- Make invalid token error message visible while adding external services [#60876](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60876)

#### Telemetry

- Telemetry: silence invalid events that we already know about [#64084](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64084)

### Chore


#### Others

- Mark flaky web-sveltekit tests as manual [#63874](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63874)
- Frontend does not need disk [#64273](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64273)
- Make return type more obvious [#63651](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63651)
- Update main occurrence extraction code to allow for symbol-based matching [#64082](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64082)
- Rename Index -> AutoIndexJob [#63955](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63955)
- Reduce frequency of COUNT(*) on lsif_indexes [#64288](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64288)
- Bump version of sourcegraph/log library [#64233](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64233)
- Remove cmd/frontend/external/app [#64054](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64054)
- Remove redis init side-effect of app.NewHandler [#64062](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64062)
- Don't pass nil context [#64055](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64055)
- Move codenav types to lower-level package [#64141](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64141)
- Replace 'dumps' terminology in comments [#63775](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63775)
- Change some APIs to use symbols instead of monikers [#64029](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64029)
- Rename uploadstore packages for clarity [#63931](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63931)
- Remove incorrectly logged warning [#64267](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64267)
- Use binary search over symbols array [#64240](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64240)
- De-duplicate CTE for visible uploads [#64232](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64232)
- Remove unused loghandlers package [#64067](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64067)
- Move internal/conf/validation to cmd/frontend [#64064](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64064)
- Init userpasswd provider where we initialize every other authn provider [#64061](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64061)
- Remove flaky flag from svelte e2e_test [#64123](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64123)
- Mark flaky test as manual [#63968](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63968)
- Factor out sub-query for locating nearest uploads [#64210](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64210)
- Remove global externalURL watcher [#64058](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64058)
- Re-enable e2e tests for web-sveltekit [#63910](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63910)
- Replace QueuedCount -> CountByState with bitset parameter [#64302](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64302)
- Deglobalize oneclickexporter instance [#64066](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64066)
- Make location fetching queries more uniform [#64026](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64026)
- Document tech debt wrt multiple doc traversals [#64006](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64006)
- Unify LsifStore.*SymbolUsages APIs into one [#64076](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64076)
- Add docs for RepoStore methods [#64283](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64283)
- Rename URI -> DocumentPath [#63979](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63979)
- Remove unused TTL in object.Storage config [#63947](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63947)
- Move cmd/frontend/webhooks to cmd/frontend/internal [#64157](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64157)
- Rename type Bytes -> Size [#64183](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64183)
- Unconditionally call endObservation [#64150](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64150)
- Move internal/highlight to cmd/frontend [#64065](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64065)
- Bubble precise Usages instead of Locations [#64118](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64118)
- Switch over to fake RepoStore in codenav tests [#64284](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64284)
- Move internal/suspiciousnames to cmd/frontend/internal [#64071](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64071)
- Simplify license routines [#64068](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64068)
- Use Option type and rename API [#63820](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63820)
- Bump autoindexing image SHAs [#63801](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63801)
- Move and clean up test code for syntactic usages [#64318](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64318)
- Remove unnecessary _ imports [#64158](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64158)
- Remove cmd/frontend/external redirection package [#64070](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64070)
- Consolidate mocks for dbworker/store.Store type [#64294](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64294)
- Consolidate mocks for uploads's Store type [#64286](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64286)
- Move cmd/frontend/oneclickexport to cmd/frontend/internal/oneclickexport [#64069](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64069)
- Move authn into cmd/frontend [#63648](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63648)GitLab code host connections were [able to sync permissions by mapping Sourcegraph users to GitLab users via the username property of an external OIDC or SAML provider](https://sourcegraph.com/docs/admin/code_hosts/gitlab#administrator-sudo-level-access-token) that is shared across Sourcegraph and GitLab. This integration stopped working a long time ago, and it has been removed in this release.
- Replace calls to deprecated ioutil.TempFile [#64177](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64177)

#### Svelte

- Svelte: Add manual entries for repo sub pages to development proxy [#64313](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64313)
- Svelte: Disable tests which time out [#63844](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63844)
- Svelte: Refactor infinity query implementation [#63824](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63824)
- Svelte: fix test by removing duplicate aria-label [#63942](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63942)
- Svelte: Commit/diff style and behavior tweaks [#63785](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63785)
- Svelte: Refactor repo loaders [#63828](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63828)
- Svelte: Clean up dependencies [#63777](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63777)

#### Enterpriseportal

- Enterpriseportal: rewrite subscriptions API tests to be table-driven [#63831](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63831)
- Enterpriseportal: simplify display_name constraint [#63835](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63835)

#### Telemetrygateway

- Telemetrygateway: gracefully handle sams introspectToken cancelation [#63809](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63809)

#### Bazel

- Bazel: re-enable remote caching of Copy&#123File,Directory,ToDirectory&#125 actions [#64153](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64153)
- Bazel: emit json profile for image push jobs [#64188](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64188)
- Bazel: rework push_all to improve concurrency by avoiding bazel server lock (round 2) [#64079](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64079)
- Bazel: emit json profile for image push jobs (properly) [#64189](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64189)
- Bazel: disable stamping on rust_binary targets [#64007](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64007)

#### Config

- Config: clarify env var already registered panic [#63784](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63784)
  - When conflicting env var are detected, print the two to ease debugging.

#### Executors

- Executors: Native Kubernetes Executors default to use single job pod [#64088](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64088)

#### Codeintel

- Codeintel: Derive TargetPathWithoutRoot dynamically [#63986](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63986)
- Codeintel: Move mock generation near interface package [#64000](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64000)
- Codeintel: Simplify code using upload filtering [#63997](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63997)
- Codeintel: Pass UsageKind instead of raw column names [#64003](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64003)
- Codeintel: replaces lsp.Range uses with scip.Range [#64178](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64178)
- Codeintel: Rename local variables for clarity [#63983](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63983)
- Codeintel: Move RequestState construction to separate func [#63998](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63998)
- Codeintel: Rename uploads/../Store -> codegraph/../DataStore [#64001](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64001)

#### Search

- Search: update search API call sites to set the version explicitly [#63782](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63782)
- Search: update logging of search durations [#64269](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64269)

#### Local

- Local: clear ambiguity in between sg version|live [#64122](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64122)
  - `sg version` explicitly mentions that it's the CLI version that's printed out, not any instance version.
- Local: use //cmd/frontend:frontend_nobundle for bazel commandsets [#64085](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64085)

#### Search_jobs

- Search_jobs: add janitor job [#64186](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64186)The new background job drastically reduces the size of the `exhaustive_*` tables and improves performance of the Search Jobs GQL API.
- Search_jobs: improve description on main page [#63992](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63992)
- Search_jobs: remove label "admin" from contact card [#63823](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63823)

#### Cody

- Cody: allow setting "cody.contextFilters" in site config without feature flag [#63881](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63881)

#### Frontend

- Frontend: use explicit cache for admin analytics [#64077](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64077)

#### Worker

- Worker: move aggregated user stats job to worker [#64033](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64033)
- Worker: disable jobs based on ENVs [#63853](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63853)
- Worker: move event_logs janitor routines to worker [#63981](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63981)
- Worker: move llm token counter to worker [#64008](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64008)
- Worker: move refreshAnalyticsCache to worker [#64041](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64041)

#### Log

- Log: remove use of log15 in ghe-feeder [#64131](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64131)

#### Ci

- Ci: emit execlog for image push jobs [#64130](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64130)

#### Sg

- Sg: remove 'sg telemetry' and related docs [#63763](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63763)
  - `sg`: the deprecated `sg telemetry` command for allowlisting export of V1 telemetry from Cloud instances has been removed. Use telemetry V2 instead.
- Sg: clean up help formatting [#63860](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63860)

### Ci


#### Others

- Add cloud controller gql compat test [#64092](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64092)
- Automatic retry push images job at least 1 [#64145](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64145)

### Perf


#### Others

- Find syntactic matches concurrently [#63937](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63937)

### Refactor


#### Github

- Github: Have a dedicated PublicRepository type [#63607](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63607)

#### Codeintel

- Codeintel: Extracts a MappedIndex abstraction over uploads [#63781](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63781)

#### Others

- Steps the usage cursor provenance state in a single place [#64321](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64321)
- Handles Cursor uniformly over all usage provenances [#64319](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64319)
- Renames usage cursor and adds fields for future syntactic cursor [#64208](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64208)

#### Svelte

- Svelte: Reduce logo complexity [#64274](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64274)

### Reverts

- Revert "Cody: add support for neovim, cody-cli, eclipse, and visualstudio clients [#63854](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63854)
- Revert "chore(ci): post instructions for PR sections in a comment" [#64176](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64187)

### Uncategorized

- Feat(code insights): language stats speed improvements by using archive loading [#62946](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62946)
  - Language stats queries now request one archive from gitserver instead of individual file requests. This leads to a huge performance improvement. Even extra large repositories like chromium are now able to compute within one minute. Previously they timed out.
- Various improvements to saved searches [#63539](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63539)
  - Improved the saved searches feature, which lets you save search queries to easily reuse them later and share them with other people in an organization.
  - Added the ability to transfer ownership of a saved search to a user's organizations or from an organization to a user's account.
  - Removed a long-deprecated and ineffective settings `search.savedQueries` field. You can manage saved searches in a user's or organization's profile area (e.g., at `/user/searches`).
- Correctly re-map source ranges in new SCIP-based APIs [#63630](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63630)
- Move internal/session into cmd/frontend/internal [#63649](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63649)
- Subrepo: More explicitly define supported hosts [#63650](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63650)
- Licensecheck: Make proper goroutine [#63655](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63655)
- Remove old reference to env var that no longer exists [#63656](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63656)
- Schema: Remove unused extension schema file [#63657](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63657)
- Dotcom: Remove dotcom on-by-default Cloudflare trust mode [#63658](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63658)
- Webhooks: Polish UI components [#63664](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63664)
- Webhooks: Deterministically match webhook events to repos [#63668](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63668)
- Gating: Add individual switches for disabling tools features [#63686](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63686)
- Svelte: implement new reference panel against new Usages API [#63724](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63724)
- Usages API: implement surroundingContent [#63730](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63730)
- Authz: Drop requirement for installing authz providers in every service [#63743](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63743)
- Make pagination hooks store filter & query params in URL, not just pagination params [#63744](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63744)
- Update comment and decode bytes instead [#63754](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63754)
- Svelte: some unrelated cleanups [#63757](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63757)
- Fix/internal/txemail: add timeout for SMTP connection establishment [#63759](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63759)
  - Instead of waiting forever, we wait at most 30 seconds before giving up when trying to connect to the configured mail server when sending an email.
- Feat/graphql/access_tokens: send access token creation/deletion emails in background and create special message for dial errors [#63760](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63760)
  - When creating or deleting an access token, we no longer wait for the email to be sent before returning to the caller. Instead, we now send it in the background.
- Add more Completions handler tests [#63761](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63761)NA
- Search: make 'exclude tests' more general [#63762](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63762)
- Minor refactoring, fixes [#63766](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63766)NA
- Svelte: add more general shrinkable path [#63770](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63770)
- Feature/db/sub_repo_perms: add IPs column to sub repo perms [#63771](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63771)
  - The sub_repo_permissions table now has an ips column to store the associated IP address associated with each path rule.
- Security: Auto-update package lockfiles for Sourcegraph base images [#63776](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63776)
- Gateway: Don't panic because of duplicate env var registration [#63787](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63787)
- RFC 969 API boilerplate [#63789](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63789)
- Structural search: fix precise lang filtering [#63791](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63791)
- Feature: update `sg release cut` to automate stitch graph gen and release branch creation [#63794](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63794)
- Wolfi image for Sourcegraph Frontend [#63798](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63798)
- Fix(nix/p4-fusion): update p4-fusion helix-api hashes [#63805](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63805)
- Move Cody Web to beta [#63806](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63806)
- Feat/lib/telemetrygateway: expose simple Dial [#63810](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63810)
- Internal/database/sub_repo_permissions: modify store to be able to insert ip based permissions [#63811](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63811)The sub_repositorypermissions database store can now save and retrieve the IP addresses associated with each path rule.
- Several fixes around merging modelconfig, and the current Cody Gateway data [#63814](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63814)NA
- Svelte: optimize `observeIntersection` [#63816](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63816)
- Change model identifier for finetuned deepseek model [#63817](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63817)
- Syntactic indexing non local refs java [#63822](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63822)
- Feat/sg/msp: helpful error on cloudsqlproxy port conflict [#63830](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63830)
- Feat/sg/enterprise: add 'sg enterprise set-name' [#63832](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63832)
- Updated error messaging for blocked requests due to abuse [#63836](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63836)
- Gitserver: Add option to allow setting custom context line count [#63840](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63840)
- Misc saved searches followups [#63841](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63841)
- Gitserver: Add OctopusMergeBase RPC method [#63842](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63842)
- Pr-auditor: use pr-auditor from devx-service [#63847](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63847)
- Cody: add access token callback pages for CLI, Eclipse and VS [#63849](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63849)
- Cody: add support for neovim, cody-cli, eclipse, and visualstudio clients [#63851](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63851)
  - Fix HTTP 406 error when using the Neovim Cody plugin with Enterprise instances

- Chore/lib/telemetrygateway: fixup Dial helper [#63862](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63862)
- Blame: fix some issues with the stream [#63865](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63865)
  - Fixed an issue with blame view that can cause retry loops and error pages that block interaction with the rest of the UI
- Docs: Add alternate names and links in GraphQL docs [#63867](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63867)
- Show saved searches in new global navbar [#63868](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63868)
- Factor out PatternConstrainedInput [#63869](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63869)
- Add configuration for Intent Detection API [#63871](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63871)
- Prompt Library [#63872](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63872)
  - The Prompt Library lets you create, share, and browse chat prompts for use with Cody. Prompts are owned by users or organizations, and site admins can make prompts public so that all users on the instance can see and use them. To use a prompt from your Prompt Library in Cody, select it in the Prompts dropdown in the Cody chat message field.
- Integrate Cohere re-ranking API [#63877](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63877)
- Special oauth containers [#63880](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63880)
- Feature: db connection pinger and validator [#63884](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63884)
- Update CodyLLMConfiguration GraphQL object to be modelconfig aware [#63886](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63886)NA
- Sg: check for nil multiError [#63889](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63889)
- Search: add regex support to `repo:has.meta()` [#63891](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63891)
  - `repo:has.meta()` predicate now supports regex patterns for keys and values
- Fixes re: Cody Pro x Sourcegraph-supplied models [#63892](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63892)NA
- Cody-gateway: handle missing Google response [#63895](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63895)cody-gateway: log missing Google response as warning
- Svelte: fix css selector [#63896](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63896)
- Self hosted models [#63899](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63899)Cody Enterprise: added a new configuration for self-hosting models. Reach out to support if you would like to use this feature as it is in early access.
- Adds unit tests for syntactic usages [#63900](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63900)
- [sg] Make rfc command use private RFCs by default [#63902](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63902)
- Unify naming of used/ignored context [#63903](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63903)
- Track usage stats for saved searches in UTC day increments [#63904](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63904)
- Query Repository.id to support Apollo Client caching [#63905](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63905)
- WithAuthenticatedUser: use react-router-dom hooks & add test [#63906](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63906)
- Show org name not displayName in most places [#63907](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63907)
  - The user menu and other filter menus now show the names of organizations, not their "display names", to avoid ambiguity. For example, these menus will now show `abc-corp` not `ABC Corp` (if the latter was the `abc-corp`'s display name).
- Add saved search visibility, draft, and timestamps [#63909](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63909)
  - Saved searches can now be made public (by site admins), which means all users can view them. This is a great way to share useful search queries with all users of a Sourcegraph instance.
  - Saved searches can be marked as a "draft", which is a gentle indicator that other people shouldn't use it yet.
- Fix(build-tracker): Failed back-compat doesn't count towards branch-locking quota [#63911](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63911)
- Sg: enable alerting by default for production projects [#63912](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63912)
- Add separate shadow value for hovercards [#63918](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63918)
- GraphQL: improve query cost violation message [#63921](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63921)
- Fix/frontend/httpapi: improve request reader [#63923](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63923)
- Saved searches & prompt library fixes [#63930](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63930)
- Remove "organizations aren't supported" page on dotcom [#63932](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63932)
- Prevent orgs from being named "global" on dotcom [#63933](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63933)
- Allow non-site admins to list their orgs' members on dotcom [#63934](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63934)
- Show "Copied" indicator when copying an access token [#63936](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63936)
- Codeintel: GitTreeTranslator rewrite [#63938](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63938)
- Repoupdater: Make batches init jobs dependent on batches.IsEnabled [#63939](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63939)
- [update] Remove sleep in goroutine for webhook handlers [#63940](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63940)
- Support getting other orgs on dotcom from the GraphQL API [#63941](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63941)
- Misc improvements to graphqlbackend [#63943](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63943)
- Explicitly check viewer access to settings in GraphQL API [#63945](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63945)
- Use the viewerSettings GraphQL API instead of the 5y+-deprecated viewerConfiguration API [#63949](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63949)
- Upgrade vitest to latest [#63951](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63951)
- Add counter for traced requests to Fireworks [#63953](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63953)
- Remove references to modelconfig.sourcegraph.pollingInterval [#63956](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63956)NA
- Fix/database/sub_repo_perms: don't mark TestSubRepoPermsStore_GetByUserWithIPs as Parallel [#63958](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63958)
  - A race condition in the sub_repo_permissions database store test suite has been fixed.
- Svelte rollout: add toggles for svelte-enabled pages [#63960](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63960)
- Fix saved searches and prompts list page for anon users [#63961](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63961)
- Various OrgArea fixes [#63962](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63962)
- Allow site admins to list org members & view user/org settings on dotcom [#63963](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63963)
- Svelte: Fix Safari 17.3 groupBy usage [#63964](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63964)
- Finish removing chromatic [#63966](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63966)
- Cody: correct link to emacs-cody [#63974](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63974)
- Implement server-side single-repo context fetching for RFC 969 [#63980](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63980)
- [fix] Fix being unable to add batch changes credentials when rate limited [#63984](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63984)
  - Fixed an issue where, when Sourcegraph is applying rate limits, batch change credentials could not be added. Sourcegraph now waits a maximum of 10 seconds to update credentials, and if it times out, it saves the credentials regardless and displays a warning to the user.
- Fix incorrect URL (/new) on saved search and prompt library pages [#63995](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63995)
- Feature/worker/permission syncer: perforce: sync HOST field using IP addresses [#64010](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64010)
  - The perforce permissions syncer has been updated to save the IP address associated with each sub_repository_permissions rule.
- Bring back post-sign-up route to the backend router [#64011](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64011)
- Authz: Compute providers on the fly [#64012](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64012)
- Feat/frontend/dotcom: add toggles for various online license checks [#64013](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64013)
- Update the legacy link to sg doc [#64017](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64017)
- Update the outdated link to #dev-experience to #discuss-dev-infra [#64018](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64018)
- Maintenance Splash Page [#64019](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64019)
- Codeintel: returns surroundingContent from search result [#64022](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64022)
- Codeintel: runs occurrence and symbol search in parallel [#64023](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64023)
- Codeintel: allows batch retrieval of SCIP documents [#64024](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64024)
- Codeintel: fetches diffs from gitserver in batches [#64025](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64025)
- Removes the old GitTreeTranslator API [#64027](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64027)
- Remove dead collaborators invite code [#64039](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64039)
- Make cody gateway usage worker a periodic routine [#64040](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64040)
- Unpin openjdk-11 version in blobstore package [#64045](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64045)
- Bug: update version consts in updatecheck handler [#64052](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64052)
- Cleanup: Move azure openai provider config validation to right place [#64056](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64056)
- Security: Auto-update package lockfiles for Sourcegraph base images [#64060](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64060)
- Auth: Fix Found page response when redis is down [#64063](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64063)
- Codeintel: Adds a batch api for fetching multiple documents to MappedIndex [#64073](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64073)
- Syntactic indexing policy toggle: UI and supporting APIs (with backcompat) [#64075](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64075)
  - In site-admin APIs for updating code intelligence policies:
    - Field `indexingEnabled` is renamed to `preciseIndexingEnabled`
    - A required `syntacticIndexingEnabled` is added (only takes effect if experimental feature is enabled)
    - Field `forIndexing` is renamed to `forPreciseIndexing`
- Codeintel: Speed up syntactic and search-based usages using batch APIs [#64078](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64078)
- Scip-syntax: uses `.starts_with` to check reference capture [#64081](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64081)
- Feat/worker/permission syncing: make sub repo permissions re-insertion fall back to original paths if ips not added yet [#64086](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64086)
- Enable p4-fusion by default for Perforce code host connections [#64101](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64101)
  - For Perforce code host connections, `p4-fusion` is now always enabled and the option for the much slower and unreliable `git p4` no longer exists.
- Gerrit: Add support for repositoryPathPattern [#64102](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64102)Added support for the `repositoryPathPattern` setting for Gerrit code host connections.
- Msp: use BUILDKITE_BUILD_CREATOR as fallback [#64104](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64104)
- Msp: remove old author variable [#64107](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64107)
- Blob search: Fix incorrect icons in the blob search bar [#64108](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64108)
- Gomod: update zoekt for guardrails perf experiment [#64109](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64109)
- Svelte Navigation: hide teams when own is not enabled [#64110](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64110)
- Search-blitz: adjust limit for snippetAttribution to match gateway [#64119](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64119)
- Observability: Adds useful data to traces from gosyntect.Highlight [#64121](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64121)
- Scip-syntax: Simplifies to two visibilities [#64124](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64124)
- Gomod: update zoekt to include improvement to experiment [#64125](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64125)
- Support detecting search and edit intent [#64129](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64129)
- SvelteKit: Add 'Tools' Menu item back to global navigation [#64134](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64134)
- Svelte: do not show path section if empty [#64135](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64135)
- SvelteKit: fix issue where clicking link with no href refreshed the page [#64136](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64136)
- Fix/internal/requestclient: read all instances of x-forwarded-for header, not just the first [#64137](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64137)
- Bug: parse v in target versions [#64139](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64139)
- Codeintel: document that pagination for usages might return extra results [#64142](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64142)
- Bug: fix default version [#64143](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64143)
- Chore(syntax-highlighter): Some cleanup for locals detection [#64144](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64144)
- Bump cody web to most recent package @sourcegraph/cody-web [#64149](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64149)
- Docs: Specify matching behavior for usagesForSymbol(range:) [#64151](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64151)
- Svelte: Bump cody web to most recent package @sourcegraph/cody-web [#64152](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64152)
- Nit: adds space between tools menu item and dropdown icon [#64154](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64154)
- Frontend: Remove global conf server variable [#64155](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64155)
- Frontend: Consolidate remaining registry packages [#64156](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64156)
- Add unit test for modelconfig converting starcoder completion model [#64160](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64160)NA
- Relax modelconfig name restrictions [#64161](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64161)NA.
- Svelte: add welcome introduction when enabling svelte for the first time [#64163](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64163)
- Replace modelOverridesRecommendedSettings with selfHostedModels [#64164](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64164)Improved configuration functionality for Cody Enterprise with Self-hosted models.
- Fix autocomplete regression in `main` ("various" provider issue) [#64165](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64165)N/A
- Expose ranker relevance score in GraphQL API [#64172](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64172)
- Policy patch - Leave fields unchanged if they're missing from request [#64174](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64174)
- Docs: Weaken guarantees for Usage cursor [#64185](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64185)
- Code intel: respect provenance when getting usages [#64193](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64193)
- Bump @sourcegraph/cody-web to 0.3.2 [#64195](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64195)
- Don't block `frontend` initialization with invalid modelconfig [#64200](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64200)NA
- Security: Auto-update package lockfiles for Sourcegraph base images [#64204](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64204)
- Search: apply phrase boosting to more queries [#64207](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64207)
- Sg cloud eph: simplify status [#64209](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64209)
- Styling updates throughout [#64221](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64221)
- Svelte: welcome banner followups [#64222](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64222)
- Cody web: add server-side fetching for URL mentions [#64223](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64223)
- Bump @sourcegraph/cody-web to 0.3.4 [#64224](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64224)
- Chore: remove enablePreciseOccurrences feature flag [#64229](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64229)
- Web: fix git blame for files that have `/stream/` in their path [#64230](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64230)
  - Fixed an issue where blame view would error when the file contains the path element `/stream/`
- Codeintel: make usage-range non-optional [#64236](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64236)
- Ephemerals: fix feature flag name [#64237](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64237)
- Reapply "soap: Fix auto-redirect to IdP when SOAP is enabled" (#64234)  [#64244](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64244)
- Gitserver: RawDiff checks if commits exist [#64245](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64245)Fixes a bug where a force push on HEAD of a repository might lead to our unindexed search failing until the indexed search had updated.
- Servicecatalog: remove searcher dep on database [#64247](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64247)
- Chore: remove non-null assertions [#64249](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64249)
- Svelte: fix welcome banner flashing on reload [#64251](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64251)
- Cody Web: Update Cody Web to 0.3.6 [React version] [#64254](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64254)
- Svelte: make closing the welcome overlay more obvious [#64256](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64256)
- Gomod: update zoekt for shard scanning improvement [#64264](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64264)
- Update p4-fusion-sg wolfi-package [#64266](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64266)
- Return 'sourcegraph' as the CodyLLMConfigurationResolver.Provider [#64276](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64276)NA
- Svelte: remove site admin gate on code intel preview [#64277](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64277)
- Improving Azure errors for customer containers [#64278](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64278)
- Update the default Sourcegraph-supplied LLM models [#64281](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64281)NA?
- Enable SCIP based APIs by default [#64285](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64285)
- Update wolfi hashes [#64289](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64289)
- Searcher: fix benchmarks [#64292](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64292)
- Search: re-add support for 'lucky' patterntype [#64293](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64293)
- Update Cody Web to 0.3.7 [#64296](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64296)
- Search: boost matches on quoted terms [#64298](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64298)
- Return model IDs from GraphQL, not model Names [#64307](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64307)NA
- Svelte: more welcome banner behavior updates [#64311](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64311)
- Fix Cody Web Svelte Sidebar [#64320](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64320)
- Center align Cody logo in Cody Web Sidebar [#64324](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64324)
- Upgrade Cody Web, always create a new chat [#64334](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64334)
- Svelte: enable toggle by default [#64340](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64340)

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:
- [Backport-5.5.x]: Move Cody Web to beta (#63806) [#63808](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63808)
- Backport: Blame: fix some issues with the stream (#63865) [#63929](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63929)
- Security: Auto-update package lockfiles for Sourcegraph base images [#64035](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64035)
- Security: Bump openjdk-11 version in blobstore image [#64047](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64047)
- Appliance: backport all recent appliance changes [#64182](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64182)
  - Backport all recent appliance changes. The appliance is still pre-release.
- Cherry-pick 856e41e with resolved conflicts [#64228](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64228)

# v5.5.3956

{/* RSS={"version":"v5.5.3956", "releasedAt": "2024-08-02"} */}

### Reverts

### Uncategorized

- [Backport-5.5.x]: Move Cody Web to beta (#63806) [#63808](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63808)
- [Backport 5.5.x] fix(batches): the baseURL for github instance is now updated when creating a GitHub app [#63833](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63833) Backport 1c40c9e5bccd4f6265945bd3449b70a648022e60 from #63803
- [Backport 5.5.x] Upgrade cody web experimental package to 0.2.5 [#63856](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63856)
- Backport 63870 to 5.5.x [#63882](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63882)
  - Adds an experimental feature `commitGraphUpdates` to control how upload visibility is calculated.
- [Backport 5.5.x] Upgrade cody web experimental package to 0.2.7 (#63863) [#63901](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63901)
- Backport: Blame: fix some issues with the stream (#63865) [#63929](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63929)
- [Backport 5.5.x] [fix] Only trigger externalAcctSignup event when a new user is created [#63975](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63975)
  - Fixed an issue where the `http-header` auth would cause a massive amount of event logs spam Backport cd6595196177b3d307a4e8f76222c6d8c5c9b23f from #63843
- [Backport 5.5.x] Publish images for all commits on release branches [#63987](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63987) Backport b7242d280f37a4b9effebb52ac4301e59635d629 from #63985
- [Backport 5.5.x] [logging] Only record events if a new user was created [#64005](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64005) Backport 777c7a089956f1ad9c494ab55e8660bbdd781259 from #64004
- [Backport 5.5.x] Integrate security release approval into release pipeline [#64030](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64030) Backport 9dd901f3c957cf5bf83aa6ac41fc3c6b2744cfd3 from #63990
- Security: Auto-update package lockfiles for Sourcegraph base images [#64035](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64035)
- [Backport 5.5.x] fix(source): Fix issue where worker would crash if a Bitbucket Cloud token couldn''t be refreshed [#64037](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64037)
  - Fixed an issue where a Bitbucket Cloud OAuth token failing to refresh would crash the `worker` service. Backport bc036ad2bafc9a09d80646d30d26335359a28fd1 from #64028
- Security: Bump openjdk-11 version in blobstore image [#64047](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64047)
- [Backport 5.5.x] ci: make internal+promote release higher priority in runtypes [#64050](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64050) Backport 0309564f9362ea24e248aa5189d66f89826ccecf from #64049
- [Backport 5.5.x] fix: Fix Chrome stack overflow during highlighting [#64074](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64074)
  - Fixes a Chrome-specific stack overflow when highlighting large files.
 Backport 2644e242447ac355a415abec7af5cfb8d9849e75 from #64072
- Backport 5ce2eea to 5.5.x [#64166](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64166)
- Security: Auto-update package lockfiles for Sourcegraph base images [#64180](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64180)
- [Backport 5.5.x] fix(appliance): cache authorization status [#64219](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64219) Backport 156aa5a0adec1bc7a1f2142878761d8993dd4c43 from #64213
- [Backport 5.5.x] fix(appliance): reliably redirect to site-admin post-install [#64220](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64220) Backport e54407d9f50ed11f1a7c27edbb5c42966070f236 from #64216
- Cherry-pick 856e41e with resolved conflicts [#64228](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64228)

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:
- [Backport 5.5.x] release/bug: generate a new stitched migration graph [#63769](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63769) Backport cb19d6f0a98f7ecce65629bd117c34a8dc1db8e2 from #63764
- [Backport 5.5.x] Context: return lines around symbol match [#63788](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63788)
- [Backport 5.5.x] fix/alertmanager: downgrade prometheus/common to fix generated config [#63793](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63793)
  - Fix Prometheus Alertmanager configuration failing to apply `observability.alerts` from site config  Backport ffa873f3adb18e2c5807ca752115a70fcbc493c8 from #63790
- [Backport-5.5.x]: Move Cody Web to beta (#63806) [#63808](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63808)
- [Backport 5.5.x] fix(batches): the baseURL for github instance is now updated when creating a GitHub app [#63833](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63833) Backport 1c40c9e5bccd4f6265945bd3449b70a648022e60 from #63803
- [Backport 5.5.x] Upgrade cody web experimental package to 0.2.5 [#63856](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63856)
- Backport 63870 to 5.5.x [#63882](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63882)
  - Adds an experimental feature `commitGraphUpdates` to control how upload visibility is calculated.
- [Backport 5.5.x] Upgrade cody web experimental package to 0.2.7 (#63863) [#63901](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63901)
- Backport: Blame: fix some issues with the stream (#63865) [#63929](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63929)
- [Backport 5.5.x] [fix] Only trigger externalAcctSignup event when a new user is created [#63975](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63975)
  - Fixed an issue where the `http-header` auth would cause a massive amount of event logs spam Backport cd6595196177b3d307a4e8f76222c6d8c5c9b23f from #63843
- [Backport 5.5.x] Publish images for all commits on release branches [#63987](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63987) Backport b7242d280f37a4b9effebb52ac4301e59635d629 from #63985
- [Backport 5.5.x] [logging] Only record events if a new user was created [#64005](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64005) Backport 777c7a089956f1ad9c494ab55e8660bbdd781259 from #64004
- [Backport 5.5.x] Integrate security release approval into release pipeline [#64030](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64030) Backport 9dd901f3c957cf5bf83aa6ac41fc3c6b2744cfd3 from #63990
- Security: Auto-update package lockfiles for Sourcegraph base images [#64035](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64035)
- [Backport 5.5.x] fix(source): Fix issue where worker would crash if a Bitbucket Cloud token couldn''t be refreshed [#64037](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64037)
  - Fixed an issue where a Bitbucket Cloud OAuth token failing to refresh would crash the `worker` service. Backport bc036ad2bafc9a09d80646d30d26335359a28fd1 from #64028
- Security: Bump openjdk-11 version in blobstore image [#64047](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64047)
- [Backport 5.5.x] ci: make internal+promote release higher priority in runtypes [#64050](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64050) Backport 0309564f9362ea24e248aa5189d66f89826ccecf from #64049
- [Backport 5.5.x] fix: Fix Chrome stack overflow during highlighting [#64074](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64074)
  - Fixes a Chrome-specific stack overflow when highlighting large files.
 Backport 2644e242447ac355a415abec7af5cfb8d9849e75 from #64072
- Backport 5ce2eea to 5.5.x [#64166](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64166)
- Security: Auto-update package lockfiles for Sourcegraph base images [#64180](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64180)

# v5.5.3738

{/* RSS={"version":"v5.5.3738", "releasedAt": "2024-07-31"} */}

### Feat

- Appliance: backport all recent appliance changes [#64182](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64182)
  - Backport all recent appliance changes. The appliance is still pre-release.

### Reverts

### Uncategorized

- [Backport 5.5.x] fix: Fix Chrome stack overflow during highlighting [#64074](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64074)
  - Fixes a Chrome-specific stack overflow when highlighting large files.
 Backport 2644e242447ac355a415abec7af5cfb8d9849e75 from #64072
- Backport 5ce2eea to 5.5.x [#64166](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64166)

# v5.5.2463

{/* RSS={"version":"v5.5.2463", "releasedAt": "2024-07-24"} */}

### Uncategorized

- Backport: Blame: fix some issues with the stream (#63865) [#63929](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63929)
- [Backport 5.5.x] [fix] Only trigger externalAcctSignup event when a new user is created [#63975](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63975)
  - Fixed an issue where the `http-header` auth would cause a massive amount of event logs spam Backport cd6595196177b3d307a4e8f76222c6d8c5c9b23f from #63843
- [Backport 5.5.x] Publish images for all commits on release branches [#63987](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63987) Backport b7242d280f37a4b9effebb52ac4301e59635d629 from #63985
- [Backport 5.5.x] [logging] Only record events if a new user was created [#64005](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64005) Backport 777c7a089956f1ad9c494ab55e8660bbdd781259 from #64004
- [Backport 5.5.x] Integrate security release approval into release pipeline [#64030](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64030) Backport 9dd901f3c957cf5bf83aa6ac41fc3c6b2744cfd3 from #63990
- Security: Auto-update package lockfiles for Sourcegraph base images [#64035](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64035)
- [Backport 5.5.x] fix(source): Fix issue where worker would crash if a Bitbucket Cloud token couldn''t be refreshed [#64037](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64037)
  - Fixed an issue where a Bitbucket Cloud OAuth token failing to refresh would crash the `worker` service. Backport bc036ad2bafc9a09d80646d30d26335359a28fd1 from #64028
- Security: Bump openjdk-11 version in blobstore image [#64047](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64047)
- [Backport 5.5.x] ci: make internal+promote release higher priority in runtypes [#64050](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/64050) Backport 0309564f9362ea24e248aa5189d66f89826ccecf from #64049

# v5.5.1337

{/* RSS={"version":"v5.5.1337", "releasedAt": "2024-07-18"} */}

### Uncategorized

- [Backport 5.5.x] Upgrade cody web experimental package to 0.2.7 (#63863) [#63901](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63901)

# v5.5.1220

{/* RSS={"version":"v5.5.1220", "releasedAt": "2024-07-17"} */}

### Uncategorized

- [Backport-5.5.x]: Move Cody Web to beta (#63806) [#63808](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63808)
- [Backport 5.5.x] fix(batches): the baseURL for github instance is now updated when creating a GitHub app [#63833](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63833) Backport 1c40c9e5bccd4f6265945bd3449b70a648022e60 from #63803
- [Backport 5.5.x] Upgrade cody web experimental package to 0.2.5 [#63856](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63856)
- Backport 63870 to 5.5.x [#63882](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63882)
  - Adds an experimental feature `commitGraphUpdates` to control how upload visibility is calculated.

# v5.5.160

{/* RSS={"version":"v5.5.160", "releasedAt": "2024-07-11"} */}

### Uncategorized

- [Backport 5.5.x] Context: return lines around symbol match [#63788](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63788)
- [Backport 5.5.x] fix/alertmanager: downgrade prometheus/common to fix generated config [#63793](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63793)
- Fix Prometheus Alertmanager configuration failing to apply `observability.alerts` from site config  Backport ffa873f3adb18e2c5807ca752115a70fcbc493c8 from #63790

# v5.5.0

{/* RSS={"version":"v5.5.0", "releasedAt": "2024-07-11"} */}

### Chore

- Change errors.HasType to respect multi-errors [#63024](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63024)
- Codenav: Resolve repo and commit in common code [#63072](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63072)
- Graph: Add changelog entry for Python scip-ctags fix (second attempt) [#63106](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63106)
- Search: Add test case covering hack lang detection behavior [#63136](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63136)
  - Add test case for coverage hack lang detection
- Msp: document gRPC notes in spec docstrings [#63140](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63140)
- Fix lint error (unparam) [#63151](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63151)
- Validate driver type immediately [#63177](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63177)
- Appliance: remove references to embeddings [#63185](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63185)
  - Remove references to embeddings from (still unreleased) appliance.
- Security: update dependencies [#63197](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63197)
- Ci: conditionally stamp genrules [#63204](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63204)
  - Avoid invalidating cache in stamped genrules on dev builds.
- Schema: Add implementation status for codeGraphData [#63219](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63219)
- Add GitBlobResolver and GitTreeResolver for readability [#63223](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63223)
- Remove dead code for Rust crates [#63224](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63224)
- Bazel: bump to 7.2.0 [#63226](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63226)
- Changelog: advise contributors of new process [#63243](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63243)
  - Advise contributors of new changelog process.
- Svelte: Migrate all icons to Lucide/custom icons [#63246](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63246)
- Add binary search function that returns range [#63248](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63248)
- Move deduplicateBy to collections package [#63249](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63249)
- Codeintel: Use internal language detection package for insights [#63254](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63254)
  - Code clean up to use common language detection mechanism in more places
- Remove broken link in README [#63256](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63256)
- Remove unused code paths in lsifstore package [#63259](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63259)
- Add more tests for GetLanguages API [#63260](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63260)
- Simplify location uniquing [#63263](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63263)
- Add specialized function for sorting primitive sets [#63269](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63269)
- Bump go-enry and Zoekt to handle new languages [#63281](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63281)
  - Updates the `lang:` filter to add support for languages such as Mojo, Roc, EdgeQL etc.
- Ci: remove buildchecker sunday summary posts [#63289](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63289)
- Maintain consistency between languages functions [#63292](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63292)
- Local: remove docsite from dotcom commandset [#63314](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63314)
- Deps: upgrade grpc, prometheus/common [#63328](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63328)
- Deps: upgrade alertmanager package dependency, improve logs and tests [#63329](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63329)
- Add more docs for occurrences GraphQL API [#63338](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63338)
- Svelte: Simplify development for dotcom [#63341](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63341)
- Svelte: Remove stub logger [#63342](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63342)
- Plg: migrate invoices list to react-query [#63343](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63343)
- Local: simplify 'sg db' inline help [#63344](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63344)
- Ci: instrument push_all.sh commands in honeycomb [#63350](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63350)
- Ci: mark web-sveltekit:e2e_test as flaky [#63351](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63351)
- Svelte: Update fuzzy finder designs [#63354](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63354)
- Fix inaccurate error message [#63361](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63361)
- Remove obsolete tracking code for Cody App downloads [#63364](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63364)
- Centralize logic for disabling Batch Changes on dotcom [#63370](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63370)
- Add SymbolUsageKind to GraphQL API [#63371](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63371)
- Add doc comment for DiffOptions.Paths [#63385](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63385)
- Deps: replace internal/slices [#63386](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63386)
  - Add a collections library to dependencies.
- Refactor and document GitTreeTranslator [#63390](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63390)
- Batches: remove visibility options from create batch changes page [#63393](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63393)
  - Remove visibility options from create batch change page
- Enterpriseportal: only use 'revoke' verb for licenses [#63407](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63407)
- Bazel: bump rules_js to address permissions denied warning [#63419](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63419)
- Ci: emit compact executon log in CI [#63420](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63420)
- Batches: remove beta badge from batch changes [#63423](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63423)
  - Remove Beta badge from Batch Changes pages.
- Enterpriseportal: split database package [#63425](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63425)
- Enterpriseportal: properly close DB handle [#63426](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63426)
- Codeintel: Differentiate between paths relative to upload root vs repo root [#63437](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63437)
- Batches: remove beta badge from Batch Changes page [#63441](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63441)
  - The Beta badge is now removed from Batch Changes
- Plg: add useEmbeddedUI site config param [#63442](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63442)
- Svelte: Properly route to revision agnostic pages [#63444](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63444)
- Enterpriseportal: tweak maybeMigrate tracing [#63448](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63448)
- Ci: emit compact executon log in CI for test + build commands only [#63451](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63451)
- Enterpriseportal: propagate context to migration database context [#63455](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63455)
- Svelte: Hide cody nav entries and upsell banner when cody isn't enabled [#63463](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63463)
- Add collection type - OrderedSet [#63469](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63469)
- Bazel: don't stamp yq rule for wolfi base images [#63470](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63470)
- Bazel: add client/backstage-frontend to bazelignore [#63471](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63471)
- Svelte: Upgrade SvelteKit [#63490](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63490)
- Enterpriseportal: rename customer admin role in API [#63501](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63501)
- Enterpriseportal: add test for iam_model [#63503](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63503)
- Codygatewayevents: extract into standalone package for reuse, split up internal/codygateway [#63528](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63528)
- Local: add dotcom-cody-e2e commandset [#63548](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63548)
- Linearhooks: use MSP rollouts [#63556](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63556)
- Analytics: remove Cody characters events from inclusion in pinâ€¦ [#63557](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63557)
- Search: VSCode Search extension: Remove signup link for sourcegraph.com [#63558](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63558)
  - Remove links to create an account on sourcegraph.com because it no longer hosts private code.
- Search: VSCode Search extension: Remove url and token from configuration [#63559](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63559)
  - Remove access token and URL from extension settings because they are managed in the extension now.
- Preserve format imposed by bazel [#63561](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63561)
- Add feature flag for new SCIP-based GraphQL APIs [#63565](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63565)
- Simplify path trimming logic in perm checking [#63574](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63574)
- Set scipBasedAPIs to off by default [#63575](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63575)
- Use api.RepoID and api.CommitID in more places [#63596](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63596)
- Local: sg warns about opposite default value on dev builds [#63612](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63612)
- Local: make sg handle empty secret file gracefully [#63614](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63614)
- Local: simplify sg teammate [#63667](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63667)
- Svelte: Cleanup dependencies [#63691](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63691)
- Drop isGitHubApp field from batch changes credentials [#63709](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63709)
- Reword headline from tokens to credentials [#63714](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63714)
- Redis: set max active redis connections to 1000 [#63718](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63718)
  - Redis-pool: set max active clients to 1000
- Security: Updated dind image to 27-0-3 [#63725](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63725)
  - Upgraded dind to 27.0.3 to patch CVE-2024-24790 vulnerability
- Svelte: Update to latest cody web version [#63732](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63732)
- Svelte: Use MDI icons for seach input pattern type toggles [#63733](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63733)
- Svelte: Update cody web version [#63747](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63747)
- Add changelog entry for Batch Changes - GitHub apps integration [#63756](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63756)
  - Batch Changes: GitHub apps can now be added as a credential for authentication and interacting with changesets. [#31533](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/31533)

### Feat

- Ci: Adds playwright tests for sveltekit to bazel [#62560](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62560)
- Search: Add Syntax Highlighting for Hack Language [#62770](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62770)
- Search: Add Syntax Highlighting for Magik language [#62919](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62919)
  - Added syntax highlighting for the Magik programming language.
- Msp: allow enablement of logical replication features for Datastream [#63092](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63092)
  - MSP services can now configure `postgreSQL.logicalReplication` to enable Data Analytics team to replicate selected database tables into BigQuery.
- Search: Support Magik language file filter in search [#63110](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63110)
  - Added Magik language to language filters (`lang:magik`)
- Sg: add command to generate a dotcom user gateway access token [#63125](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63125)
- Appliance: deploy frontend [#63158](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63158)
  - Appliance (still unreleased) can deploy frontend.
- Appliance: deploy searcher [#63191](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63191)
  - Appliance (as yet unreleased) can deploy Searcher.
- Gitserver: don't log memoryObservation error if it occured b/c context cancellation [#63210](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63210)
  - Reduce logspam in the gitserver command functionality by ignoring memory observation errors if they occurred due to external context cancellation.
- Plg: Add new Checkout flow that uses Stripe's `createToken` API [#63213](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63213)
- Gitserver: avoid logspam from deadline exceeded memory tracking errors [#63215](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63215)
  - In the gitserver new command logic, logspam from the memory observer when the context error is deadline exceeded will no longer occur.
- Plg: Add seats [#63227](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63227)
- Search: Add icon for the Hack language [#63233](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63233)
  - Adds icon for the Hack language
- Plg: Apply designs to Cody Pro pages [#63244](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63244)
- Plg: Use react-query for team management [#63267](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63267)
- Ci: Trigger security scanner from release pipeline [#63280](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63280)
  - Added security scanner to the release pipeline
- Plg: remove accept invite page [#63290](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63290)
- Enterpriseportal: UpdateCodyGatewayAccess RPC definition [#63307](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63307)
- Enterpriseportal: CreateEnterpriseSubscription RPC definition [#63308](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63308)
- Enterpriseportal: add Salesforce metadata at subscription level [#63317](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63317)
- Sg: command to add default site-admin with predefined access token  [#63320](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63320)
- Enterpriseportal: CreateEnterpriseSubscriptionLicense RPC defininition [#63323](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63323)
- Enterpriseportal: ArchiveEnterpriseSubscription RPC definition [#63330](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63330)
- Enterpriseportal: RevokeEnterpriseSubscriptionLicense RPC definition [#63331](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63331)
- Add id for CodeGraphData [#63337](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63337)
- Codeintel: Add precise auto-inferencing for dotnet [#63348](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63348)
  - Enable automatic precise indexing of .NET projects
- Plg: Update Cody Pro badge deck [#63352](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63352)
- Appliance: appliance docker container [#63357](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63357)
  - Feat(appliance): create docker container
- Plg: Tweak invite co-workers flow [#63374](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63374)
- Plg: Invite users on Cody Dashboard [#63375](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63375)
- Plg: require confirmation before removing user or revoking admin [#63388](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63388)
- Svelte: Make fuzzy finder matching more reliable [#63397](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63397)
  - Add 'search all' tab
  - Support multi-word search
  - Support regular expression patterns
  - Fix matching reliability
- Plg: remove seats from subscription [#63408](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63408)
- Sg: add 'sg enterprise' commands for Cody Analytics [#63414](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63414)
- Enterpriseportal: validate and normalize instance domains [#63415](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63415)
- Appliance: local developer mode [#63417](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63417)
  - Local developer mode for appliance config authors.
- Enterpriseportal: use UUID type for subscription ID [#63452](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63452)
- Enterpriseportal: initialize subscriptions tables [#63453](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63453)
- Enterpriseportal: init licenses tables [#63454](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63454)
- Enterpriseportal: init Cody Gateway Access table [#63457](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63457)
- Dotcom: show subscription UUID in Enterprise Portal format [#63482](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63482)
- Sg: add -auto-approve option for 'sg enterprise' updates [#63500](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63500)
- Enterpriseportal: make UpdateEnterpriseSubscriptionMembership authoritative [#63502](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63502)
- Codeintel: Add scip-ctags support for Magik [#63504](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63504)
  - Add symbol browsing support for the Magik language
- Enterpriseportal: define GetCodyGatewayUsage RPC, use uint64 for rate limits [#63531](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63531)
- Remove experimental label from batches merge changesets action [#63542](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63542)
- Enterpriseportal: implement GetCodyGatewayUsage RPC [#63555](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63555)
- Search: Make search aware of perforce changelist id mapping [#63563](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63563)
  - For perforce depots, support searching within a specific changelist by specifying a ref like `context:global repo:^repo/name$@changelist/83854`
- Introduce database fields for github apps - Batch changes integration, and update database layer [#63577](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63577)
- Sg: sqlite-backed local store for sg analytics [#63578](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63578)
- Search: remove keyword toggle [#63584](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63584)The keyword search toggle has been removed from the search results page. [Keyword search](https://sourcegraph.com/docs/code-search/queries#keyword-search-default) is now enabled by default for all searches in the Sourcegraph web app.
- Sg: one-time oauth login to persist user email for analytics [#63603](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63603)
- Cody: Expose Sg modelconfig data via HTTP REST API [#63604](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63604)Sourcegraph instances how expose an HTTP endpoint that authenticated users can call to get a list of LLM models supported by the Sourcegraph instance. In the future this will be used to allow Cody users to select the LLM model dynamically, based on what is currently available.
- Batches: use "keyword" as default pattern type [#63613](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63613)
  - The new (optional) field "version" of batch specs determines how the spec is processed. This allows us to introduce new features while maintaining backward compatability.
  - A new version `2` is introduced. Batch specs specifying `version: 2` will use keyword search as the default pattern type to determine repos/workspaces. Batch specs with `version: 1` or without version field keep using pattern type "standard".
- Svelte: Make diff headers on commit page sticky [#63615](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63615)
- Implement functionality to create credential GitHub apps [#63635](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63635)
- Svelte: Add Cody chat sidebar [#63638](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63638)
- Dotcom: add Enterprise Portal auth proxy [#63652](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63652)
- Svelte: Add cody button to repo home page [#63684](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63684)
- Dotcom: remove per-user Enterprise subscriptions UI [#63698](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63698)
- Enterpriseportal: database layer for subscriptions upsert [#63703](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63703)
- Svelte: Add reblame support to blame column [#63727](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63727)
- Source: Properly render multi-line changelist messages from Perforce [#63728](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63728)
  - Properly render multi-line perforce changelist descriptions

### Fix

- Appliance: use version for image tags [#63075](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63075)
  - Appliance uses requested version as image tag, instead of requiring sha256 digests.
- Sg: fix cloud eph suggested commands  [#63093](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63093)
  - Fix suggested cloud ephemeral commands
  - Show duration till expiry for cloud ephemeral
- Release: remove generate-notes from github release creation [#63121](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63121)
  - Remove `generate-notes` cli flag when promoting releases
  - Push only a single tag
  - Fix token name used in changelog generation
- Search: Properly handle URLs with file paths that contain route segments [#63123](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63123)
- SCIM: don't allow SCIM users to change fields [#63130](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63130)
- Highlighting: Update JSX/TSX highlighting to more properly label tag  delimiters [#63138](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63138)
  - Update highlighting of JSX/TSX Tags to correctly label delimiters
- Highlighting: Improve highlighting for Magik language [#63155](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63155)
  - Correctly identify null and symbols in Magik language syntax highlighting
- Search: Contributors page errors with empty date string [#63182](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63182)
- Tests: Clean up mocks after test [#63201](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63201)
- Local: disable bazel remote cache [#63203](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63203)
- Search: Copy text from read-only code host configuration input [#63239](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63239)
- Plg: Fix "Remove team member" feature [#63241](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63241)
- Svelte: scrolling search input [#63261](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63261)
- Search: VSCode Search extension: remove auth provider [#63262](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63262)
  - Remove interaction between the Sourcegraph Search extension and the Accounts menu.
- Search: Better diagnostic message for invalid and incomplete select: filter value [#63266](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63266)
  - Show useful valid values when an invalid `select:` value is entered
  - Do not render empty hover tooltips
- Search: Improve syntax highlighting of search history entries [#63271](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63271)
- Search: Ignore *lock keys for keyboard shortcut matching [#63272](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63272)
- Svelte: Add trailing slash to group and directory suggestions [#63273](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63273)
- Source: Fix documentation URLs for code hosts help pages [#63274](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63274)
  - Fix in-product documentation links for code hosts to point to updated docs location
- Ci: remove broken glob [#63277](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63277)
- Don't mark references in import statements as definitions [#63284](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63284)
  - Fixes a bug where import statements in TypeScript code showed up in `type:symbol` search.
- Plg: banner styles [#63287](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63287)
- Svelte: Fix icon color in search sidebar [#63288](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63288)
- Svelte: Open correct file from preview panel line number [#63309](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63309)
- Svelte: Reference panel width [#63310](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63310)
- Svelte: Fix reference panel loading/error state [#63316](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63316)
- Svelte: Properly scope global CSS selector [#63332](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63332)
- Svelte: Preserve selected lines in codehost URL [#63334](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63334)
  - Line selection is preserved when navigating to GitHub or GitLab external URLs
  - File actions are now available in the inline 'at commit' view
  - File icon is now rendered in the file header for the inline diff view
- Svelte: History suggestions should show immediately when clicking the history button [#63335](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63335)
- Batches: disallow retry on deleted changesets [#63336](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63336)
  - Disallow auto-retry when a changeset is deleted.
- Svelte: Data/code preloading doesn't work when using panels [#63339](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63339)
- Svelte: Use correct symbol icon color [#63355](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63355)
- Api: only allow a user or site admin to view that user's usage stats [#63365](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63365)
- Client: restore paths for extension bundles [#63402](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63402)
- Sg: fix mangled log output from `sg start` and `sg run` [#63405](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63405)
- Enterpriseportal: ListEnterpriseSubscriptions fixes [#63412](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63412)
- Svelte: Properly rounded corner for file view hover cards [#63446](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63446)
- Analytics: fix broken v1 codeintel event logging [#63449](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63449)
- Plg: ensure invite flow is enabled only for embedded UI [#63466](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63466)
- Check (uploadID, path) pairs in bulk [#63485](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63485)
- Search: remove "lucky" from default pattern types [#63486](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63486)
  - Removed experimental pattern type "lucky" from the list of supported default pattern types.
- Sg: reduce max interrupt count and os.Exit always [#63516](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63516)
  - Sg - Always os.Exit once shutdown hooks have completed
  - Sg - Reduce max intterupt count from 5 to 2 to hard exit
- Batches: remove leading and trailing spaces from batch changes credentials [#63517](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63517)
  - Whitespaces in Batch Changes credentials are trimmed before being saved to the database, this prevents 401 errors when using the token to construct an authenticated push URL.
- Search: VSCode Search extension: bring back matched lines in search results.  [#63524](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63524)
- Sg: fix 'sg enterprise' per-command flags [#63527](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63527)
- Sg: conditionally show protips [#63541](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63541)
  - Sg - Conditionally show protips when running `sg bazel`
- Search: Token decoration in keyword-enabled query input [#63543](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63543)
- Svelte: Reference layout shift while loading data [#63546](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63546)
- Batches: fix zero division error resulting in wrong stats computation [#63547](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63547)
- Enterpriseportal: forcibly run gorm-incompatible migration in local dev [#63549](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63549)
- Telemetrygateway: reduce context cancellation error reports [#63551](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63551)
- Search: VSCode Search extension: hide file preview link [#63552](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63552)
- Svelte: Fix unplugin icons usage in storybook [#63594](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63594)
- Ci: panic using correct err [#63599](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63599)
  - Ci - Use correct err value to panic on
- Svelte: Remove rogue console.log statement [#63600](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63600)
- Search: Don't show inline cody widget when new cody web is enabled [#63608](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63608)
- Actions: update pinned SHA for `pnpm/action-setup` action [#63632](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63632)
- Batches: display failure alert depending on github app kind [#63633](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63633)
- Svelte: Render correct error page [#63663](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63663)
- Svelte: Use 'pointer' pointer for cody button [#63665](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63665)
- Svelte: Respect cody ignore settings [#63677](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63677)
- Svelte: Fixes excessive 'the hotkey ... has already been registered' messages [#63679](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63679)
- Batches: fix broken credential validator [#63687](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63687)
- Svelte: Properly load/serve version.json [#63688](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63688)
- Codygateway: tweak enterprise-portal dial options [#63692](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63692)
- Batches: fix broken `ghauth` import [#63693](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63693)
- Svelte: Update cody web [#63710](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63710)
- Better alignemnt of github credentials and check success notice [#63717](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63717)
- Show success notice in the correct area [#63721](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63721)
- Svelte: Prefill search home page query input with (default) context filter [#63740](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63740)
- Remove watch path that's gone [#63746](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63746)
- Batches: enable check for creating source as non credential [#63751](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63751)
- Build: update wolfi image lock for otel [#63755](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63755)
  - Fix(build): update wolfi lock for otel-collector

### Refactor

- Cody: Reshape the `CompletionsClient` interface [#63358](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63358)NA, just some under the hood refactoring that shouldn't impact any functionality.

### Test

- Cody: Add unit tests for the Completions API [#63434](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63434)NA. Just trivial changes and adding more tests.

### Reverts


### Uncategorized

- Gitserver: Sunset Exec endpoint [#62774](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62774)
- Gitserver: Cleanup CreateCommitFromPatch [#62781](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62781)
- [React]: Add initial usage of the new web worker-based cody web chat [#62792](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62792)
- Gitserver: Framework to support integration testing against gitserver [#62801](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62801)
- Feat/internal/memcmd: add internal/memcmd package to allow for memory tracking of exec.Cmd  processes [#62803](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62803)This feature adds a package that allows us to track the memory usage of commands invoked via exec.Cmd.
- Feat(search/svelte): Add context specific suggestions to repo search input [#62880](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62880)
- Feat/cody-gateway: use Enterprise Portal for actor/productsubscriptions [#62934](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62934)
- Reimplement license checks [#63068](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63068)
- Svelte: inject into primary `app.html` [#63088](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63088)
- Syntactic Indexing: add TAR archive indexing mode to scip-syntax CLI [#63097](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63097)
- Add Support for Counting Tokens for Azure Code and Update in Redis [#63100](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63100)
- Enterprise-portal: update RPC for subscription domain and members [#63105](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63105)
- Cody Gateway embeddings: powering with generated metadata - Take 2 [#63112](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63112)
- Fix(Cody Gateway): add model field to Google completion request [#63113](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63113)
- Feat/cmd/gitserver: add memory tracking for both linux and macos [#63114](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63114)Adds a new experimental feature to enable track of `git` command memory invocations when the `GITSERVER_MEMORY_OBSERVATION_ENABLED` environment variable is true (off by default).
- Feat/sg-msp-pg: add suggestion to check msp-ops page on perms error [#63118](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63118)
  - `sg msp pg connect` will tell you about your service's generated Notion page if you run into a permissions-looking error during command setup, where there is guidance about the required Entitle requests.
- Svelte: add sentry [#63126](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63126)
- Sg: deny cloud ephemeral builds from main [#63127](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63127)
  - Deny cloud ephemeral deployments triggered from 'main'
- Svelte: Add bottom panel close button [#63128](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63128)
  - Added bottom panel close button
  - Added 'text' variant to Button component
  - Added 'actions' slot to Tabs component
  - Added Button component stories
- Svelte: Migrate repo sidebar toggle button to use lucide icon [#63129](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63129)
- Bug: update hard coded consts [#63133](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63133)
  - Tmp process: update release consts to 5.4.5099
- Reapply "gitserver(client): Reintroduce 500 maximum connections limit" [#63134](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63134)
- Scim: Fix user updates when SCIM was previously enabled [#63135](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63135)
- Enterprise-portal: rename "scope" to "permission" for query RPC [#63137](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63137)
- Enterprise-portal: init database schema and handler store [#63139](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63139)
- Svelte: allow popovers to have external targets [#63141](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63141)
- Feat/enterprise-portal: rudimentary audit logging [#63142](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63142)
- Build: fixup custom eslint test rule after bump to rules_js 2 [#63143](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63143)
- Remove references to 'rate-limits-exceeded-for-testing' feature flag [#63144](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63144)
- Security: Auto-update package lockfiles for Sourcegraph base images [#63145](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63145)
- Svelte: fix tests [#63146](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63146)
- Gitserver: Remove comment about error checking [#63147](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63147)
- Adds stubs for usage connection resolver [#63156](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63156)
- Feat/enterprise-portal: return all attributes, even when access is disabled [#63159](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63159)
- Webhooks: Update payload testdata and type for Bitbucket Server push events [#63161](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63161)
- Fix/enterprise-portal: ignore empty hashes for Cody Gateway access tokens [#63162](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63162)
- Feat(cody-gateway): add Google Gemini stable models to allowed models [#63163](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63163)
- Feat/msp/runtime: PG_QUERY_LOGGING=true for local dev query logging [#63164](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63164)
  - MSP runtime users can now set `PG_QUERY_LOGGING=true` to dump queries and arguments from database interactions at `DEBUG` level in local dev.
- Msp: encode commit_message as base64 [#63165](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63165)
- Cody Gateway: Add support for Google non-streaming endpoint [#63166](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63166)
- Svelte: add Cody upsell banner [#63167](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63167)
- Chore/cody-gateway: instrument removeUnseenTokens [#63169](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63169)
- Svelte: add footer links for dotcom [#63170](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63170)
- Chore/otel-collector: upgrade to v0.103.0, remove jaegerexporter [#63171](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63171)
  - OpenTelemetry Collector: Upgraded OpenTelemetry Collector to v0.103.0
  - OpenTelemetry Collector: The [deprecated ](https://github.com/open-telemetry/opentelemetry-specification/pull/2858). Users of `exporter: { jaeger: ... }` in the OpenTelemetry Collector should use `exporter: { otlp/jaeger: ... }` to send traces directly to Jaeger via its OTLP receiver.
    - Users of the default Jaeger configurations now need to provide `JAEGER_OTLP_GRPC_PORT` as well as the existing `JAEGER_HOST` configuration.
- Cody Gateway: handle streams with trailing newline in Gemini response [#63172](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63172)
- Enterprise-portal: implement basic MSP IAM and RPCs [#63173](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63173)
- Fix: auth issues with Sourcegraph VSCode extension [#63175](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63175)
  - Entering the URL and access token in the UI now works - No more manual editing of `settings.json`
- Adds a search client to the codenav service [#63180](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63180)
- Feat(search/svelte): Support more file icons [#63181](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63181)
- Dotcom: fix issue with dotcom emails [#63183](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63183)
- Fix(search/svelte): Hide diff view when closing bottom panel [#63184](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63184)
- Extend instructions for running CG locally [#63186](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63186)
- Enterprise-portal: temporarily disable local DB migrate [#63187](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63187)
- SSC: Fix "Make admin" and "Revoke admin" button actions [#63188](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63188)fix(plg): fixed "Make admin" and "Revoke admin" button actions
- Resolve syntactic symbol at request range [#63189](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63189)
- SSC: Fix checkout links [#63190](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63190)fix(plg): make upgrade links point to the right pages for Teams & Invites
- [Svelte]: Fix standard click-based popover flow [#63192](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63192)
- Fix: querying event logs breaks when "id" column value > int32 [#63193](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63193)
  - Address "value out of range" errors when querying the event logs
- Sg: cloud eph - Improve missing tag/version message [#63195](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63195)
  - Sg - Improve messaging when an image is missing from Cloud ephemeral registry
- Adds function to find candidate occurrences via search [#63196](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63196)
- Webhooks: Add support for secrets for Bitbucket Cloud [#63198](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63198)
- Context: detect if README is required [#63199](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63199)
- Sg: cloud eph - Set max deployment name [#63202](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63202)
  - Sg - Set a max length for cloud ephemeral deployment names
- Fix/internal/memcmd: fix goroutine leak in linux observer [#63206](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63206)A goroutine leak in the experimental linux memory observation logic has been fixed.
- Feat/internal/memcmd: ignore context cancellation errors from Stop() [#63208](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63208)
  - Slightly improve logspam from Linux memory observation logic by ignoring context cancellation errors that occur when the user explicitly stopped the observer.
- Use 8B version of llama3 in metadata generation [#63212](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63212)
- Fix/internal/memcmd: close the explicit stop channel before cancelling context [#63214](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63214)This PR fixes a logspam bug in the linux memory observer that was due to do slightly faulty synchronizzation logic.
- Internal: make adding EventsStore middleware easier [#63216](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63216)
- Codenav: use new occurrences API for symbol definitions [#63217](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63217)
- Svelte: remove v1 telemetry [#63220](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63220)
- Svelte: use Inter font for --font-family-base [#63221](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63221)
- Proof-of-concept for Intent detector API [#63228](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63228)
- Add unit test for saml requests with multiple certs [#63229](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63229)
- Chore(search/svelte): Remove dependencies on barrel files to speed up dev build [#63230](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63230)
- PLG: Allow users who are already on a team accept invites [#63231](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63231)
- Svelte: use Roboto Mono as monospace font [#63247](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63247)
- Chore: disable flaky tests [#63251](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63251)
- Svelte: implement keyboard shortcut design [#63253](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63253)
- Svelte: add repo header dropdown menu [#63257](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63257)
- Fix(cody-gateway): Improve prompt and request validation for gemini [#63258](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63258)
- Filters candidate matches against syntactic SCIP documents [#63268](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63268)
- PLG: encode URL search params [#63275](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63275)
- Chore: update goldmark [#63276](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63276)
- Cody Gateway: add gemini model to code completion list [#63278](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63278)
- Adding Anthropic messages API support to the Google provider through Google vertex [#63282](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63282)
- Adding deepseek and lang specific mixtral for completions ab experiment [#63283](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63283)
- Wraps up syntactic usages in resolvers [#63285](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63285)
- Fix(cody-gateway): Disable flagging Google requests [#63295](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63295)
- Svelte: fix sidebar icon alignment [#63296](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63296)
- Fix/graphql/database: make count of failed user permissions syncs ignore soft deleted users [#63297](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63297)
  - The failed user permission sync count on the permission dashboard now properly ignores syncs from deleted users (which is the expected behavior).
- Fix/graphql/database: fix repo permission sync count to ignore soft deleted repositories [#63298](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63298)
  - The failed repository permission sync count on the permission dashboard now properly ignores syncs from deleted repository (which is the expected behavior).
- Feature/internal/database: add test to ensure that not found errors fulfiill errcode.NotFound [#63299](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63299)
  - Added unit tests to ensure that the database userNotFound and RepositoryNotFound error types fulfuill the errcode.NotFound interface.
- Context: simplify file chunk conversion [#63301](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63301)
- Fix/frontend/graphql: log and add trace events for all non-not-found errors that occur when fetching permission syncs [#63302](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63302)
  - Our graphqlAPI now logs and traces any non-not-found errors that occur when fetching permission sync jobs (as opposed to being silently swallowed).
- Feat(cody gateway): code completion support for Google Gemini Flash models [#63303](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63303)feat(cody gateway): code completion support for Google Gemini Flash models
- Fix(cody-gateway): Fix Google flagging configuration [#63305](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63305)
- Fix(cody-gateway): streaming google endpoint [#63306](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63306)
- Syntax-highlighter: Use camino to make handling utf8 paths nicer [#63311](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63311)
- Retry 404 errors from Triton [#63315](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63315)
- Minor: update license wording [#63318](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63318)
- Svelte: repo header followups [#63319](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63319)
- Dotcom: Remove on-demand cloning of repositories [#63321](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63321)Dotcom no longer clones repos on demand.
- Chore: remove search console [#63322](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63322)
- Wip: Introduce `cody-gateway-config` tool for generating model configuration [#63324](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63324)NA, this is an initial step. A later PR will elaborate on the exciting new feature this is enabling.
- V2-telemetry: Simplify sensitive metadata allowlist to accept feature only [#63325](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63325)
- Search: surface pattern type in query input [#63326](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63326)
- Code monitors: respect default pattern type [#63333](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63333)
- Use math/rand/v2 [#63346](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63346)
- Cody pro icon was squashed in the upgrade banner [#63356](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63356)
- Refactor the 'getModel' callbacks into their own file [#63359](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63359)NA
- Fix/msp/postgresqlroles: wait for databases to be provisioned [#63362](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63362)
  - MSP Cloud SQL: Fix race condition between database creation and role grants for the read-only operator access user
- Skip highlighting large lockfiles on all instances, not just dotcom [#63366](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63366)
  - Syntax highlighting is disabled on lockfiles (such as `package-lock.json`) because it is CPU-intensive on these large files and very rarely desirable.
- Allow repo access by default on dotcom [#63367](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63367)
- Clearer access tokens allow check on dotcom [#63368](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63368)
- Nix: use go1.22.4 [#63372](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63372)
- Remove extraneous Cody onboarding steps [#63373](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63373)
- Publish images from patch release branches [#63379](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63379)
- Plg: Make page headers the same style [#63380](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63380)
- Improve InviteUsers interface [#63383](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63383)
- Cody Gateway: New Claude 3.5 Sonnet model [#63395](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63395)feature(plg): new Claude 3.5 Sonnet model support for Cody Pro users
- Search: expose path matches on FileMatch [#63396](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63396)
  - Exposed the matched ranges of a file path via the GraphQL API
- Svelte: Make the byline in the fuzzy finder items bigger [#63398](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63398)
- Msp: add `GetFloat` to runtime `Env` [#63399](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63399)
- Fix(cody-gateway): model id for claude 3.5 sonnet [#63400](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63400)
- Fix(cody-gateway): getAPIURL before transformBody [#63406](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63406)
- Search: always respect default pattern type [#63410](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63410)
- Feat(cody-gateway): add support for Gemini models with context cache [#63413](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63413)
- Rename intent API (add chat reference, make the name more idiomatic) [#63416](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63416)
- Add language ID to private metadata for v2 codeintel events (for in pâ€¦ [#63421](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63421)
- Lib: downgrade GORM to 1.25.6 [#63427](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63427)
- "Cody" in navbar not "Cody AI" [#63429](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63429)
  - In the navbar, Cody is now just "Cody" not "Cody AI".
- Remove Cody "upsells"â€”and all Cody links if Cody is disabled [#63430](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63430)
  - When Cody is disabled in site config (with `"cody.enabled": false`), all links and UI elements about Cody are hidden from all users. Previously, when Cody was disabled, users would see some links informing them about Cody.
- Remove disabled web UI code for embeddings [#63432](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63432)
- Remove rule warning about React props spreading [#63433](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63433)
- Support fast, simple `sg start single-program-experimental-blame-sqs` for local dev [#63435](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63435)
- Config: Various fixes and updating the naming rules for ModelConfig resource IDs [#63436](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63436)
- Remove unused CODY_APP esbuild config and entrypoint [#63438](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63438)
- Remove old and unused Cody search page [#63439](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63439)
- Remove Code Search upsell from Cody page [#63440](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63440)
- Scip-syntax: adds strict SCIP symbol parsing and formatting [#63443](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63443)
- Fix(code hosts): Use more deterministic API endpoints for GitHub code host connections [#63445](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63445)
  - The `"internal"` repositoryQuery for GitHub code host connections now use a more deterministic API that's less susceptible to missing repositories
  - The `"public"` repositoryQuery for GitHub code host connections now make additional requests to fetch missing repository details, like topics. This fixes an issue where repos added by the `"public"` repositoryQuery would have missing repo details
- Add back /post-sign-up [#63456](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63456)
- Add v2 telemetry infrastructure to browser extensions and native inteâ€¦ [#63458](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63458)
- Allow more models to be used in Cody Free [#63459](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63459)
- Gateway: forward X-Fireworks-Genie header from client [#63460](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63460)
- Search-based usages for new codenav API [#63464](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63464)
- Chore(code-search): disable codemonitoring dotcom (jscontext) [#63465](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63465)
- Notebooks: store default pattern type per notebook [#63472](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63472)
- Chore: refactoring occurrence indexing [#63473](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63473)
- Update free tier limits [#63474](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63474)
- Svelte: add debug view for code intel occurrences [#63475](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63475)
- Chore: fix repo stars alignment [#63476](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63476)
- Omit go:embed of big assets from `sg start single-program-experimental-blame-sqs` [#63477](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63477)
- Fix chopped-off tooltips in code monitor query input [#63478](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63478)
  - Fixed an issue when creating or editing a code monitor that obscured helpful tooltips in the query editor.
- Add React key to fragments in code monitoring logs [#63479](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63479)
- Remove beta labels for code monitoring Slack notifs & logs [#63480](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63480)
  - Code monitoring Slack notifications, previously in beta, are now GA. This feature lets you post matching code changes to a Slack channel.
  - Code monitoring logs, previously in beta, are now GA. This feature lets you see the status of and activity related to code monitors to troubleshoot issues with finding results and performing configured actions.
- Shorter PR template [#63481](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63481)
- Cloud: add feature flags to show no edit warning [#63484](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63484)
- Saved searches: use default pattern type [#63487](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63487)
- Search: fix regexp toggle if regexp is default [#63489](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63489)
- Fix azure completions api [#63491](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63491)
- Enable new Cody Web by default [#63493](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63493)
- Msp: split contract into JobContract and ServiceContract [#63494](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63494)
- Svelte: improve contrast for file tree guide line [#63495](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63495)
- Fix/internal/observation: make ErrCollector type threadsafe [#63496](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63496)
  - Fixed a threadsafety issue in the internal/observation.ErrCollector type
- Fix initial context for Cody Web on the repository page [#63497](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63497)
- Cody Web: Fix Cody page for signed out users [#63498](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63498)
- Cloud: update feature flag warning severity [#63499](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63499)n/a
- Svelte: rev picker design updates and addition to commits page [#63506](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63506)
- Oops, fix Cody Web enablement [#63508](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63508)
- Fix Cody nav link for unauthed dotcom users [#63510](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63510)
- Looser eslint rules [#63511](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63511)
- Remove unused CTAs [#63512](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63512)
- Misc wording and UI tweaks to search contexts pages [#63513](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63513)
- Make Cody and Code Search global navbar items one-click [#63514](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63514)
  - Code Search and Cody now are one-click links in the global navbar. Other features are in the new "Tools" menu: search contexts, code monitors, search jobs, and notebooks. Your Cody dashboard is linked from your user menu (in the top right).
- Bump `cody-web-experimental` package version [#63525](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63525)
- Sg: generate github action subscription matrix dynamically [#63526](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63526)
- Backend: Introduce a basic utils package for appliance sourcegraph upgrades [#63529](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63529)
- Link to Cody chat on the web from the Cody manage page [#63530](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63530)
- Feature: Data types for encoding LLM Model config via Sourcegraph site config [#63533](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63533)
- Release: resource def jaeger [#63534](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63534)
- Release: resource def grafana [#63535](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63535)
- Scip-syntax: implements parallel processing for workspace and tar commands [#63536](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63536)
- Add LazyQueryInputFormControl, remove duplicated common pattern [#63537](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63537)
- Fetch User.id to suppress GraphQL cache warning [#63538](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63538)
- Fix(sg/bazel-do): use ci.sourcegraph.bazelrc with bazel-do [#63545](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63545)
  - Sg - Ensure bazel-do invocations use the ci sourcegraph bazelrc
- (chore)analytics: consistent naming of web code copied events [#63550](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63550)
- Update config for workflows 5.10 [#63554](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63554)
- Chore(search) VSCode Search extension: Update README and CHANGELOG [#63562](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63562)
- Perf(scip-syntax): uses the same parse tree for globals and locals [#63564](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63564)
- Make `<Label>` element focus & select at end to match native label behavior [#63568](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63568)
- Fix bug preventing site admins from directly adding org members when email.smtp was set [#63569](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63569)
  - Fixed a bug where site admins could not directly add users to an organization if (1) email sending was configured for the instance and (2) the user had no verified email address.
- Cosmetic improvements to OrgSettingsMemberPage, UserEmail [#63570](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63570)
  - Minor cosmetic improvements to the pages for managing organization members and user email addresses.
- Narrow NamespaceProps type [#63571](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63571)
- Suppress ResizeObserver type error [#63572](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63572)
- Marks search-based usages as definitions or references [#63576](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63576)
- Insights: persist patternType in db [#63579](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63579)
- Syntactic indexing produce scip files [#63580](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63580)
- Chore: Calendar Updates [#63583](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63583)
  - Chore(release): Update calendar events until September
  - Chore(release): Remove branch cut automation from `calendar.go`
- Cody context: fix an issue with anchoring repo names [#63585](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63585)
  - Fixes a bug that caused context to be fetched for Cody from irrelevant repos
- Feature: migrate maintenance from sourcegraph-operator-ui [#63586](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63586)
- Search: restore snippets to filters sidebar [#63587](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63587)
  - Restores search snippets in the search sidebar
- Clean up FilteredConnection filter types and code [#63590](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63590)
- Add a better Cody client server-sent configuration mechanism [#63591](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63591)
- Fetch NamespaceSelector namespaces from GraphQL (`viewer { affiliatedNamespaces }`) [#63592](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63592)
- Implement UI for Github Apps - Batch Changes integration [#63597](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63597)
- Trivial additions [#63601](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63601)NA
- Fix/cody-gateway: use keepalive/idle timeout options for Enterprise Portal [#63605](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63605)
- Security: Auto-update package lockfiles for Sourcegraph base images [#63606](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63606)
- Remove autocomplete limit from Cody dashboard page [#63609](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63609)
- Adds a test for search-based usages [#63610](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63610)
- Fix(perforce) Fix support for p4breaker workaround scripts [#63611](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63611)
  - Fixed an issue where Sourcegraph would no longer be able to decode Perforce permissions if `p4broker` is used, provided that the filter script gets adjusted as well.
- Vsce: patch release v2.2.17 [#63617](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63617)
- Add SourcegraphModelConfig.AccessToken [#63619](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63619)NA
- Svelte: add mutation observer to `sizeToFit` [#63620](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63620)
- Pick up CompletionsConfig.User for the AzureOpenAI API Provider [#63621](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63621)NA
- Fix annoying consistency [#63623](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63623)NA
- Fix/client/dev: update proxy overwrite to respect authProviders [#63624](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63624)
- Codygateway: Use only one redis pool and make REDIS_ENDPOINT a clear requirement in config [#63625](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63625)
- Add GenericProviderConfig.ServiceName [#63626](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63626)NA
- Documents that usages are first bucketed by provenance [#63629](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63629)
- Fix the scheduling interval for syntactic indexing [#63634](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63634)
- Adds Option for codeintel [#63637](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63637)
- Docs: Fix inaccuracies in RangeInput GraphQL docs [#63640](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63640)
- Add ModelRef.APIVersionID() [#63643](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63643)NA
- Rcache: Explicitly pass redis pool to use [#63644](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63644)
- Remove old cache cleanup method [#63645](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63645)
- Remove unused package [#63646](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63646)
- Unexport some externally irrelevant symbols from uploadstore [#63647](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63647)
- Add new "modelConfiguration" schema to site config [#63654](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63654)Changelog entry will come later with proper docs link, when we are ready for customers to use this.
- Convert Appliance Maintenance UI to Bazel [#63661](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63661)
- Notebooks: set default pattern type to keyword [#63662](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63662)
- Remove long-unused UI routes [#63670](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63670)
- Add database.NotFoundError helper type [#63671](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63671)
- Improve FilteredConnection filter types [#63672](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63672)
- Bump code-web-experimental version to 0.2.0 [#63675](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63675)
- Scheduler: Simplify query for uncloned repos [#63681](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63681)
- Phabricator: Move syncer to worker [#63682](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63682)
- React app: bump cody web to 0.2.1 [#63694](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63694)
- Svelte: encode path components in file header [#63695](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63695)
- Site config: minor fixes, make modelConfiguration enable new backend models API, initial self-hosted model config [#63697](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63697)N/A
- Searcher: Modernize entrypoint and gRPC server [#63700](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63700)
- Adding deepseek-v2 and deepseek fine-tuned model trained on symbol graph context [#63702](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63702)
- Modelconfig: handle converting site config JSON -> internal data types [#63706](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63706)Has no effect on users unless they opt into the early-access `"modelConfiguration"` site config feature.
- Symbols: Minor code cleanup [#63708](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63708)
- Sg: when in CI we do not need to prompt for an identity [#63712](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63712)
- Update changelog: Keyword search GA [#63715](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63715)
- Keyword search: remove beta badge [#63720](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63720)
- Cody Web: bump cody web to 0.2.3 [#63723](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63723)
- Backend: add line index [#63726](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63726)
- Squirrel: Correctly use request context [#63729](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63729)
- Several refactoring to prepare for rolling out modelconfig [#63731](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63731)NA
- Symbols: Make symbols specific code internal [#63736](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63736)
- Chore: remove gorilla/schema [#63738](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63738)
- Pass ModelConfigInfo down to client.Get() for self-hosted-models [#63739](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63739)N/A
- Bump cody-web-experimental to 0.2.4 [#63742](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63742)
- Feat(sg/cloud): trigger build on cloud-ephemeral pipeline [#63748](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63748)
  - `sg cloud eph` will now trigger builds on the `cloud-ephemeral` pipeline
- Chore(security) : upgrade src-cli version to address CVE [#63750](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63750)Upgrade src-cli version to 5.4.0 to address CVE-2024-24790 , CVE-2023-45288

# v5.4.7765

{/* RSS={"version":"v5.4.7765", "releasedAt": "2024-06-20"} */}

### Reverts

### Uncategorized

- [63131](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63131) [Backport 5.4.5099] scim: Fix random suffix added to every user on resync
- [63148](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63148) [Backport 5.4.5099] fix(release): remove generate-notes from github râ€¦
  - Remove `generate-notes` cli flag when promoting releases
  - Push only a single tag
  - Fix token name used in changelog generation
  - Tag creation on release is idempotent, even in environments that cache the git repository (e.g. buildkite runners)
- [63152](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63152) [Backport 5.4.5099] chore(release): remind releasers of tag pipeline
  - Remind releasers of tag pipeline as final step. Backport 2be933cda9ac893f44d3da308052cce8be70cb7c from #63150
- [63178](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63178) [Backport 5.4.5099] release: never use build number in image family Backport 8bb0ab54ebbf4c7d356397dc0da29cb98ea3e14f from #63157
- [63392](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63392) [Backport 5.4.5099] chore(tooling): bump Go version to 1.22.4
  - Bumped version of Go used to build to 1.22.4
 Backport bb178ba729d160d834bf7fcbb4414f0f95e4d0df from #63124

# v5.4.5099

{/* RSS={"version":"v5.4.5099", "releasedAt": "2024-06-06"} */}

### Chore

- [61969](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61969) bazel: enable rules_esbuild sandbox with object-inspect workaround
- [62089](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62089) rel: fix tests not waiting for push prod
- [62511](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62511) rel: bump minor for stitch graph + add support invalidating migrations repo rule
- [62522](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62522) Rename function to reduce confusion
- [62527](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62527) Fix function name in comment
- [62529](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62529) Document post-condition for upload matching
- [62530](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62530) Rename locals id -> uploadID, dump -> upload
- [62532](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62532) fix typos
- [62537](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62537) Inline method at single usage site
- [62539](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62539) remove overridden repository cache flag from bazelrc
- [62540](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62540) Make receiver names consistent in codenav/service.go
- [62542](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62542) Add missing interface assertion for codenav Resolver
- [62543](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62543) Move helper function to database package
- [62544](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62544) ci: Remove dead boards
- [62573](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62573) Refactor codeintel middleware code
- [62587](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62587) Expose ParsePersonalAccessToken publicly for src-cli
- [62593](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62593) Use SRC_ACCESS_TOKEN for uploading indexes
- [62595](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62595) Stop uploading indexes to k8s.sgdev.org
- [62623](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62623) ci: bump backcompat target to 5.4.0
- [62658](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62658) ci: remove backcompat mitigation
- [62680](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62680) localenv: disable `tsc` declaration files
- [62714](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62714) Move cmd/searcher/protocol to internal/searcher/protocol
- [62718](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62718) ci: rules_buf 1.31
- [62719](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62719) process: add structure guide for PRs
- [62753](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62753) Bump autoindexing image SHAs
- [62755](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62755) Simplify extsvc config in integration tests
- [62762](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62762) licenses: fix khroma and elkjs
- [62768](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62768) Factor out logic for modifying site config
- [62780](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62780) Document how to load test highlighter
- [62789](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62789) Remove client construction from SignUp/In funcs
- [62820](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62820) skip failing tests
- [62853](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62853) Pull in latest http-server-stabilizer version
- [62857](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62857) gha: link to how-to when license check fail
- [62878](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62878) rel: plug automatic changelog generation (RFC912)
- [62902](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62902) release: add changelog section to pr template
  - Added instructions to guide teamates into writing changelog entries directly in their PR descriptions.
- [62921](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62921) Bump Rust version 1.73.0 -> 1.78.0
- [62922](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62922) Delete old Dockerfile and build scripts
- [62925](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62925) sg: cloud ephemeral - Account for conclusion field
- [62938](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62938) release: quick fix latest version after release
  - Bump latest version reported by dotcom
- [62943](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62943) local: catch bazel-do issues before push
  - Prevent pushing Bazel commands/flags that would end up being rejected by the CI due to the allow list.
- [62959](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62959) appliance: scaffolding for embeddings service
  - Add config scaffolding for embeddings service.
- [62962](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62962) dev: shorten test plan in PR template
  - Test plan has been in place for a long time, so we can get rid of the detailed instructions.
- [62988](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62988) sg: cloud ephemeral fix instance check
  - Fix cloud ephemeral deployment check
- [62992](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62992) Add tests documenting error invariants
- [62996](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62996) Remove unused code in errors package
- [62998](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62998) ci: fix PR template's changelog type list
- [62999](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62999) appliance: fix race condition in tests
  - Fix a race condition in one package's tests.
- [63001](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63001) bazel: update ownership tags to increase coverage
- [63020](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63020) productsubscription: add metric tracking usage
- [63025](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63025) Enable traces for uploads
  - Tracing is enabled for all SCIP index uploads by default
- [63027](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63027) Remove unused code for precise defs by symbol
- [63029](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63029) Use new cmp package to simplify comparisons
- [63030](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63030) Remove unused codeintel utils code
- [63040](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63040) Simplify RequestState/PositionalRequestArgs o11y code
- [63045](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63045) enterpriseportal: add instrumentation for RPC handlers
- [63046](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63046) Temporarily disable syntactic indexing worker job
- [63047](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63047) Replace errors.As with generic As and AsInterface
- [63052](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63052) msp: blindly retry Notion page deletion
- [63056](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63056) Make GetDefinitions API consistent with GetReferences etc.
- [63059](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63059) codeintel: usagesForSymbol - Make start/end non-optional for now
- [63060](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63060) codeintel: Document prepareCandidateUploads function
- [63061](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63061) codeintel: Simplify map[T]struct{} logic to use Set
- [63062](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63062) Rename Contains to IsSupersetOf
- [63070](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63070) pnpm: add telemetry package
  - Add missing telemetry package to pnpm lock file
- [63085](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63085) upgrade to latest rules_oci 1.x-
- [63094](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63094) sg: move `registry list` cmd to `release list`
- [63103](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63103) graph: Add changelog entry for Python scip-ctags fix

### CI

- [62823](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62823) fix test issues on main

### Feat

- [60761](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60761) make display limit configurable from user settings
- [62268](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62268) introduce new workflow to restrict image sizes for docs
- [62452](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62452) popover to configure editor
- [62531](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62531) Add new GraphQL API for getting occurrences
- [62704](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62704) msp: do not use tfvars file outside of deploy-type 'subscription'
- [62708](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62708) ci: docker-images runtype
- [62756](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62756) incomplete datapoints can now resolve the affected repositories
- [62772](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62772) sg: handle interrupts more gracefully
- [62802](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62802) cody: new site config for smart context
- [62877](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62877) bazel: `//cmd/{frontend,server}` targets that don't include client bundle for backend integration tests
- [62883](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62883) sg: add 'sg sams' commands 'create-client-token' and 'introspect-token'
- [62912](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62912) enterprise: make per-subscription model allowlists no-op
- [62945](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62945) local: add cloud ephemeral dashboard command
  - `cloud eph dashboard/dash` opens up the cloud ephemeral dashboard
  - `cloud eph ops [--name <instance>]` opens up the ops page for the deployment of the current branch or for the instance specified as a flag
- [62961](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62961) search: Add inline file search to Svelte app
  - Refactored the existing CodeMirror extension to allow UI customization
  - Moved utility functions around to avoid loading all of wildcard into the prototype (which lead to build errors)
  - Tweaked the new icon component to better align within buttons (I missed that in #62908 because I didn't test it within buttons)
  - Noticed that button group styles didn't apply correctly and the reason seemed to be that we were mixing sveltekit and react styles. So I copied the button styles into the sveltekit app.
  - Added a switch component, following [https://web.dev/articles/building/a-switch-component](https://web.dev/articles/building/a-switch-component) .2024-05-29_12-58
- [62964](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62964) appliance: deploy worker
  - Deploys the Worker service.
- [62965](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62965) codeintel: If SignatureDocumentation is present in SCIP, use it for hover text
  - The backend now respects the SCIP [signature_documentation](https://github.com/sourcegraph/scip/blob/main/scip.proto#L409-L415) field, and if available, uses that to create the initial part of the hover text. SCIP indexers should not repeat the text in signature_documentation inside the documentation field.
- [62970](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62970) sg: add version=auto for `sg release cut`
  - Add `--version=auto` to `sg release cut`
- [62985](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62985) ci: add GHA to report when Bazel test ownership drops below 70% threshold
- [62994](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62994) msp: use pgxpool instead of pgx.Conn
  - The MSP runtime `lib/managedservicesplatform/contract.Contract`'s `ConnectToDatabase(...)` has been renamed to `GetConnectionPool(...)`, and now returns a `*pgxpool.Pool` instead of a `*pgx.Conn`
  - The MSP runtime `lib/managedservicesplatform/cloudsql` helper library's `Connect(...)` has been renamed to `GetConnectionPool(...)`, and now returns a `*pgxpool.Pool` instead of a `*pgx.Conn`
- [63011](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63011) msp: add link to ops page in Slack channel description
  - MSP-provisioned alerts Slack channels now include a link to the service's generated operational docs for a service (go/msp-ops) in the channel description.
- [63033](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63033) release: rename code freeze event to `branch cut` event
  - Rename the calendar event `Code Freeze:` to `Branch Cut:`
- [63034](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63034) release: allow creation of multiple patch release events
  - Multiple patch events can now be created with the `sg release cal` command
- [63042](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63042) appliance: deploy codeinsights-dbAdd optional diff extra args to compare-helmI wanted this to do `diff --side-by-side`, may as well commit it as a
feature.feat(appliance): deploy codeinsights-dbReady for review, but draft until base branch merged.
- [63069](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63069) sg: respect the context when executing interrupt hooks
  - Hard exit sg when 5 intterupt hooks are received
  - Respect the context while executing interrupt hooks to ensure we still exit if some hook is misbehaving
- [63071](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63071) sg: add `list-build` subcommand to ci
  - Add `list-builds` subcommand to sg to list builds in various states
- [63089](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63089) msp: update handbook link in alerts dashboard, sort custom alerts first

### Fix

- [62415](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62415) Correctly filter uploads with commit and path existence checks
- [62505](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62505) deprecation in pkg call
- [62758](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62758) update links for dev docs
- [62779](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62779) Show full info for highlighter errors
- [62788](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62788) backporting
- [62817](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62817) Make most syntaxHighlighting config fields optional
- [62928](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62928) local: panic in sg ci preview
- [62947](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62947) sg: fix error condition for cloud eph deployment that already exists
  - Deny creating a deployment if a deployment with that name already exists
- [62949](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62949) telemetry: fix dotcom-mode sensitive metadata removal
- [62960](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62960) Initialize operation for UsagesForSymbol
  - Fixed a bug in stub implementation of UsagesForSymbol
- [62963](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62963) Icon auto-import in Bazel
- [62969](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62969) msp: test for cron interval changes based on time, add more restrictions
  - Fixed an issue with output of `sg msp generate` for MSP jobs with particular schedules changing throughout the week
  - MSP jobs schedules now must be between 15 minutes at the most frequent, and every week at the least frequent
- [62989](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62989) sg: cloud eph - Do not fail just because we cannot parse reason
  - Gracefully handle when we can't parse the reason in cloud ephemeral
- [63017](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63017) msp: make deadlineSeconds job-level configuration, apply in timeout
  - MSP jobs: `schedule.deadline` is deprecated, use the top-level `deadlineSeconds` instead. Configured deadlines are now correctly applied as the Cloud Run job execution timeout as well.
- [63058](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63058) enterpriseportal: fix registration of connectRPC handler options
- [63084](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63084) msp: flatten custom alert promQL query for GCP
- [63109](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63109) gateway: update Google model names in allowed custom chat models

### Reverts

- [#62684](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62684) Revert "Svelte [RepoPopover]: Instantiate the RepoPopover result across the web-app

### Uncategorized

- [61808](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61808) v2t: add v2t to src/teams
- [61968](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61968) Create a shared Cody Ignore dataset
- [61989](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61989) Svelte [RepoPopover]: Instantiate the RepoPopover result across the web-app
- [62107](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62107) gitserver: Implement Stat and ReadDir in gRPC API
- [62136](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62136) lib: upgrade `Routine` interface with context and errors
- [62252](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62252) gitserver: grpc: port DiffSymbols from client as new GitBackend.ChangedFiles() func
- [62262](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62262) gitserver: grpc: create changed files RPC implementation for gRPC server
- [62263](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62263) lib: initial service API for RFC 885
- [62322](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62322) Migrate "New Cody Subscription" page
- [62354](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62354) gitserver: grpc: add new ChangedFiles method to gitserver client
- [62355](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62355) symbols: replace usage of gitserver client's DiffSymbols method with new ChangedFiles method
- [62358](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62358) searcher: replace usage of gitserver.DiffSymbols with new gitserver.ChangedFiles client method
- [62359](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62359) worker: embeddings: replace usage of old gitserver.DiffSymbols client method with new gitserver.ChangedFiles method
- [62360](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62360) gitserver: grpc: remove now unused DiffSymbols func
- [62363](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62363) searcher: remove unused diff.ParseGitDiffNameStatus package
- [62364](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62364) v2t: add v2t to client/branded
- [62413](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62413) SG-61976 - Run a test to remove steps from the new user signup flow
- [62453](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62453) SSC: Teams and Invites: Create "Manage team" page
- [62456](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62456) sg: cloud ephemeral check if deployment exists already
- [62457](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62457) svelte: Reduce imported global CSS
- [62472](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62472) Add access request enabled check in backend redirect
- [62473](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62473) Svelte: implement symbol redesign
- [62474](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62474) Svelte: fix badge centering
- [62476](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62476) sg: skip honey event duration if event is nil
- [62485](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62485) Syntactic indexing: enqueuer and scheduler
- [62487](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62487) always add patch number when cutting branch
- [62489](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62489) sg+ci: cloud ephemeral annotation
- [62491](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62491) Cody PLG: Change fine-tuned model identifier for completions
- [62494](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62494) svelte: First pass on fuzzy finder
- [62498](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62498) Svelte: Implement and instantiate FilePopover
- [62501](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62501) telemetry: improve logging on RecordEvents errors
- [62502](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62502) appliance: deploy redis services
- [62503](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62503) Fix panic on startup
- [62504](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62504) gomod: Bump zoekt for UseKeywordScoring rename
- [62508](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62508) msp: add infra and runtime support for job checkins
- [62510](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62510) Rockskip: simplify ruler function
- [62512](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62512) appliance: add pgsql service definition
- [62513](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62513) gitserver: Implement CommitsUniqueToBranch using Commits
- [62514](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62514) gitserver: Move CommitsUniqueToBranch to callsite
- [62518](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62518) gitserver: Implement CommitLog using Commits
- [62519](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62519) gitserver: Always use Commits in HasCommitAfter
- [62520](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62520) gitserver: Move implementation of HasCommitAfter to caller
- [62521](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62521) dev: add support for project modifier
- [62523](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62523) Auto-update package lockfiles for Sourcegraph base images
- [62524](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62524) msp: export Cloud SQL conection internals for direct usage
- [62525](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62525) enterprise-portal: initialize service with dotcom DB connection
- [62526](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62526) gitserver: Add basic tests for repositoryservice
- [62533](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62533) sg: cloud ephemeral - Add build and upgrade commands
- [62534](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62534) Svelte: Visual updates to diff summary
- [62536](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62536) Svelte: Styling updates to search filters
- [62538](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62538) svelte: Fix file tree behavior
- [62541](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62541) release: return an error when promoting a dev release
- [62545](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62545) Cody Ignore: use "cache-and-network" fetch policy for context filters query
- [62548](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62548) Gitserver: add `StatusTypeChanged` to supported statuses in `ChangedFiles`
- [62549](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62549) Rockskip: test getHops function
- [62552](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62552) release: pass in `IS_DEVELOPMENT_RELEASE` flag to buildkite
- [62555](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62555) sg gen buf: fix completions
- [62557](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62557) Rockskip: refactor metrics registration
- [62559](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62559) msp: grant 'sso' team read access to MSP workspaces
- [62561](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62561) gitserver: grpc: fixup and add tests for GetCommit RPC
- [62562](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62562) release(5.4.0): update changelog
- [62563](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62563) gitserver: client: grpc: add tests for GetObject
- [62564](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62564) gitserver: grpc: create proto roundtrip tests for GetObject[Request/Response]
- [62565](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62565) sg msp tfc sync: support applying to all services
- [62566](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62566) sg+release: push releases to the cloud ephemeral registry too
- [62567](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62567) rockskip: ruler function is just bits.TrailingZeros
- [62568](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62568) sg: cloud - Remove wip notice for ephemeral commands
- [62569](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62569) sg: cloud - Move all cloud ephemeral commands to a sub command `ephemeral`
- [62570](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62570) appliance: deploy syntect-server
- [62574](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62574) [Svelte]: Hide suggestion UI after query was submitted
- [62576](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62576) PR feedback followup
- [62580](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62580) msp: add option to respect existing run mode
- [62581](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62581) Rockskip: add search tests
- [62583](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62583) Render Jupyter notebooks
- [62585](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62585) Svelte: First run on file tree visual update
- [62586](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62586) v2t: add v2 telemetry to the client/shared folder
- [62588](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62588) PLG-590 - Add 16px margin between the "$9/month" and CTA
- [62592](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62592) Move syntactic indexing toggle to site config
- [62594](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62594) conf: redact `scim.authToken` in site config UI
- [62596](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62596) sg: add cloud deploy pubsub notifications
- [62598](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62598) build-tracker: emit agent state-change webhook events to BigQuery
- [62602](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62602) gitserver: Make ReadDir return an iterator on client side
- [62603](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62603) gitserver: Fix duration reported for ChangedFiles
- [62604](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62604) msp: centralize and expose locations configuration
- [62605](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62605) Web: small style fix for jupyter notebooks
- [62606](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62606) gitserver: Add CommitLog API to replace client-side Commits
- [62607](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62607) msp: add incident response starter guide, Notion-specific formatting
- [62608](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62608) Fixup parseDirectoryChildren replacement
- [62609](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62609) gitserver: Add API to enumerate repos on disk
- [62610](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62610) gitserver: Move repo timestamp updates to caller
- [62611](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62611) gitserver: Implement LatestCommitTimestamp in backend
- [62612](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62612) gitserver: Implement RefHash in backend
- [62613](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62613) gitserver: Use the same GitBackendSource for all code paths
- [62614](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62614) gitserver: Move removal of stray tmp pack files to janitor
- [62615](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62615) gitserver: Reduce number of git config invocations
- [62616](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62616) gitserver: Move spec arg safety check into git layer
- [62620](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62620) gitserver: Fixup error codes for ReadDir
- [62624](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62624) appliance: deploy precise-code-intel
- [62625](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62625) Remove SCIP upload to dogfood host
- [62627](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62627) build-tracker: use repeated type for agent queues + deref strings
- [62632](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62632) build-tracker: fix handling of agent webhooks
- [62636](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62636) sg: upgrade sentry
- [62637](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62637) Python notebooks: fix anchor offset
- [62638](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62638) Update broken link for our Development docs in the README file
- [62639](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62639) LLM Models: add GPT-4o support
- [62641](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62641) msp: fix bad formatting
- [62642](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62642) URL Path Escape Model Name
- [62643](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62643) Context: more precise chunk sizing
- [62644](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62644) msp: use new in-terraform custom target provisioning
- [62646](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62646) dev: add /-/healthz endpoint
- [62650](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62650) msp: upgrade to 1.7.5
- [62659](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62659) sg: fix typo in exernal_health_check description
- [62660](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62660) appliance: fix panic on reconcile
- [62664](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62664) bazel: transcribe test ownership to bazel tags
- [62665](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62665) web: Cycle through in-file search results when pressing the numpad enter key
- [62667](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62667) Update HubSpot contacts integration
- [62668](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62668) appliance: default storageclass is nil
- [62669](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62669) Bump zoekt for iterator optimization
- [62670](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62670) build-tracker: include timestamp in agent state change events
- [62672](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62672) inference: Add missing defer
- [62675](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62675) sg msp: add category flag for 'tfc sync'
- [62678](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62678) Web: add mermaid diagram rendering
- [62679](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62679) Docs: update integration test instructions
- [62681](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62681) Svelte: follow up on display limit TODO
- [62682](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62682) Svelte: update navigation bar for dotcom deployment
- [62688](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62688) Auto-update package lockfiles for Sourcegraph base images
- [62690](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62690) Cody Ignore: set lower client version constraint to enable clients testing
- [62694](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62694) SSC: Refactor team management
- [62700](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62700) Bump minimum src-cli version required
- [62701](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62701) fix/telemetry(auth): return authenticated context from session.SetActorFromUser
- [62702](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62702) sg: add repo annotation to delivery pipeline
- [62703](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62703) sg: clarify `repository` annotation meaning in delivery pipeline
- [62705](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62705) gitserver: Allow multiple ranges to be passed to Commits
- [62706](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62706) feat/enterprise-portal: DB layer for \{Get/List\}CodyGatewayAccess
- [62709](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62709) gitserver: Use git-diff-tree to simplify validation and improve security
- [62710](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62710) observability: Fix error checks in ErrorsFilter
- [62711](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62711) inference: Fix regression for non-absolute commit ID
- [62712](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62712) gitserver: Adjust buckets for cleanup timing
- [62715](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62715) Add Cody Pro REST API client library
- [62716](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62716) Cody Ignore: lower version constraint fot test mode
- [62717](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62717) docs: Add CHANGELOG entry for SRC_ACCESS_TOKEN
- [62720](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62720) Client Compatible Bedrock ARN handling
- [62724](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62724) Svelte: Increase search suggestions font size
- [62726](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62726) svelte: Fix various z-index/layering issues
- [62727](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62727) sg: fix `CustomTargetType` reference in `Target` definition
- [62728](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62728) docs: Add link to Entitle permission
- [62729](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62729) svelte: Show correct keyboard shortcut on Linux in "search files" button
- [62730](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62730) appliance: split reconciler package into subpackage
- [62731](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62731) appliance: initial smoke testing harness
- [62732](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62732) appliance: fix test flakiness when container env vars are specified
- [62734](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62734) rockskip: Replace second long-running process with gRPC API
- [62735](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62735) feat(sg/repoferee): add security command with `repo-report` subcommand to fetch latest repoferee report
- [62736](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62736) sg msp: only generate skaffold assets if last stage of rollouts
- [62738](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62738) Fix issue in SAMS account disambiguation
- [62742](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62742) msp: add commit attribute to rollout
- [62743](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62743) gitserver: Remove and deprecate no_timeout option from exec
- [62744](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62744) Svelte: unrevert `RepoPopover`
- [62745](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62745) gitserver: Fix Diff generation
- [62746](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62746) feat/sg-msp: add more stats to 'fleet' command
- [62748](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62748) Chore: add changelog entries
- [62749](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62749) security: Auto-update package lockfiles for Sourcegraph base images
- [62754](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62754) PLG: migrate subscription management page
- [62757](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62757) Change chat defaults to Sonnet and autocomplete defaults to StarCoder or Haiku
- [62759](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62759) authz: Fix panic when auth provider is missing
- [62761](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62761) Fix up "Manage team" page UI
- [62763](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62763) Fix a condition I negated by accident
- [62764](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62764) fix(sg/eph): handle nil regex
- [62769](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62769) bazel: Cleanup oci_deps.bzl
- [62771](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62771) feat/enterprise-portal: ConnectRPC layer for \{Get/List\}CodyGatewayAccess
- [62773](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62773) gitserver: Deprecate Exec and remove localGit
- [62775](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62775) gitserver: Switch corruption logs to use separate file
- [62776](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62776) gitserver: Made git GC recloning less dependent on time
- [62778](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62778) repoupdater: Add retry policy to repositoryservice
- [62782](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62782) gitserver: Remove unnecessary redaction
- [62787](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62787) gitserver: Clean up some errors from improper API usage
- [62790](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62790) Make SSC base url dynamic
- [62794](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62794) Change "Remove" button to a regular button
- [62795](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62795) sg: cloud ephemeral - Handle empty times better and santizes name better
- [62797](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62797) Add missing API types
- [62798](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62798) Fix auth-related error in the SSC REST API client hook
- [62800](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62800) gitserver: Fix postrepoactions for repos with many refs
- [62816](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62816) Update changelog for 5.4.2198
- [62818](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62818) SSC: Three small fixes for Teams & invites
- [62819](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62819) Chore: add changelog entry for #62597
- [62822](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62822) svelte: Preserve current revision in repo search input
- [62825](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62825) gitserver: Add observability to chunked messages
- [62828](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62828) gitserver: Fix CommitLog on some git versions
- [62829](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62829) Svelte: add default badge to default branch
- [62830](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62830) Update sensitive metadata allowlist to filter on keys
- [62831](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62831) Remove misleading logic to add credentials to clone URL
- [62832](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62832) svelte: Add tailling space to default repo search input
- [62834](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62834) Svelte: remove site-admin-only data from repo popover
- [62835](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62835) Fix woes related to undefined frontendCodyProConfig.sscBaseUrl
- [62837](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62837) syncer: Fix issues causing excessive fetches
- [62838](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62838) adding finetuned model setup
- [62839](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62839) Add default values for CG config so it starts
- [62841](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62841) svelte: Show correct byline when commit has author and committer
- [62842](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62842) svelte: Improve commit page loading state
- [62843](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62843) sg: cloud ephemeral - Only push one tag
- [62844](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62844) sg: cloud ephemeral - Various small fixes
- [62845](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62845) appliance: fix syntect service account name
- [62852](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62852) Make the URL dynamic, now with a fallback
- [62854](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62854) sg: remove debugging printlns
- [62858](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62858) SSC: Fix invite date formatting
- [62859](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62859) Update missing changelog element for 5.4.2198
- [62860](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62860) SSC: Fix notification colors
- [62862](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62862) Svelte: linkify and wrap dir entries
- [62864](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62864) worker: Reduce frequency of very frequently run jobs
- [62865](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62865) Svelte: add repo popovers to repo name in header and in dynamic filters
- [62866](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62866) svelte: Fix failing/skipped playwright tests
- [62867](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62867) Svelte: add copy button and reduce spacing
- [62868](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62868) gitserver: Implement Perforce changelist ID mapper as standalone job
- [62869](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62869) Refresh SAMS access tokens as needed
- [62870](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62870) codeintel-service-def
- [62871](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62871) perforce: Add fallback logic for changelist mapper
- [62872](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62872) fix/msp/spec: validate against LivenessInterval that is too high
- [62874](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62874) bazel: bump to latest aspect_rules_js, rules_nodejs, aspect_bazel_lib, aspect_rules_ts, aspect_rules_swc
- [62875](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62875) sg: cloud eph - Api now requires env during list
- [62876](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62876) appliance: deploy prometheus
- [62881](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62881) sg: cloud use new status reason format
- [62882](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62882) Update blobstore package to remove unused port + ssl properties
- [62884](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62884) Embeddings: silence worker log warnings
- [62885](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62885) sg: support for super-simple alerts on custom metrics
- [62887](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62887) Update release calendar
- [62888](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62888) SSC: Handle "Accept invite" calls
- [62890](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62890) Pings: Update hardcoded latest release strings
- [62891](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62891) repo-updater: Hydrate schedule on startup
- [62893](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62893) bazel: Add container test for s3proxy
- [62894](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62894) Log all prompts from specific users
- [62896](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62896) svelte: Fix GraphQL error on contributors page
- [62897](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62897) docs: Add tips for highlighter queries and test cases
- [62898](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62898) sg: fix init prompts breaking when encountering whitespace
- [62899](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62899) svelte: Add link to code-graph page to repo navigation
- [62900](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62900) svelte: Format code
- [62901](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62901) svelte: Allow closing the diff and commit view from the history panel
- [62903](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62903) appliance: move storage elements to standard feature
- [62906](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62906) SSC: Handle `team=1` input on checkout form
- [62907](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62907) s3proxy: Fix permissions on s3proxy package binary
- [62908](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62908) svelte: Add lucide icons and new icon API
- [62909](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62909) feat/cody-gateway: support wildcard models
- [62911](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62911) feat/cody-gateway: use wildcard for enterprise allowlists
- [62913](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62913) lib: `CombineRoutine.Start` should not wait
- [62914](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62914) gitserver: grpc: change gitserver ReadFileRequest.Path type to bytes from string
- [62915](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62915) gitserver: grpc: change FileNotFoundPayload path field from string to bytes
- [62916](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62916) gitserver: grpc: Change BlameRequest Path field from string to bytes
- [62917](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62917) gitserver: grpc: relax BlameAuthor name field to allow arbitrary byte sequences
- [62918](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62918) gitserver: grpc: add comment to Stat implementation explaining why we cast the Path field to []byte
- [62920](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62920) privateApp to set `first_source_url` contact property on HubSpot
- [62926](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62926) codeintel: Add stub implementation for usagesForSymbol API
- [62927](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62927) Support Google Gemini through AI Studio
- [62929](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62929) sg: cloud ephemeral - Handle multiple job reasons
- [62930](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62930) bazel: add utility macro for wrapping single-file tools
- [62931](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62931) uploads: Fixup nested code intel uploads
- [62932](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62932) feat/enterprise-portal: subscriptions.ListEnterpriseSubscriptionLicenses
- [62936](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62936) SSC: Add "Welcome to Cody Pro" banner
- [62939](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62939) PLG: use react-query for async state management
- [62940](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62940) Fix request blocking in Cody Gateway
- [62941](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62941) schema: Document perf scaling for occurrences(...)
- [62942](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62942) appliance: deploy cadvisor
- [62948](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62948) Rename smartContext to smartContextWindow
- [62950](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62950)  Adding the User param to the site config so that it can be supported by Azure as an extra param
- [62953](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62953) feat/sg/enterprise-portal: use externalSecret to configure SAMS client secret
- [62954](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62954) chore/msp-example: refactor to align with service structure best practices
- [62955](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62955) feature: Use custom Stripe checkout
  - Added Stripe Custom Checkout for Cody PLG
- [62957](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62957) gomod: bump Zoekt for filename boost
- [62958](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62958) Batch changes: remove structural search example
- [62966](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62966) feat/enterprise-portal: explicit opt-in to serve non-dev/non-internal data
- [62967](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62967) Update titles for and references to the Analytics > Extensions page tâ€¦
- [62968](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62968) feat/enterpriseportal/codyaccess: add subscription display name
- [62971](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62971) fix typo on feature name
- [62972](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62972) feat/msp/spec: require notionPageID if a production env is provisioned
  - MSP services with production environments now must provide a `service.notionPageID` for go/msp-ops
- [62973](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62973) feat/sg/msp: add 'sg msp validate' for validating service specifications
  - `sg msp validate` can now be used to get quick feedback on whether MSP service specifications are valid.
- [62974](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62974) Svelte: QoL fixes for hover popovers
- [62975](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62975) chores: remove AMI automation
  - Move AMI automation to helm repo
- [62976](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62976) Context: detect symbol names in query
- [62977](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62977) cmd: frontend: add note that clarifies that your code host needs to be accessible over the network to test connection button
- [62978](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62978) Svelte: simplify and grow last commit
- [62979](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62979) Svelte: remove go to repository root button
- [62980](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62980) feat/enterprise-portal: only do dotcomdb connection check on-demand
- [62981](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62981) Svelte: add lines to directory groups
- [62982](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62982) sg: fix nil `domain` and `EnvironmentDomainTypeNone` in diagram gen
- [62983](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62983) Remove external accounts modal feature flag
- [62986](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62986) insights: Fix overview page
- [62990](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62990) bug: update version strings in upgradeReadiness
- [62991](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62991) Svelte: make search header primary
- [62993](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62993) Cody PLG: add support for Google Gemini modelsIn your sg local instant, look for the gemini models in the license page.Verify you are not seeing the following error when running the curl command listed in [https://sourcegraph.slack.com/archives/C05AGQYD528/p1717105626504719?thread_ts=1717011825.198899&cid=C05AGQYD528:](https://sourcegraph.slack.com/archives/C05AGQYD528/p1717105626504719?thread_ts=1717011825.198899&cid=C05AGQYD528:) `{"error":"model \"google/gemini-1.5-flash-latest\" is not allowed, allowed: []"}`
- [62997](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62997) Svelte: Paper cuts for 5.5 release
- [63002](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63002) fix(scip-syntax): Fixes a couple CLI annoyancesInternal change. Implements QoL changes to the `scip-syntax` CLI
- [63003](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63003) PLG: extract Cody Pro routes to a separate file
- [63004](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63004) Remove echo test alert
- [63005](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63005) build: bump to rules_esbuild 0.16.0
- [63008](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63008) chore/enterprise-portal: enable MSP rollouts
- [63009](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63009) Svelte: clean up file tree
- [63010](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63010) feat/lib/background: mark goroutine names as safe for Sentry
- [63012](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63012) build: bump to aspect_bazel_lib 2.7.7
- [63013](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63013) feat(cody-gateway): Add FLAGGED_MODEL_NAMES checkAdd a FLAGGED_MODEL_NAMES env var for Cody Gateway. Any requests using a supplied model will be flagged.
- [63014](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63014) Embeddings: hide site admin references
- [63016](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63016) msp: add Job runtime
- [63022](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63022) build: upgrade to rules_js 2.0 RC
- [63026](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63026) gitserver: Add observability for repo service
- [63028](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63028) gitserver: Remove IsCloneable check from clone path
- [63031](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63031) Publish sourcegraph-dev image
- [63032](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63032) sg: speed up interrupt execution
- [63041](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63041) Svelte: Add telemetry v2 to svelte client
- [63043](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63043) gitserver: Increase default GitLongCommandTimeout
- [63044](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63044) Use anyhow context, bail, and ensure instead of panicking
- [63048](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63048) GRAPH-646: scip syntax java package namespace fix
- [63049](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63049) chore/msp/runtime: disable telemetry on Google Monitoring/Trace APIs
- [63050](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63050) chore/msp/spec: tidy up custom alerts spec
- [63051](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63051) worker: add SAMS notifications subscriber
- [63053](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63053) Cody Gateway: Add Gemini models to PLG and Enterprise usersAdded support for Google as an LLM provider for Cody, with the following models available through Cody Gateway: Gemini Pro (`gemini-pro-latest`), Gemini 1.5 Flash (`gemini-1.5-flash-latest`), and Gemini 1.5 Pro (`gemini-1.5-pro-latest`).
- [63054](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63054) Chore: remove plausible scripts
- [63055](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63055) Cody Gateway: remove feature flag requirement for Gemini modelsYou should be able to use the gemini model without the `"cody-pro-gemini-enabled"` feature flag enabled for your account for Pro users.
- [63063](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63063) gitserver: Fix some cases of RevNotFound in CommitLog
- [63065](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63065) build-tracker: remove old links
- [63066](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63066) gitserver: Remove caching of cloned state
- [63073](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63073) Change JetBrains IDE statuses from Beta to Stablechore(cody): Set JetBrains labels from Beta to Stable
- [63079](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63079) sg: add command to fetch versions from release registry
  - Add `sg release registry list` to list versions from the release registry
- [63080](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63080) Svelte: fix editor button styling
- [63082](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63082) Svelte: collapse path when too long
- [63086](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63086) repoupdater: Prevent race condition of schedule preloading
- [63087](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63087) chore/msp/runtime: add args as trace attributes, clean up tracing code
- [63095](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63095) bazel: rules_js rc3 and remove deprecated "exclude_declarations" option
  - Remove deprecated option `exclude_declarations_from_npm_packages` from local.bazelrc
  - Update to rc3 of rules_js
- [63096](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63096) Fix Cody onboarding redirect problemfix(cody): redirect Cody client requests to the access token creation page in all cases
- [63099](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63099) Initialise authProviders array in Go code
- [63101](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63101) cleanup: fix typo: scretTokenKey --> secretTokenKey
- [63104](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63104) security: Auto-update package lockfiles for Sourcegraph base images
- [63108](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/63108) msp: add 'author' and 'commit_message' annotations

### Untracked

The following PRs were merged onto the previous release branch but could not be automatically mapped to a corresponding commit in this release:
- [62490](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62490) rel: bump minor for stitch graph + add support invalidating migrations repo rule
- [62493](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62493) rel: remove broken annotation code
- [62551](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62551) release: pass in `IS_DEVELOPMENT_RELEASE` flag to buildkite
  - `IS_DEVELOPMENT` is now correctly passed to release tooling, allowing to skip certain steps.
- [62553](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62553) release: execute gh via bazel
  - Removes implicit dependency on CI agents having `gh` installed.
- [62556](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62556) release: remove slack webhook requirement
- [62767](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62767) security: Auto-update package lockfiles for Sourcegraph base images
- [62793](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62793) Backport: Client Compatible Bedrock ARN handling (#62720)
- [62905](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62905) security: Auto-update package lockfiles for Sourcegraph base images

# v5.4.2198

{/* RSS={"version":"v5.4.2198", "releasedAt": "2024-05-20"} */}

### Added

### Changed

### Fixed

- Fix a bug that caused Bedrock Provisioned Throughput model names to fail [#62695](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62695) ~~[#62642](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62642)~~
- Fixed an issue where usernames were too eagerly suffixed with a random ID to prevent duplicates which could cause issues with Bitbucket Server permissions syncing where exact username matches are required. [#62747](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62747)
- Fixed an issue where code graph configuration policies would miscategorize lightweight tags as branches. [#62671](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62671)
- Fixed a bug in batch changes scheduling that could cause excessive CPU usage. [#62597](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62597)
- Cody ignore: update version constraint error message [#62654](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62654)

# v5.4.0

### Added

- Added rate and latency instrumentation for git / package repository syncing operations. These are visible in the gitserver dashboards (VCS "Clone/Fetch/IsCloneable" Metrics). [#61708](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61708)
- Added syntax highlighting for the [Pkl](https://pkl-lang.org/) configuration language. [#61478](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61478)
- New `rev:at.time()` search filter that allows you to search a branch at a point in time. [#61513](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61513)
- "cody.contextFilters" field to the site config. Admins can set include and exclude rules to define which repositories Cody can use as context in its requests to third-party LLMs. [#61101](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61101), [#61641](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61641)
- Added whether "cody.contextFilters" field is configured in the site config to pings. [#62080](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62080)
- Added exhaustive logging for all gRPC requests sent to gitserver. This feature is off by default, and can be enabled by setting the `SRC_GITSERVER_EXHAUSTIVE_LOGGING_ENABLED` environment variable to `true`. [#61270](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61270)
- Added an `internal` option for the `repositoryQuery` field for GitHub Enterprise code host connections. This will mirror all internal repositories on the code host. [#61924](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61924)

### Changed

- Improved syntax highlighting for Dart. [#58480](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58480)
- The default noop Event type in the honey package has been replaced with a new type that aggregates fields in memory for testing and logging purposes. [#61854](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61854)
- Improved the performance of Language Stats Insights by 50-70% by increasing the concurrent requests from the frontend to the gitserver from 1 to 4. You can override the concurrency with the `GET_INVENTORY_GIT_SERVER_CONCURRENCY` environment variable. [#62011](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62011)
- Raised the backend timeout for Language Stats Insights from 3 minutes to 5 minutes. You can override this with the `GET_INVENTORY_TIMEOUT` environment variable. [#62011](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62011)
- Code insights drilldown behavior has been changed from a diff search to a point-in-time search with the new `rev:at.time()`. [#61953](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61953)
- The `FirstEverCommit` gitserver client method has been changed to use a new bespoke gRPC endpoint instead of the legacy `exec` endpoint. [#62173](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62173)
- The `GetBehindAhead` gitserver client method has been changed to use a new bespoke gRPC endpoint instead of the legacy `exec` endpoint. [#62217](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62217)
- All uses of the `DiffSymbols` gitserver client method have been replaced with the new `ChangedFiles` method. As such, the `DiffSymbos` method has been removed [#62355](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62355)

### Fixed

- Updated the Docker-in-Docker image to 26.0.0 to resolve several vulnerabilities. [#61735](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61735)
- The GetCommit() RPC in the gitserver service now uses the correct protobuf type that allows for non-utf8 byte sequences in commit messages, author names, and author emails. [#61940](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61940)
- The ArchiveReader() RPC in the gitserver service now uses the correct protobuf type that allows for non-utf8 byte sequences in file paths. [#61970](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61970)
- Pinned code intel popovers and popovers opened via the keyboard are properly shown again. [#61966](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61966)
- Syntax highlighting works correctly for JSX files. [#62027](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62027)
- Changesets with a skipped CI check now have their CI status correctly displayed in the Batch Changes UI. [#62204](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62204)
- Fixed the Sourcegraph login page auto-redirecting to the single auth provider when request access is enabled. [#62376](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62376)

# v5.3.12303

### Added

- Indexed-search now supports draining a replica of indexes to support zero-downtime reduction in cluster size. [#62005](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62005)

### Fixed

- Rust binaries are now built in release mode to avoid unnecessary debug checks. [#61740](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61740)
- Fixed how scip-ctags reports errors to avoid failing search indexing on non-fatal errors. [#61712](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61712)
- Fixed a bug in Enterprise Cody context for queries containing only stopwords. [#61848](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61848), [#62026](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/62026)
- Fixed the instance dropdown on the zoekt grafana dashboard. [#61836](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61836)

# v5.3.11625

### Changed

- Notices configured in the site config now allow for specifying a style or color. [#61338](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61338)
- Reduce spamming error logs when canceling symbols indexing or canceling a syntax highlighting request. [#61880](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61880), [#61719](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61719), [#61732](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61732)

### Fixed

- Fixed a bug where the `src batch preview` command could fail due to an incorrect file-not-found error. [#61984](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61984)
- Fixed a bug where the Roles page in the Site Admin view was inaccessible. [#61738](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61738)
- Fixed a panic in Cody Attribution in sourcegraph-frontend when reporting an error. [#60439](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/60439)

# v5.3.9104

### Added

- GitHub app installations can now be refreshed from the Batch Changes Site Admin page. [#60125](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60125)
- The SAML auth provider configuration now supports a `usernameAttributeNames` field that can be used to specify a list of SAML attribute that should be used as the username. [#60603](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60603)
- Added the GraphQL query `User.evaluateFeatureFlag` to show if a feature flag is enabled or disabled for a user. [#60828](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60828)
- Search Jobs now supports diff, commit and path searches. Before, only file searches were supported. [#60883](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60883)
- Auth providers now support a `noSignIn` option that, when set to true, will hide the auth provider from the sign in page, but still allow users to connect the external account from their Account Security page for permissions syncing. [#60722](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60722)
- Added a "Commits" button to the folders in repos that shows commits for the items in that folder. [#60909](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60909)
- The frontend Grafana dashboard has a new Prometheus metric that tracks the rate of requests that Sourcegraph issues to external services. [#61348](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61348)
- Added support for the `gitURLType` setting for Gerrit, Sourcegraph now supports cloning from Gerrit via SSH. Note: Not on Cloud yet, like for all code hosts. [#61537](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61537)
- Support for OpenAI chat models for enterprise customers. [#61539](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61539)
- Added support for explicitly enumerating repositories to sync from Bitbucket Cloud. Previously, Sourcegraph would automatically sync all repositories from a Bitbucket Cloud workspace. [#61536](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61536)

### Changed

- GitHub apps installation records will only be deleted from the database if the GitHub App has been uninstalled or if the GitHub app has been deleted. [#60460](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60460)
- The Anthropic provider for Cody has been updated to use the messages API which includes support for Claude 3 models. This is applicable to both BYOK and Cody Gateway users. The messages API does not support model identifiers which only set a major model version such as: `claude-2`, `claude-instant-v1` and `claude-instant-1`. Default values have been updated to `claude-2.0` and `claude-instant-1.2`, any legacy models identifiers in the site config will be set to the corresponding default previously mentioned. [#60953](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60953) [#61324](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61324)
- The AWS Bedrock provider for Cody has been updated to use Anthropic's Messages API, bringing support for Claude 3 models. [#61347](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61347)
- Notices configured in the site config now allow for specifying a style or color. [#61338](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61338)

### Fixed

- Code Monitors now properly ignores monitors associated with soft-deleted users, which previously would have led to an error on the overview page. [#60405](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60405)
- Fixed a bug where clicking "Exclude Repo" on Azure DevOps or Gerrit repositories would not work. [#60509](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60509)
- Links in codeintel popovers respect the revision from the URL. [#60545](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60545)
- Fixed an issue where repositories with a name ending in `.git` failed to clone. [#60627](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60627)
- Fixed an issue where Sourcegraph could lose track of repositories on gitserver, leaving behind unnecessary data and inconsistent clone status in the UI. [#60627](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60627)
- The "Commits" button in repository and folder pages links to commits in the current revision instead of in the default branch. [#61408](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61408)
- Fixed an issue where code insights queries would fail if there are more than 65535 restricted repositories and regular expressions. [#61580](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61580)
- The "Commits" button in repository and folder pages uses Perforce language and links to `/-/changelists` for Perforce depots when the experimental feature `perforceChangelistMapping` is enabled. [#61408](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61408)
- Selecting "View blame prior to this change" on a file that was moved will now correctly navigate to the old file location at the specified commit. [#61577](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61577)
- Git blame performance on large files with a large number of commits has been drastically improved. [#61577](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61577)
- Code Insights now properly ignores search API alerts, which previously would have led to a code insight error. [#61431](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61431)

# v5.3.3

### Added

### Changed

- Changed the Azure OpenAI Cody provider to use the stable 2023-05-15 api version, due to the retirement of previous preview api versions. [61005](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61005)

### Fixed

- Fixed an issue in our build process that broke tooltips and validation in the settings editors. [#60808](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60808)

- Fixes a bug where the reference panel would not show any definitions or references for Protocol Buffers (and other languages where the name contained a space). [#60987](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60987)

- Fixed a bug where permission syncs could be scheduled for repositories or users even when a sync is already scheduled or in progress, leading to significant delays in the permissions sync system as a whole. [#61024](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61024)

- Fixed a bug in gitserver where it was possible to use expired Github App authorization tokens when syncing a large repository. Now, gitserver will use the latest tokens for each step of the syncing process (and refresh them if necessary). [#61179](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/61179/)

### Removed

# v5.3.2

### Fixed

- A bug in search that could trigger a panic
- An unintentional change to the search results when using the LineMatch API which would include surrounding lines with no matches
- Autoupgrade only looks for open db connections from the Sourcegraph application services, and disregards other applications connected to the postgres instance. [#60771](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60771)
- Fixes a bug where hovers would not show up in C++ headers with the `.hxx` extension. [#60662](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60662)

# v5.3.1

### Fixed

- Updated container images to fix CVE-2023-4408, CVE-2023-50387, CVE-2023-50868, CVE-2023-5517, CVE-2023-5679, CVE-2023-6516


# v5.3.0

### Added

- The search bar now supports keyword search by default, which ANDs terms together instead of searching literally as before. The behavior can be disabled through a toggle on the search results page. [#58815](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/58815)
- The `has.topic` filter now supports filtering by Gitlab topics. [#57649](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57649)
- Batch Changes now allows changesets to be exported in CSV and JSON format. [#56721](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56721)
- Supports custom ChatCompletion models in Cody clients for dotcom users. [#58158](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58158)
- Topics synced from GitHub and GitLab are now displayed for repository matches in the search results and on the repository tree page. [#58927](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58927)
- Added a new column "Repository metadata JSON" to the CSV export of repository search results, which includes the JSON encoded object of metadata key-value pairs. [#59334](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59334)
- Expiry to access tokens. Users can now select a maximum timespan for which a token is valid. Tokens will automatically lose access after this period. Default timeframes and an override to disable access tokens without expiration can be configured in the `auth.accessTokens` section of the site configuration. [#59565](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59565)
- Gerrit code host connections now support an 'exclude' field that prevents repos in this list from being synced. [#59739](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59739)
- Limit the number of active access tokens for a user. By default users are able to have 25 active access tokens. This limit can be configured using the `maxTokensPerUser` setting in the `auth.accessTokens` section of the site configuration. [#59731](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59731)
- Add experimental support for .cody/ignore when retrieving remote context. To enable it, set `experimentalFeatures.codyContextIgnore: true` in the site configuration. [#59836](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59836), [#59907](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59907)
- Site admin, link to the Cody Analytics service. [#60371](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60371)
- Added a reimagined filter panel to the search result page, facilitating a workflow centered around iterative refinement.
- Search results were treated to a design refresh, improving information density of results. [#59834](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59834)
- Added a preview pane to file search results so you can view the full file without navigating away from the search results. [#58311](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58311)

### Changed

- `cody.restrictUsersFeatureFlag` has been deprecated and replaced by role based access control instead. Until the old configuration value is removed from your site config, it will be respected just as before but with a warning displayed at the top of Sourcegraph. Once removed, the old feature flag will not be respected and instead the Cody access will be managed via role based access controls, see [the docs](/cody/overview/enable-cody-enterprise#enable-cody-only-for-some-users) for more information. [#58831](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58831)
- The setting `experimentalFeatures.searchQueryInput` now refers to the new query input as `v2` (not `experimental`).
- Search-based code intel doesn't include the currently selected search context anymore. It was possible to get into a situation where search-based code intel wouldn't find any information due to being restricted by the current search context. [#58010](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58010)
- The last commit which changed a file/directory is now shown in the files panel on the repo and file pages. To avoid duplicating information and confusion, the commits panel was removed. [58328](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58328)
- Clicking on a search result now opens the blob view at the same commit as the search result. Before, blob views were opened at the tip of the default branch, which sometimes caused inconsistencies in line numbers if the index was out of date. [#58381](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58381)
- The `exclude` configuration for code host configuration has been updated to allow chaining multiple conditions together and filtering GitHub repositories based on their size or number of GitHub stars. [#58377](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58377) and [#58405](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58405)
  - Multiple attributes on _a single_ `exclude` entry now have to be all true for a repository to be excluded. Example: `{"exclude": [{"name": "github.com/example/example"}, {"id": "my-id"}]}` will _only_ exclude repositories that have the name _and_ the id mentioned.
  - GitHub code host connections can exclude by size and stars now: `{"exclude": [{"name": "github.com/example/example"}, {"stars": "< 100", "size": ">= 1GB"}]}`
  - For `size` and `stars` the supported operators are `<`, `>`, `<=`, `>=`.
  - For `size` the supported units are `B`, `b`, `kB`, `KB`, `kiB`, `KiB`, `MiB`, `MB`, `GiB`, `GB`. No decimals points are supported.
- Structural Search is now disabled by default. To enable it, set `experimentalFeatures.structuralSearch: "enabled"` in the site configuration. [#57584](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57584)
- Search Jobs switches the format of downloaded results from CSV to JSON. [#59619](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59619)
- [Search Jobs](/code_search/how-to/search-jobs) is now in beta and enabled by default. It can be disabled in the site configuration by setting `experimentalFeatures.searchJobs: false`.
- The search input on the search homepage is now automatically focused when the page loads.
- GRPC is now the only method for our internal APIs, and can not be disabled. All of corresponding the REST implementations have been removed. The vast majority of customers upgrading to 5.3 don't need to take any action - The change should be invisible. However, if you have restrictions on Sourcegraphâ€™s internal (service to service) traffic, some firewall or security configurations may be necessary. You can downgrade to Sourcegraph 5.2 and disable gRPC while you troubleshoot / reach out to our customer support team. See [https://sourcegraph.com/docs/admin/updates/grpc](https://sourcegraph.com/docs/admin/updates/grpc) for more details. [#59093](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59093)
- The default `count:` for search has been increased to 10000, significantly increasing the number of searches that are exhaustive by default. [#60114](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60114)

### Fixed

- Site configuration edit history no longer breaks when the user that made the edit is deleted. [#57656](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57656)
- Drilling down into an insights query no longer mangles `content:` fields in your query. [#57679](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57679)
- The blame column now shows correct blame information when a hunk starts in a folded code section. [#58042](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58042)
- Fixed a bug where typing in the GraphQL editor in the Site Admin API console could cause the cursor to jump to the start of the editor. [#57862](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57862)
- The blame column no longer ignores whitespace-only changes by default. [#58134](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58134)
- Long lines now wrap correctly in the diff view. [#58138](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58138)
- Fixed an issue in the search input where pressing Enter after selecting a suggestion would sometimes insert another suggestions instead of submitting the query. [#58186](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58186)
- Fixed an issue where having sub-repo permissions enabled could cause repositories with a large number of files in directories to become unviewable. [#59420](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59420)
- On the search context, code monitoring, code insights, saved searches or notebook pages, when selecting a repository or file suggestion in the query input with Enter the suggestion is now properly appended to the query instead of navigating away to the corresponding repository or file page. [#59941](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59941)
- Perforce email matching for user permissions is now case insensitive, matching Perforce behavior. [#60252](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60252)
- A bug with syncing GitHub App installations that caused installations to be truncated after the first 30 orgs. [#60383](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/60383)
- Various significant performance optimizations in the search and code navigation user flows.

### Removed

- The experimental GraphQL query `User.invitableCollaborators`.
- The following experimental settings in site-configuration are now deprecated and will not be read anymore: `maxReorderQueueSize`, `maxQueueMatchCount`, `maxReorderDurationMS`. [#57468](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57468)
- The feature-flag `search-ranking`, which allowed to disable the improved ranking introduced in 5.1, is now deprecated and will not be read anymore. [#57468](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57468)
- The GitHub Proxy service is no longer required and has been removed from deployment options. [#55290](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/55290)
- The VSCode search extension "Sourcegraph for VS Code" has been sunset and removed from Sourcegraph
  repository. [#58023](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58023)
- The `rateLimit` configuration for Perforce code host connections has been removed to avoid confusion, it was unused. [#58188](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58188)
- The feature flag `search-ranking` is now completely removed. [#58156](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58156)
- The notepad UI, notebook creation feature. [#58217](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58217)
- The experimental `indexRepositoryName` option for the rust packages code host connection has been removed. [#59176](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59176)
- The column "Repository metadata" in the CSV export of repository search results is now deprecated and will be removed in a future release. Use "Repository metadata JSON" instead [#59334](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59334)
- Remote embeddings as context source for Cody has been removed. [#59493](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59493)

# v5.2.7

### Added

### Fixed

- The reference panel correctly shows definition and reference information instead of a "Could not find token" error for MATLAB. [#59636](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59636)
- The auto-index configuration page correctly shows any auto-inference errors instead of a nil pointer exception. [#59756](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59756)

### Removed

### Changed

# v5.2.6

### Added

- Implement adding automatic retry support for idempotent gRPC methods [#59404](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59404)

### Fixed

- Fix executors auth header `installSrc` [#59391](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/59391)
- Avoid constantly rerunning failed embeddings jobs. [#58980](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58980)

# v5.2.5

### Added

- Added Cody providers data to pings. [#58848](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58848)
- Added the ability to proxy authentication requests when using the Azure OpenAI Cody provider. [#58862](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58862)

### Fixed

- Fixed an issue where updating a generic git code host would cause it to become unrestricted if permissions user mapping is enabled. [#58772](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58772)
- Fail embeddings jobs immediately if the rate limit is exceeded. [#58869](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58869)

### Changed

- Improved the admin page for search indexing. [#58866](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58866)

### Removed

# v5.2.4

### Added

- Added the ability to use Workload Identity, Managed Identity and Environmental credentials when using the Azure OpenAI completions and embeddings providers [#58289](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58289)
- Added support for cloning via SSH from Azure DevOps. [#58655](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58655)

### Fixed

- Fixed two issues in Zoekt that could cause out of memory errors during search indexing. [sourcegraph/zoekt#686](https://github.com/sourcegraph/zoekt/pull/686), [sourcegraph/zoekt#689](https://github.com/sourcegraph/zoekt/pull/689)
- Fixed performance issue with embeddings job scheduling. (#58651)[https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58651]

# v5.2.3

### Added

- Added configurable GraphQL query cost limitations to prevent unintended resource exhaustion. Default values are now provided and enforced, replacing the previously unlimited behaviour. For more information, please refer to: [GraphQL Cost Limits Documentation](/api/graphql#cost-limits). See details at [#58346](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58346).
- Sourcegraph now supports connecting to Bitbucket Cloud using Workspace Access Tokens. [#58465](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58465).

### Fixed

- Defining file filters for embeddings jobs no longer causes all files to be skipped if `MaxFileSizeBytes` isn't defined. [#58262](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58262)

# v5.2.2

### Added

- Added a new authorization configuration options to GitLab code host connections: "markInternalReposAsPublic". Setting "markInternalReposAsPublic" to true is useful for organizations that have a large amount of internal repositories that everyone on the instance should be able to access, removing the need to have permissions to access these repositories. Additionally, when configuring a GitLab auth provider, you can specify "syncInternalRepoPermissions": false, which will remove the need to sync permissions for these internal repositories. [#57858](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57858)
- Experimental support for OpenAI powered autocomplete has been added. [#57872](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57872)

### Fixed

- Updated the endpoint used by the AWS Bedrock Claude provider. [#58028](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/58028)

# v5.2.1

### Added

- Added two new authorization configuration options to GitHub code host connections: "markInternalReposAsPublic" and "syncInternalRepoPermissions". Setting "markInternalReposAsPublic" to true is useful for organizations that have a large amount of internal repositories that everyone on the instance should be able to access, removing the need to have permissions to access these repositories. Setting "syncInternalRepoPermissions" to true adds an additional step to user permission syncs that explicitly checks for internal repositories. However, this could lead to longer user permission sync times. [#56677](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56677)
- Fixed an issue with Code Monitors that could cause users to be notified multiple times for the same commit [#57546](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57546)
- Fixed an issue with Code Monitors that could prevent a new code monitor from being created if it targeted multiple repos [#57546](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57546)
- Sourcegraph instances will now emit a limited set of [telemetry events](/admin/telemetry) in the background by default ([#57605](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57605)). Enablement will be based on the following conditions:
  - Customers with a license key created after October 3, 2023, or do not have a valid license key configured, will export all telemetry events recorded in the new system.
  - Customers with a license key created before October 3, 2023 will export only Cody-related events recorded in the new system, as covered by the [Cody Usage and Privacy Notice](https://about.sourcegraph.com/terms/cody-notice).
  - If you have a previous agreement regarding telemetry sharing, you account representative will reach out with more details.

### Fixed

- Fixed a user's Permissions page being inaccessible if the user has had no permission syncs with an external account connected. [#57372](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57372)
- Fixed a bug where site admins could not view a user's permissions if they didn't have access to all of the repositories the user has. Admins still won't be able to see repositories they don't have access to, but they will now be able to view the rest of the user's repository permissions. [#57375](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57375)
- Fixed a bug where gitserver statistics would not be properly decoded / reported when using REST (i.e. `experimentalFeatures.enableGRPC = false` in site configuration). [#57318](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57318)
- Updated the `curl` and `libcurl` dependencies to `8.4.0-r0` to fix [CVE-2023-38545](https://curl.se/docs/CVE-2023-38545.html). [#57533](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57533)
- Fixed a bug where commit signing failed when creating a changeset if `batchChanges.enforceFork` is set to true. [#57520](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/57520)
- Fixed a regression in ranking of Go struct and interface in search results. [zoekt#655](https://github.com/sourcegraph/zoekt/pull/655)

# v5.2.0

### Added

- Experimental support for AWS Bedrock Claude for the completions provider has been added. [#56321](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56321)
- Recorded command logs can now be viewed for Git operations performed by Sourcegraph. This provides auditing and debugging capabilities. [#54997](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/54997)
- Disk usage metrics for gitservers are now displayed on the site admin Git Servers page, showing free/total disk space. This helps site admins monitor storage capacity on GitServers. [#55958](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/55958)
- Overhauled Admin Onboarding UI for enhanced user experience, introducing a license key modal with validation, automated navigation to Site Configuration Page, an interactive onboarding checklist button, and direct documentation links for SMTP and user authentication setup. [56366](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56366)
- New experimental feature "Search Jobs". Search Jobs allows you to run search queries across your organization's codebase (all repositories, branches, and revisions) at scale. It enhances the existing Sourcegraph's search capabilities, enabling you to run searches without query timeouts or incomplete results. Please refer to the [documentation](/code_search/how-to/search-jobs) for more information.

### Changed

- OpenTelemetry Collector has been upgraded to v0.81, and OpenTelemetry packages have been upgraded to v1.16. [#54969](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54969), [#54999](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54999)
- Bitbucket Cloud code host connections no longer automatically syncs the repository of the username used. The appropriate workspace name will have to be added to the `teams` list if repositories for that account need to be synced. [#55095](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55095)
- Newly created access tokens are now hidden by default in the Sourcegraph UI. To view a token, click "show" button next to the token. [#56481](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56481)
- The GitHub proxy service has been removed and is no longer required. You can safely remove it from your deployment. [#55290](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/55290)
- On startup, Zoekt indexserver will now delete the `<DATA_DIR>/.indexserver.tmp` directory to remove leftover repository clones, possibly causing a brief delay. Due to a bug, this directory wasn't previously cleaned up and could cause unnecessary disk usage. [zoekt#646](https://github.com/sourcegraph/zoekt/pull/646).
- GRPC is now used by default for all internal (service to service) communication. This change should be invisible to most customers. However, if you're running in an environment that places restrictions on Sourcegraph's internal traffic, some prior configuration might be required. See the ["Sourcegraph 5.2 gRPC Configuration Guide"](/admin/updates/grpc) for more information. [#56738](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56738)

### Fixed

- Language detection for code highlighting now uses `go-enry` for all files by default, which fixes highlighting for MATLAB files. [#56559](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56559)

### Removed

- Indexed-search has removed the deprecated environment variable ZOEKT_ENABLE_LAZY_DOC_SECTIONS [zoekt#620](https://github.com/sourcegraph/zoekt/pull/620)
- The federation feature that could redirect users from their own Sourcegraph instance to public repositories on Sourcegraph.com has been removed. It allowed users to open a repository URL on their own Sourcegraph instance and, if the repository wasn't found on that instance, the user would be redirect to the repository on Sourcegraph.com, where it was possibly found. The feature has been broken for over a year though and we don't know that it was used. If you want to use it, please open a feature-request issue and tag the `@sourcegraph/source` team. [#55161](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55161)
- The `applySearchQuerySuggestionOnEnter` experimental feature flag in user settings was removed, and this behavior is now always enabled. Previously, this behavior was on by default, but it was possible to disable it.
- The feature-flag `search-hybrid`, which allowed to disable the performance improvements for unindexed search in 4.3, is now deprecated and will not be read anymore. [#56470](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56470)

# v5.1.9

### Added

- Enable "Test connection" for Perforce code hosts. The "Test connection" button in the code host page UI now works for Perforce code hosts. [#56697](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56697)

### Changed

- User access to Perforce depots is sometimes denied unintentionally when using `"authorization"/"subRepoPermissions": true` in the code host config and the protects file contains exclusionary entries with the Host field filled out. Ignoring those rules (that use anything other than the wildcard (`*`) in the Host field) is now toggle-able by adding `"authorization"/"ignoreRulesWithHost"` to the code host config and setting the value to `true`. [#56450](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56450)

### Fixed

- Fixed an issue where the "gitLabProjectVisibilityExperimental" feature flag would not be respected by the permissions syncer. This meant that users on Sourcegraph that have signed in with GitLab would not see GitLab internal repositories that should be accessible to everyone on the GitLab instance, even though the feature flag was enabled [#56492](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56492)
- Fixed a bug when syncing repository lists from GitHub that could lead to 404 errors showing up when running into GitHub rate limits [#56478](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56478)

# v5.1.8

### Added

- Added experimental autocomplete support for Azure OpenAI [#56063](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56063)

### Changed

- Improved stability of gRPC connections [#56314](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56314), [#56302](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56302), [#56298](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56298), [#56217](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/56217)

# v5.1.7

### Changed

- Pressing `Mod-f` will always select the input value in the file view search [#55546](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55546)
- Caddy has been updated to version 2.7.3 resolving a number of vulnerabilities. [#55606](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55606)
- The commit message defined in a batch spec will now be passed to `git commit` on stdin using `--file=-` instead of being included inline with `git commit -m` to improve how the message is interpreted by `git` in certain edge cases, such as when the commit message begins with a dash, and to prevent extra quotes being added to the message. This may mean that previous escaping strategies will behave differently.

### Fixed

- Fixed a bug in the `deploy-sourcegraph-helm` deployment of Sourcegraph, for sufficiantly large scip indexes uploads will fail when the precise-code-intel worker attempts to write to `/tmp` and doesn't have a volume mounted for this purpose. See kubernetes release notes for more details [#342](https://github.com/sourcegraph/deploy-sourcegraph-helm/pull/343)

# v5.1.6

### Added

- New Prometheus metrics have been added to track the response / request sizes of gRPC calls. [#55381](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55381)
- A new embeddings site configuration setting `excludeChunkOnError` allows embedding jobs to complete job execution despite chunks of code or text that fail. When enabled the chunks are skipped after failed retries but the index can continue being populated. When disabled the entire job fails and the index is not saved. This setting is enabled by default. Embedding job statistics now capture `code_chunks_excluded` and `text_chunks_excluded` for successfully completed jobs. Total excluded chunks and file names for excluded chunks are logged as warnings. [#55180](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55180)
- Experimental support for Azure OpenAI for the completions and embeddings provider has been added. [#55178](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55178)
- Added a feature flag for alternate GitLab project visibility resolution. This may solve some weird cases with not being able to see GitLab internal projects. [#54426](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54426)
  - To use this feature flag, create a Boolean feature flag named "gitLabProjectVisibilityExperimental" and set the value to True.
- It is now possible to add annotations to pods spawned by jobs created by the Kubernetes executor. [#55361](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55361)

### Changed

- Updated all packages in container images to latest versions
- Updated Docker-in-Docker image from 23.0.1 to 23.0.6
- The gRPC implementation for the Symbol service's `LocalCodeIntel` endpoint has been changed to stream its results. [#55242](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55242)
- When using OpenAI or Azure OpenAI for Cody completions, code completions will be disabled - Chat will continue to work. This is because we currently don't support code completions with OpenAI. [#55624](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55624)

### Fixed

- Fixed a bug where user account requests could not be approved even though the license would permit user creation otherwise. [#55482](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55482)
- Fixed a bug where the background scheduler for embedding jobs based on policies would not schedule jobs for private repositories. [#55698](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55698)
- Fixed a source of inconsistency in precise code navigation, affecting implementations and prototypes especially. [#54410](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54410)

### Removed

# v5.1.5

### Known Issues

- Standard and multi-version upgrades are not currently working from Sourcegraph versions 5.0.X to 5.1.5. As a temporary workaround, please upgrade 5.0.X to 5.1.0, then 5.1.0 to 5.1.5.

### Fixed

- Fixed an embeddings job scheduler bug where if we cannot resolve one of the repositories or its default branch then all repositories submitted will not have their respective embeddings job enqueued. Embeddings job scheduler will now continue to schedule jobs for subsequent repositories in the submitted repositories set. [#54701](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54701)
- Creation of GitHub Apps will now respect system certificate authorities when specifying certificates for the tls.external site configuration. [#55084](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55084)
- Passing multi-line Coursier credentials in JVM packages configuration should now work correctly. [#55113](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55113)
- SCIP indexes are now ingested in a streaming fashion, eliminating out-of-memory errors in most cases, even when uploading very large indexes (1GB+ uncompressed). [#53828](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53828)
- Moved the license checks to worker service. We make sure to run only 1 instance of license checks this way. [54854](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54854)
- Updated base images to resolve issues in curl, OpenSSL, and OpenSSL. [55310](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55310)
- The default message size limit for gRPC clients has been raised from 4MB to 90MB. [#55209](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55209)
- The message printing feature for the custom gRPC internal error interceptor now supports logging all internal error types, instead of just non-utf 8 errors. [#55130](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55130)
- Fixed an issue where GitHub Apps could not be set up using Firefox. [#55305](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55305)
- Fixed nil panic on certain GraphQL fields when listing users. [#55322](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55322)

### Changed

- The "Files" tab of the fuzzy finder now allows you to navigate directly to a line number by appending `:NUMBER`. For example, the fuzzy query `main.ts:100` opens line 100 in the file `main.ts`. [#55064](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55064)
- The gRPC implementation for the Symbol service's `LocalCodeIntel` endpoint has been changed to stream its results. [#55242](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/55242)
- GitLab auth providers now support an `ssoURL` option that facilitates scenarios where a GitLab group requires SAML/SSO. [#54957](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54957)

### Added

### Removed

# v5.1.4

### Fixed

- A bug where we would temporarily use much more memory than needed during embeddings fetching. [#54972](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54972)

### Changed

- The UI for license keys now displays more information about license validity. [#54990](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54990)
- Sourcegraph now supports more than one auth provider per URL. [#54289](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54289)
- Site-admins can now list, view and edit all code monitors. [#54981](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54981)

# v5.1.3

### Changed

- Cody source code (for the VS Code extension, CLI, and client shared libraries) has been moved to the [sourcegraph/cody repository](https://github.com/sourcegraph/cody).
- `golang.org/x/net/trace` instrumentation, previously available under `/debug/requests` and `/debug/events`, has been removed entirely from core Sourcegraph services. It remains available for Zoekt. [#53795](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53795)

### Fixed

- Fixed an embeddings job scheduler bug where if we cannot resolve one of the repositories or its default branch then all repositories submitted will not have their respective embeddings job enqueued. Embeddings job scheduler will now continue to schedule jobs for subsequent repositories in the submitted repositories set. [#54701](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54701)

# v5.1.2

### Fixed

- Fixes a crash when uploading indexes with malformed source ranges (this was a bug in scip-go). [#54304](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54304)
- Fixed validation of Bitbucket Cloud configuration in site-admin create/update form. [#54494](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54494)
- Fixed race condition with grpc `server.send` message. [#54500](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54500)
- Fixed a configuration initialization issue that broke the outbound request in the site admin page. [#54745](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54745)
- Fixed Postgres DSN construction edge-case. [#54858](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54858)

# v5.1.1

### Fixed

- Fixed the default behaviour when the explicit permissions API is enabled. Repositories are no longer marked as unrestricted by default. [#54419](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54419)

# v5.1.0

> **Note**: As of 5.1.0, the limited OSS subset of Sourcegraph has been removed, and code search OSS code has been relicensed going forward. See https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/53528#issuecomment-1594967818 for more information (blog post coming soon).

> **Note**: As of 5.1.0, the `rsa-sha` signature algorithm is no longer supported when connecting to code hosts over SSH. If you encounter the error `sign_and_send_pubkey: no mutual signature supported` when syncing repositories, see [Repository authentication](/admin/repo/auth#error-sign_and_send_pubkey-no-mutual-signature-supported) for more information and steps to resolve the issue.

### Known issues

- There is an issue with Sourcegraph instances configured to use explicit permissions using permissions.userMapping in Site configuration, where repository permissions are not enforced. Customers using the explicit permissions API are advised to upgrade to v5.1.1 directly.
- There is an issue with creating and updating existing Bitbucket.org (Cloud) code host connections due to problem with JSON schema validation which prevents the JSON editor from loading and surfaces as an error in the UI.

### Added

- Executors natively support Kubernetes environments. [#49236](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/49236)
- Documentation for GitHub fine-grained access tokens. [#50274](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50274)
- Code Insight dashboards retain size and order of the cards. [#50301](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50301)
- The LLM completions endpoint is now exposed through a GraphQL query in addition to the streaming endpoint [#50455](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50455)
- Permissions center statistics pane is added. Stats include numbers of queued jobs, users/repos with failed jobs, no permissions, and outdated permissions. [#50535](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50535)
- SCIM user provisioning support for Deactivate/Reactivation of users. [#50533](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50533)
- Login form can now be configured with ordering and limit of auth providers. [See docs](/admin/auth/login_form). [#50586](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50586), [50284](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50284) and [#50705](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50705)
- OOM reaper events affecting `p4-fusion` jobs on `gitserver` are better detected and handled. Error (non-zero) exit status is used, and the resource (CPU, memory) usage of the job process is appended to the job output so that admins can infer possible OOM activity and take steps to address it. [#51284](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51284)
- When creating a new batch change, spaces are automatically replaced with dashes in the name field. [#50825](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50825) and [51071](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51071)
- Support for custom HTML injection behind an environment variable (`ENABLE_INJECT_HTML`). This allows users to enable or disable HTML customization as needed, which is now disabled by default. [#51400](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51400)
- Added the ability to block auto-indexing scheduling and inference via the `codeintel_autoindexing_exceptions` Postgres table. [#51578](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51578)
- When an admin has configured rollout windows for Batch Changes changesets, the configuration details are now visible to all users on the Batch Changes settings page. [#50479](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50479)
- Added support for regular expressions in`exclude` repositories for GitLab code host connections. [#51862](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51862)
- Branches created by Batch Changes will now be automatically deleted on the code host upon merging or closing a changeset if the new `batchChanges.autoDeleteBranch` site setting is enabled. [#52055](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52055)
- Repository metadata now generally available for everyone [#50567](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50567), [#50607](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50607), [#50857](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50857), [#50908](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50908), [#972](https://github.com/sourcegraph/src-cli/pull/972), [#51031](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51031), [#977](https://github.com/sourcegraph/src-cli/pull/977), [#50821](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50821), [#51258](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51258), [#52078](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52078), [#51985](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51985), [#52150](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52150), [#52249](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52249), [#51982](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51982), [#51248](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51248), [#51921](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51921), [#52301](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52301)
- Batch Changes for Gerrit Code Hosts [#52647](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52647).
- Batch Changes now supports per-batch-change control for pushing to a fork of the upstream repository when the property `changesetTemplate.fork` is specified in the batch spec. [#51572](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51572)
- Executors can now be configured to process multiple queues. [#52016](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52016)
- Added `isCodyEnabled` as a new GraphQL field to `Site`. [#52941](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52941)
- Enabled improved search ranking by default. This feature can be disabled through the `search-ranking` feature flag.[#53031](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53031)
- Added token callback route for Cody in VS Code and VS Code insiders. [#53313](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53313)
- Latest repository clone/sync output is surfaced in the "Mirroring and cloning" page (`{REPO}/-/settings/mirror`). Added primarily to enable easier debugging of issues with Perforce depots, it can also be useful for other code hosts. [#51598](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51598)
- New `file:has.contributor(...)` predicate for filtering files based on contributors. [#53206](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53206)
- Added multi-repo scope selector for Cody on the web supporting unified context generation API which uses combination of embeddings search and keyword search as fallback for context generation. [53046](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53046)
- Batch Changes can now sign commits for changesets published on GitHub code hosts via GitHub Apps. [#52333](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52333)
- Added history of changes to the site configuration page. Site admins can now see information about changes made to the site configuration, by whom and when. [#49842](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/49842)
- For Perforce depots, users will now see the changelist ID (CL) instead of Git commit SHAs when visiting a depot or the view changelists page [#51195](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51195)
- Visiting a specific CL will now use the CL ID in the URL instead of the commit SHA. Other areas affected by this change are browsing files at a specific CL, viewing a specific file changed as part of a specific CL. To enable this behaviour, site admins should set `"perforceChangelistMapping": "enabled"` under experimentalFeatures in the site configuration. Note that currently we process only one perforce depot at a time to map the commit SHAs to their CL IDs in the backend. In a subsequent release we will add support to process multiple depots in parallel. Other areas where currently commit SHAs are used will be updated in future releases. [#53253](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53253) [#53608](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53608) [#54051](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54051)
- Added autoupgrading to automatically perform multi-version upgrades, without manual `migrator` invocations, through the `frontend` deployment. Please see the [documentation](/admin/updates/automatic) for details. [#52242](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52242) [#53196](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53196)

### Changed

- Access tokens now begin with the prefix `sgp_` to make them identifiable as secrets. You can also prepend `sgp_` to previously generated access tokens, although they will continue to work as-is without that prefix.
- The commit message defined in a batch spec will now be quoted when git is invoked, i.e. `git commit -m "commit message"`, to improve how the message is interpreted by the shell in certain edge cases, such as when the commit message begins with a dash. This may mean that previous escaping strategies will behave differently.
- 429 errors from external services Sourcegraph talks to are only retried automatically if the Retry-After header doesn't indicate that a retry would be useless. The time grace period can be configured using `SRC_HTTP_CLI_EXTERNAL_RETRY_AFTER_MAX_DURATION` and `SRC_HTTP_CLI_INTERNAL_RETRY_AFTER_MAX_DURATION`. [#51743](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51743)
- Security Events NO LONGER write to database by default - Instead, they will be written in the [audit log format](/admin/audit_log) to console. There is a new site config setting `log.securityEventLogs` that can be used to configure security event logs to write to database if the old behaviour is desired. This new default will significantly improve performance for large instances. In addition, the old environment variable `SRC_DISABLE_LOG_PRIVATE_REPO_ACCESS` no longer does anything. [#51686](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51686)
- Audit Logs & Security Events are written with the same severity level as `SRC_LOG_LEVEL`. This prevents a misconfiguration
  issue when `log.AuditLogs.SeverityLevel` was set below the overall instance log level. `log.AuditLogs.SeverityLevel` has
  been marked as deprecated and will be removed in a future release [#52566](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52566)
- Update minimum supported Redis version to 6.2 [#52248](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52248)
- The batch spec properties [`transformChanges`](/batch-changes/batch-spec-yaml-reference#transformchanges) and [`workspaces`](/batch-changes/batch-spec-yaml-reference#workspaces) are now generally available.
- Cody feature flags have been simplified [#52919](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52919) See [the docs page for complete setup details](/cody/explanations/enabling_cody_enterprise)
  - `cody.enabled` in site-config now controls whether Cody is on/off, default `false`.
  - When `cody.enabled` is set and no specific configuration for `completions` and `embeddings` are given, Cody will by default talk to the `sourcegraph` provider, Sourcegraphs Cody Gateway which allows access to chat completions and embeddings.
  - Enabling Cody now requires `cody.enabled` set to `true` and `completions` to be set.
  - `cody.restrictUsersFeatureFlag` replaces `experimentalFeatures.CodyRestrictUsersFeatureFlag` in site-config, default `false`.
  - `completions.enabled` has been deprecated, replaced by `cody.enabled`.
  - The feature flags for Cody in web features have been removed and the single source of truth is now `cody.enabled`.
  - The embeddings configuration now requires a `provider` field to be set.
  - Ping data now reflects whether `cody.enabled` and `completions` are set.
- If a Sourcegraph request is traced, its trace ID and span ID are now set to the `X-Trace` and `X-Trace-Span` response headers respectively. The trace URL (if a template is configured in `observability.tracing.urlTemplate`) is now set to `X-Trace-URL` - Previously, the URL was set to `X-Trace`. [#53259](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53259)
- For users using the single-container server image with the default built-in database, the database must be reindexed. This process can take up to a few hours on systems with large datasets. See [Migrating to Sourcegraph 5.1.x](/admin/migration/5_1) for full details. [#53256](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53256)
- [Sourcegraph Own](/own) is now available as a beta enterprise feature. `search-ownership` feature flag is removed and doesn't need to be used.
- Update Jaeger to 1.45.0, and Opentelemetry-Collector to 0.75.0 [#54000](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54000)
- Switched container OS to Wolfi for hardened containers [#47182](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47182), [#47368](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47368)
- Batches changes now supports for CODEOWNERS for Github. Pull requests requiring CODEOWNERS approval, will no longer show as approved unless explicitly approved by a CODEOWNER. https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53601
- The insecure `rsa-sha` signature algorithm is no longer supported when connecting to code hosts over SSH. See the [Repository authentication](/admin/repo/auth#error-sign_and_send_pubkey-no-mutual-signature-supported) page for further details.

### Fixed

- GitHub `repositoryQuery` searches now respect date ranges and use API requests more efficiently. #[49969](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/49969)
- Fixed an issue where search based references were not displayed in the references panel. [#50157](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50157)
- Symbol suggestions only insert `type:symbol` filters when necessary. [#50183](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50183)
- Removed an incorrect beta label on the Search Context creation page [#51188](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51188)
- Multi-version upgrades to version `5.0.2` in a fully airgapped environment will not work without the command `--skip-drift-check`. [#51164](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51164)
- Could not set "permissions.syncOldestUsers" or "permissions.syncOldestRepos" to zero. [#51255](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51255)
- GitLab code host connections will disable repo-centric repository permission syncs when the authentication provider is set as "oauth". This prevents repo-centric permission sync from getting incorrect data. [#51452](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51452)
- Code intelligence background jobs did not correctly use an internal context, causing SCIP data to sometimes be prematurely deleted. [#51591](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51591)
- Slow request logs now have the correct trace and span IDs attached if a trace is present on the request. [#51826](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51826)
- The braindot menu on the blob view no longer fetches data eagerly to prevent performance issues for larger monorepo users. [#53039](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53039)
- Fixed an issue where commenting out redacted site-config secrets would re-add the secrets. [#53152](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53152)
- Fixed an issue where SCIP packages would sometimes not be written to the database, breaking cross-repository jump to definition. [#53763](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53763)
- Fixed an issue when adding a new user external account was not scheduling a new permission sync for the user. [#54144](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54144)
- Adding a new user account now correctly schedules a permission sync for the user. [#54258](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54258)
- Users/repos without an existing sync job in the permission_sync_jobs table are now scheduled properly. [#54278](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/54278)

### Removed

- User tags are removed in favor of the newer feature flags functionality. [#49318](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/49318)
- Previously deprecated site config `experimentalFeatures.bitbucketServerFastPerm` has been removed. [#50707](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50707)
- Unused site-config field `api.rateLimit` has been removed. [#51087](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51087)
- Legacy (table-based) blob viewer. [#50915](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50915)

# v5.0.6

### Fixed

- SAML assertions to get user display name are now compared case insensitively and we do not always return an error. [#52992](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52992)
- Fixed an issue where `type:diff` search would not work when sub-repo permissions are enabled. [#53210](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/53210)

# v5.0.5

### Added

- Organization members can now administer batch changes created by other members in their organization's namespace if the setting `orgs.allMembersBatchChangesAdmin` is enabled for that organization. [#50724](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50724)
- Allow instance public access mode based on `auth.public` site config and `allow-anonymous-usage` license tag [#52440](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52440)
- The endpoint configuration field for completions is now supported by the OpenAI provider [#52530](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52530)

### Fixed

- MAU calculation in product analytics and pings use the same condition and UTC at all times. [#52306](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52306) [#52579](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52579) [#52581](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52581)
- Bitbucket native integration: fix code-intel popovers on the pull request pages. [#52609](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52609)
- `id` column of `user_repo_permissions` table was switched to `bigint` to avoid `int` overflow. [#52299](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52299)
- In some circumstances filenames containing `..` either could not be read or would return a diff when viewed. We now always correctly read those files. [#52605](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52605)
- Syntax highlighting for several languages including Python, Java, C++, Ruby, TypeScript, and JavaScript is now working again when using the single Docker container deployment option. Other deployment options were not affected.

# v5.0.4

### Fixed

- Git blame lookups of repositories synced through `src serve-git` or code hosts using a custom `repositoryPathPattern` will now use the correct URL when streaming git blame is enabled. [#51525](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51525)
- Code Insights scoped to a static list of repository names would fail to resolve repositories with permissions enabled, resulting in insights that would not process. [#51657](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51657)
- Batches: Resolved an issue with GitHub webhooks where CI check updates fail due to the removal of a field from the GitHub webhook payload. [#52035](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/52035)

# v5.0.3

### Added

- Cody aggregated pings. [#50835](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50835)

### Fixed

- Bitbucket Server adding an error log if there is no account match for the user. #[51030](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51030)
- Editing search context with special characters such as `/` resulted in http 404 error. [#51196](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51196)
- Significantly improved performance and reduced memory usage of the embeeddings service. [#50953](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50953), [#51372](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51372)
- Fixed an issue where a Code Insights query with structural search type received 0 search results for the latest commit of any matching repo. [#51076](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/51076)

# v5.0.2

### Added

- An experimental site config setting to restrict cody to users by the cody-experimental feature flag [#50668](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50668)

### Changed

- Use the Alpine 3.17 releases of cURL and Git

### Fixed

- For Cody, explicitly detect some cases where context is needed to avoid failed responses. [#50541](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50541)
- Code Insights that are run over zero repositories will finish processing and show `"No data to display"`. #[50561](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50561)
- DNS timeouts on calls to host.docker.internal from every html page load for docker-compose air-gapped instances. No more DNS lookups in jscontext.go anymore. #[50638](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50638)
- Improved the speed of the embedding index by significantly decreasing the calls to Gitserver. [#50410](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50410)

### Removed

-

# v5.0.1

### Added

- The ability to exclude certain file path patterns from embeddings.
- Added a modal to show warnings and errors when exporting search results. [#50348](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50348)

### Changed

### Fixed

- Fixed CVE-2023-0464 in container images
- Fixed CVE-2023-24532 in container images
- Fixed an issue where Slack code monitoring notifications failed when the message was too long. [#50083](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50083)
- Fixed an edge case issue with usage statistics calculations that cross over month and year boundaries.
- Fixed the "Last incremental sync" value in user/repo permissions from displaying a wrong date if no sync had been completed yet.
- Fixed an issue that caused search context creation to fail with error "you must provide a first or last value to properly paginate" when defining the repositories and revisions with a JSON configuration.
- Fixed an issue where the incorrect actor was provided when searching an embeddings index.
- Fixed multiple requests downloading the embeddings index concurrently on an empty cache leading to an out-of-memory error.
- Fixed the encoding of embeddings indexes which caused out-of-memory errors for large indexes when uploading them from the worker service.
- Fixed git blame decorations styles
- CODEOWNERS rules with consecutive slashes (`//`) will no longer fail ownership searches
- Granting pending permissions to users when experimentalFeatures.unifiedPermissions is turned ON [#50059](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50059)
- The unified permissions out of band migration reported as unfinished if there were users with no permissions [#50147](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50147)
- Filenames with special characters are correctly handled in Cody's embedding service [#50023](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50023)
- Structural search correctly cleans up when done preventing a goroutine leak [#50034](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50034)
- Fetch search based definitions in the reference panel if no precise definitions were found [#50179](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/50179)

### Removed

# v5.0.0

### Added

- The environment variable `TELEMETRY_HTTP_PROXY` can be set on the `sourcegraph-frontend` service, to use an HTTP proxy for telemetry and update check requests. [#47466](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47466)
- Kubernetes Deployments: Introduced a new Kubernetes deployment option ([deploy-sourcegraph-k8s](https://github.com/sourcegraph/deploy-sourcegraph-k8s)) to deploy Sourcegraph with Kustomize. [#46755](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/46755)
- Kubernetes Deployments: The new Kustomize deployment ([deploy-sourcegraph-k8s](https://github.com/sourcegraph/deploy-sourcegraph-k8s)) introduces a new base cluster that runs all Sourcegraph services as non-root users with limited privileges and eliminates the need to create RBAC resources. [#4213](https://github.com/sourcegraph/deploy-sourcegraph/pull/4213)
- Added the `other.exclude` setting to [Other external service config](/admin/code_hosts/other#configuration). It can be configured to exclude mirroring of repositories matching a pattern similar to other external services. This is useful when you want to exclude repositories discovered via `src serve-git`. [#48168](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48168)
- The **Site admin > Updates** Page displays the upgrade readiness information about schema drift and out-of-band migrations. [#48046](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48046)
- Pings now contain ownership search and file-view activity counts. [#47062](https://github.com/sourcegraph/sourcegraph-public-snapshot/47062)
- Greatly improves keyboard handling and accessibility of the files and symbol tree on the repository pages. [#12916](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/12916)
- The file tree on the repository page now automatically expands into single-child directories. [#47117](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47117)
- When encountering GitHub rate limits, Sourcegraph will now wait the recommended amount of time and retry the request. This prevents sync jobs from failing prematurely due to external rate limits. [#48423](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48423)
- Added a dashboard with information about user and repository background permissions sync jobs. [#46317](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/46317)
- When encountering GitHub or GitLab rate limits, Sourcegraph will now wait the recommended amount of time and retry the request. This prevents sync jobs from failing prematurely due to external rate limits. [#48423](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48423), [#48616](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48616)
- Switching between code editor, files and symbols trees using keyboard shortcuts (currently under the experimental feature flag: `blob-page-switch-areas-shortcuts`). [#46829](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46829).
- Added "SCIM" badges for SCIM-controlled users on the User admin page. [#48727](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48727)
- Added Azure DevOps Services as a Tier 1 Code Host, including: repository syncing, permissions syncing, and Batch Changes support. [#46265](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/46265)
- Added feature to disable some fields on user profiles for SCIM-controlled users. [#48816](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48816)
- Native support for ingesting and searching GitHub topics with `repo:has.topic()` [#48875](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48875)
- [Role- Access Control](/admin/access_control) is now available as an enterprise feature (in Beta). It is currently only supported for Batch Changes functionality. [#43276](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/43276)
- Site admins can now [restrict creation of batch changes to certain u[sers](/admin/access_control/batch_changes) by tailoring their roles and the permissions granted to those )roles. [#34491](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/34491)
- Site admins can now [configure outgoing webh[ooks](/admin/config/webhooks/outgoing) for Batch Changes to inform external tools of events related to Sourceg)raph batch changes and their changesets. [#38278](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/38278)
- [Sourcegraph[ Own](/own) is now available as an experimental enterprise feature. Enable the `search-ownership` fe)ature flag to use it.
- Gitserver supports a new `COURSIER_CACHE_DIR` env var to configure the cache location for coursier JVM package repos.
- Pings now emit a histogram of repository sizes cloned by Sourcegraph [48211](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48211).
- The search input has been redesigned to greatly improve usability. New contextual suggestions help users learn the Sourcegraph query language as they search. Suggestions have been unified across contexts and filters, and the history mode has been integrated into the input. Improved and expanded keyboard shortcuts also make navigation much easier. This functionality is in beta, and can be disabled in the user menu.

### Changed

- Experimental GraphQL query, `permissionsSyncJobs` is substituted with new non-experimental query which provides full information about permissions sync jobs stored in the database. [#47933](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47933)
- Renders `readme.txt` files in the repository page. [#47944](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47944)
- Renders GitHub pull request references in all places where a commit message is referenced. [#48183](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48183)
- CodeMirror blob view (default) uses selection-driven code navigation. [#48066](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48066)
- Older Code Insights data points will now be automatically archived as configured by the site configuration setting `insights.maximumSampleSize`, set to 30 by default. All points can be exported. This behaviour can be disabled using the experimental setting `insightsDataRetention`. [#48259](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48259)
- The admin debug GraphQL endpoint for Code Insights will now include the series metadata in the response. [#49473](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/49473)
- Usage telemetry has been streamlined; there are no longer two categories (critical and non-critical), and telemetry will be streamlined and reviewed/reduced further in upcoming releases. The site admin flag `disableNonCriticalTelemetry` currently still remains but has no effect.

### Fixed

- The symbols service `CACHE_DIR` and `MAX_TOTAL_PATHS_LENGTH` were renamed to have a `SYMBOLS_` prefix in the last version of Sourcegraph; this version fixes a bug where the old names without the `SYMBOLS_` prefix were not respected correctly. Both names now work.
- Fixed issues with propagating tracing configuration throughout the application. [#47428](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47428)
- Enable `auto gc` on fetch when `SRC_ENABLE_GC_AUTO` is set to `true`. [#47852](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47852)
- Fixes syntax highlighting and line number issues in the code preview rendered inside the references panel. [#48107](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48107)
- The ordering of code host sync error messages in the notifications menu will now be persistent. Previously the order was not guaranteed on a refresh of the status messages, which would make the code host sync error messages jump positions, giving a false sense of change to the site admins. [#48722](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48722)
- Fixed Detect & Track Code Insights running over all repositories when during creation a search was used to specify the repositories for the insight. [#49633](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/49633)

### Removed

- The LSIF upload endpoint is no longer supported and has been replaced by a diagnostic error page. src-cli v4.5+ will translate all local LSIF files to SCIP prior to upload. [#47547](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47547)
- The experimental setting `authz.syncJobsRecordsLimit` has been removed. [#47933](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47933)
- Storing permissions sync jobs statuses in Redis has been removed as now all permissions sync related data is stored in a database. [#47933](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47933)
- The key `shared_steps` has been removed from auto-indexing configuration descriptions. If you have a custom JSON auto-indexing configuration set for a repository that defines this key, you should inline the content into each index job's `steps` array. [#48770](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48770)

# v4.5.1

### Changed

- Updated git to version 2.39.2 to address [reported security vulnerabilities](https://github.blog/2023-02-14-git-security-vulnerabilities-announced-3/) [#47892](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47892/files)
- Updated curl to 7.88.1 to address [reported security vulnerabilities](https://curl.se/docs/CVE-2022-42915.html) [#48144](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/48144)

# v4.5.0

### Added

- Endpoint environment variables (`SEARCHER_URL`, `SYMBOLS_URL`, `INDEXED_SEARCH_SERVERS`, `SRC_GIT_SERVERS`) now can be set to replica count values in Kubernetes, Kustomize, Helm and Docker Compose environments. This avoids the need to use service discovery or generating the respective list of addresses in those environments. [#45862](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45862)
- The default author and email for changesets will now be pulled from user account details when possible. [#46385](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46385)
- Code Insights has a new display option: "Max number of series points to display". This setting controls the number of data points you see per series on an insight. [#46653](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46653)
- Added out-of-band migration that will migrate all existing data from LSIF to SCIP (see additional [migration documenta[tion](/admin/how-to/lsif_scip_migration)). [#45106](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45106))
- Code Insights has a new search-powered repositories field that allows you to select repositories with Sourcegraph search syntax. [#45687](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45687)
- You can now export all data for a Code Insight from the card menu or the standalone page. [#46795](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46795), [#46694](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46694)
- Added Gerrit as an officially supported code host with permissions syncing. [#46763](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46763)
- Markdown files now support `<picture>` and `<video>` elements in the rendered view. [#47074](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47074)
- Batch Changes: Log outputs from execution steps are now paginated in the web interface. [#46335](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46335)
- Monitoring: the searcher dashboard now contains more detailed request metrics as well as information on interactions with the local cache (via gitserver). [#47654](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47654)
- Renders GitHub pull request references in the commit list. [#47593](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47593)
- Added a new background permissions syncer & scheduler which is backed by database, unlike the old one that was based on an in-memory processing queue. The new system is enabled by default, but can be disabled. Revert to the in-memory processing queue by setting the feature flag `database-permission-sync-worker` to `false`. [#47783](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47783)
- Zoekt introduces a new opt-in feature, "shard merging". Shard merging consolidates small index files into larger ones, which reduces Zoekt-webserver's memory footprint [documenta[tion](/code_search/explanations/search_details#shard-merging))
- Blob viewer is now backed by the CodeMirror editor. Previous table-based blob viewer can be re-enabled by setting `experimentalFeatures.enableCodeMirrorFileView` to `false`. [#47563](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47563)
- Code folding support for the CodeMirror blob viewer. [#47266](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47266)
- CodeMirror blob keyboard navigation as experimental feature. Can be enabled in settings by setting `experimentalFeatures.codeNavigation` to `selection-driven`. [#44698](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44698)

### Changed

- Archived and deleted changesets are no longer counted towards the completion percentage shown in the Batch Changes UI. [#46831](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46831)
- Code Insights has a new UI for the "Add or remove insights" view, which now allows you to search code insights by series label in addition to insight title. [#46538](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46538)
- When SMTP is configured, users created by site admins via the "Create user" page will no longer have their email verified by default - Users must verify their emails by using the "Set password" link they get sent, or have their emails verified by a site admin via the "Emails" tab in user settings or the `setUserEmailVerified` mutation. The `createUser` mutation retains the old behaviour of automatically marking emails as verified. To learn more, refer to the [SMTP and email deli[very](/admin/config/email) documentation. [#46187](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46187))
- Connection checks for code host connections have been changed to talk to code host APIs directly via HTTP instead of doing DNS lookup and TCP dial. That makes them more resistant in environments where proxies are used. [#46918](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46918)
- Expiration of licenses is now handled differently. When a license is expired promotion to site-admin is disabled, license-specific features are disabled (exceptions being SSO & permission syncing), grace period has been replaced with a 7-day-before-expiration warning. [#47251](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47251)
- Searcher will now timeout searches in 2 hours instead of 10 minutes. This timeout was raised for batch use cases (such as code insights) searching old revisions in very large repositories. This limit can be tuned with the environment variable `PROCESSING_TIMEOUT`. [#47469](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47469)
- Zoekt now bypasses the regex engine for queries that are common in the context of search-based code intelligence, such as `\bLITERAL\b case:yes`. This can lead to a significant speed-up for "Find references" and "Find implementations" if precise code intelligence is not available. [zoekt#526](https://github.com/sourcegraph/zoekt/pull/526)
- The Sourcegraph Free license has undergone a number of changes. Please contact support@sourcegraph.com with any questions or concerns. [#46504](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46504)
  - The Free license allows for only a single private repository on the instance.
  - The Free license does not support SSO of any kind.
  - The Free license does not offer mirroring of code host user permissions.
- Expired Sourcegraph licenses no longer allow continued use of the product. [#47251](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47251)
  - Licensed features are disabled once a license expires.
  - Users can no longer be promoted to Site Admins once a license expires.

### Fixed

- Resolved issue which would prevent Batch Changes from being able to update changesets on forks of repositories on Bitbucket Server created prior to version 4.2. [#47397](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47397)
- Fixed a bug where changesets created on forks of repositories in a personal user's namespace on GitHub could not be updated after creation. [#47397](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47397)
- Fixed a bug where saving default Sort & Limit filters in Code Insights did not persist [#46653](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46653)
- Restored the old syntax for `repo:contains` filters that was previously removed in version 4.0.0. For now, both the old and new syntaxes are supported to allow for smooth upgrades. Users are encouraged to switch to the new syntax, since the old one may still be removed in a future version.
- Fixed a bug where removing an auth provider would render a user's Account Security page inaccessible if they still had an external account associated with the removed auth provider. [#47092](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47092)
- Fixed a bug where the `repo:has.description()` parameter now correctly shows description of a repository synced from a Bitbucket server code host connection, while previously it used to show the repository name instead [#46752](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46752)
- Fixed a bug where permissions syncs consumed more rate limit tokens than required. This should lead to speed-ups in permission syncs, as well as other possible cases where a process runs in repo-updater. [#47374](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47374)
- Fixes UI bug where folders with single child were appearing as child folders themselves. [#46628](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46628)
- Performance issue with the Outbound requests page. [#47544](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47544)

### Removed

- The Code insights "run over all repositories" mode has been replaced with search-powered repositories filed syntax. [#45687](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45687)
- The settings `search.repositoryGroups`, `codeInsightsGqlApi`, `codeInsightsAllRepos`, `experimentalFeatures.copyQueryButton`,, `experimentalFeatures.showRepogroupHomepage`, `experimentalFeatures.showOnboardingTour`, `experimentalFeatures.showSearchContextManagement` and `codeIntelligence.autoIndexRepositoryGroups` have been removed as they were deprecated and unsued. [#47481](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47481)
- The site config `enableLegacyExtensions` setting was removed. It is no longer possible to enable legacy Sourcegraph extension API functionality in this version.

# v4.4.2

### Changed

- Expiration of licenses is now handled differently. When a license is expired promotion to site-admin is disabled, license-specific features are disabled (exceptions being SSO & permission syncing), grace period has been replaced with a 7-day-before-expiration warning. [#47251](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/47251)

# v4.4.1

### Changed

- Connection checks for code host connections have been changed to talk to code host APIs directly via HTTP instead of doing DNS lookup and TCP dial. That makes them more resistant in environments where proxies are used. [#46918](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46918)
- The search query input overflow behavior on search home page has been fixed. [#46922](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46922)

# v4.4.0

### Added

- Added a button "Reindex now" to the index status page. Admins can now force an immediate reindex of a repository. [#45533](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45533)
- Added an option "Unlock user" to the actions dropdown on the Site Admin Users page. Admins can unlock user accounts that wer locked after too many sign-in attempts. [#45650](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45650)
- Templates for certain emails sent by Sourcegraph are now configurable via `email.templates` in site configuration. [#45671](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45671), [#46085](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46085)
- Keyboard navigation for search results is now enabled by default. Use Arrow Up/Down keys to navigate between search results, Arrow Left/Right to collapse and expand file matches, Enter to open the search result in the current tab, Ctrl/Cmd+Enter to open the result in a separate tab, / to refocus the search input, and Ctrl/Cmd+Arrow Down to jump from the search input to the first result. Arrow Left/Down/Up/Right in previous examples can be substituted with h/j/k/l for Vim-style bindings. Keyboard navigation can be disabled by creating the `search-results-keyboard-navigation` feature flag and setting it to false. [#45890](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45890)
- Added support for receiving GitLab webhook `push` events. [#45856](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45856)
- Added support for receiving Bitbucket Server / Datacenter webhook `push` events. [#45909](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45909)
- Monitoring: Indexed-Search's dashboard now has new graphs for search request durations and "in-flight" search request workloads [#45966](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45966)
- The GraphQL API now supports listing single-file commit history across renames (with `GitCommit.ancestors(follow: true, path: "<some-path>")`). [#45882](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45882)
- Added support for receiving Bitbucket Cloud webhook `push` events. [#45960](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45960)
- Added a way to test code host connection from the `Manage code hosts` page. [#45972](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45972)
- Updates to the site configuration from the site admin panel will now also record the user id of the author in the database in the `critical_and_site_config.author_user_id` column. [#46150](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46150)
- When setting and resetting passwords, if the user's primary email address is not yet verified, using the password reset link sent via email will now also verify the email address. [#46307](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46307)
- Added new code host details and updated edit code host pages in site admin area. [#46327](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46327)
- If the experimental setting `insightsDataRetention` is enabled, the number of Code Insights data points that can be viewed will be limited by the site configuration setting `insights.maximumSampleSize`, set to 30 by default. Older points beyond that number will be periodically archived. [#46206](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46206), [#46440](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46440)
- Bitbucket Cloud can now be added as an authentication provider on Sourcegraph. [#46309](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46309)
- Bitbucket Cloud code host connections now support permissions syncing. [#46312](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46312)
- Keep a log of corruption events that happen on repositories as they are detected. The Admin repositories page will now show when a repository has been detected as being corrupt and they'll also be able to see a history log of the corruption for that repository. [#46004](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46004)
- Added corrupted statistic as part of the global repositories statistics. [46412](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46412)
- Added a `Corrupted` status filter on the Admin repositories page, allowing Administrators to filter the list of repositories to only those that have been detected as corrupt. [#46415](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46415)
- Added â€œBackground job dashboardâ€ admin feature [#44901](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44901)

### Changed

- Code Insights no longer uses a custom index of commits to compress historical backfill and instead queries the repository log directly. This allows the compression algorithm to span any arbitrary time frame, and should improve the reliability of the compression in general. [#45644](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45644)
- GitHub code host configuration: The error message for non-existent organizations has been clarified to indicate that the organization is one that the user manually specified in their code host configuration. [#45918](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45918)
- Git blame view got a user-interface overhaul and now shows data in a more structured way with additional visual hints. [#44397](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/44397)
- User emails marked as unverified will no longer receive code monitors and account update emails - Unverified emails can be verified from the user settings page to continue receiving these emails. [#46184](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46184)
- Zoekt by default eagerly unmarshals the symbol index into memory. Previously we would unmarshal on every request for the purposes of symbol searches or ranking. This lead to pressure on the Go garbage collector. On sourcegraph.com we have noticed time spent in the garbage collector halved. In the unlikely event this leads to more OOMs in zoekt-webserver, you can disable by setting the environment variable `ZOEKT_ENABLE_LAZY_DOC_SECTIONS=t`. [zoekt#503](https://github.com/sourcegraph/zoekt/pull/503)
- Removes the right side action sidebar that is shown on the code view page and moves the icons into the top nav. [#46339](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46339)
- The `sourcegraph/prometheus` image no longer starts with `--web.enable-lifecycle --web.enable-admin-api` by default - These flags can be re-enabled by configuring `PROMETHEUS_ADDITIONAL_FLAGS` on the container. [#46393](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46393)
- The experimental setting `authz.syncJobsRecordsTTL` has been changed to `authz.syncJobsRecordsLimit` - Records are no longer retained based on age, but based on this size cap. [#46676](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46676)
- Renders GitHub pull request references in git blame view. [#46409](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46409)

### Fixed

- Made search results export use the same results list as the search results page. [#45702](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45702)
- Code insights with more than 1 year of history will correctly show 12 data points instead of 11. [#45644](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45644)
- Hourly code insights will now behave correctly and will no longer truncate to midnight UTC on the calendar date the insight was created. [#45644](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45644)
- Code Insights: fixed an issue where filtering by a search context that included multiple repositories would exclude data. [#45574](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45574)
- Ignore null JSON objects returned from GitHub API when listing public repositories. [#45969](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45969)
- Fixed issue where emails that have never been verified before would be unable to receive resent verification emails. [#46185](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46185)
- Resolved issue preventing LSIF uploads larger than 2GiB (gzipped) from uploading successfully. [#46209](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46209)
- Local vars in Typescript are now detected as symbols which will positively impact ranking of search results. [go-ctags#10](https://github.com/sourcegraph/go-ctags/pull/10)
- Fix issue in Gitlab OAuth in which user group membership is set too wide - Adds `min_access_level=10` to `/groups` request. [#46480](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46480)

### Removed

- The extension registry no longer supports browsing, creating, or updating legacy extensions. Existing extensions may still be enabled or disabled in user settings and may be listed via the API. (The extension API was deprecated in 2022-09 but is still available if the `enableLegacyExtensions` site config experimental features flag is enabled.)
- User and organization auto-defined search contexts have been permanently removed along with the `autoDefinedSearchContexts` GraphQL query. The only auto-defined context now is the `global` context. [#46083](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46083)
- The settings `experimentalFeatures.showSearchContext`, `experimentalFeatures.showSearchNotebook`, and `experimentalFeatures.codeMonitoring` have been removed and these features are now permanently enabled when available. [#46086](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46086)
- The legacy panels on the homepage (recent searches, etc) which were turned off by default but could still be re-enabled by setting `experimentalFeatures.showEnterpriseHomePanels` to true, are permanently removed now. [#45705](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45705)
- The `site { monitoringStatistics { alerts } }` GraphQL query has been deprecated and will no longer return any data. The query will be removed entirely in a future release. [#46299](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46299)
- The Monaco version of the search query input and the corresponding feature flag (`experimentalFeatures.editor`) have been permanently removed. [#46249](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46249)

# v4.3.1

### Changed

- A bug that broke the site-admin page when no repositories have been added to the Sourcegraph instance has been fixed. [#46123](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/46123)

# v4.3.0

### Added

- A "copy path" button has been added to file content, path, and symbol search results on hover or focus, next to the file path. The button copies the relative path of the file in the repo, in the same way as the "copy path" button in the file and repo pages. [#42721](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42721)
- Unindexed search now use the index for files that have not changed between the unindexed commit and the indexed commit. The result is faster unindexed search in general. If you are noticing issues you can disable by setting the feature flag `search-hybrid` to false. [#37112](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/37112)
- The number of commits listed in the History tab can now be customized for all users by site admins under Configuration -> Global Settings from the site admin page by using the config `history.defaultPageSize`. Individual users may also set `history.defaultPagesize` from their user settings page to override the value set under the Global Settings. [#44651](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44651)
- Batch Changes: Mounted files can be accessed via the UI on the executions page. [#43180](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43180)
- Added "Outbound request log" feature for site admins [#44286](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44286)
- Code Insights: the data series API now provides information about incomplete datapoints during processing
- Added a best-effort migration such that existing Code Insights will display zero results instead of missing points at the start and end of a graph. [#44928](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44928)
- More complete stack traces for Outbound request log [#45151](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45151)
- A new status message now reports how many repositories have already been indexed for search. [#45246](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45246)
- Search contexts can now be starred (favorited) in the search context management page. Starred search contexts will appear before other contexts in the context dropdown menu next to the search box. [#45230](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45230)
- Search contexts now let you set a context as your default. The default will be selected every time you open Sourcegraph and will appear near the top in the context dropdown menu next to the search box. [#45387](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45387)
- [search.largeF[iles](/admin/config/site_config#search-largeFiles) accepts an optional prefix `!` to negate a pattern. The o)rder of the patterns within search.largeFiles is honored such that the last pattern matching overrides preceding patterns. For patterns that begin with a literal `!` prefix with a backslash, for example, `\!fileNameStartsWithExcl!.txt`. Previously indexed files that become excluded due to this change will remain in the index until the next reindex [#45318](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45318)
- [Webh[ooks](/admin/config/webhooks/incoming) have been overhauled completely and can now be found under **Site admin >) Repositories > Incoming webhooks**. Webhooks that were added via code host configuration are [deprec[ated](/admin/config/webhooks/incoming#deprecation-notice) and will be removed in 5.1.0.
- Added support fo)r receiving webhook `push` events from GitHub which will trigger Sourcegraph to fetch the latest commit rather than relying on polling.
- Added support for private container registries in Sourcegraph executors. [Using private registries](/admin/executors/deploy_executors#using-private-registries)

### Changed

- Batch Change: When one or more changesets are selected, we now display all bulk operations but disable the ones that aren't applicable to the changesets. [#44617](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44617)
- Gitserver's repository purge worker now runs on a regular interval instead of just on weekends, configurable by the `repoPurgeWorker` site configuration. [#44753](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44753)
- Editing the presentation metadata (title, line color, line label) or the default filters of a scoped Code Insight will no longer trigger insight recalculation. [#44769](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44769), [#44797](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44797)
- Indexed Search's `memory_map_areas_percentage_used` alert has been modified to alert earlier than it used to. It now issues a warning at 60% (previously 70%) and issues a critical alert at 80% (previously 90%).
- Saving a new view of a scoped Code Insight will no longer trigger insight recalculation. [#44679](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44679)

### Fixed

- The Code Insights commit indexer no longer errors when fetching commits from empty repositories when sub-repo permissions are enabled. [#44558](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44558)
- Unintended newline characters that could appear in diff view rendering have been fixed. [#44805](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44805)
- Signing out doesn't immediately log the user back in when there's only one OAuth provider enabled. It now redirects the user to the Sourcegraph login page. [#44803](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44803)
- An issue causing certain kinds of queries to behave inconsistently in Code Insights. [#44917](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44917)
- When the setting `batchChanges.enforceForks` is enabled, Batch Changes will now prefix the name of the fork repo it creates with the original repo's namespace name in order to prevent repo name collisions. [#43681](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43681), [#44458](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44458), [#44548](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44548), [#44924](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44924)
- Code Insights: fixed an issue where certain queries matching sequential whitespace characters would overcount. [#44969](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44969)
- GitHub fine-grained Personal Access Tokens can now clone repositories correctly, but are not yet officially supported. [#45137](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45137)
- Detect-and-track Code Insights will now return data for repositories without sub-repo permissions even when sub-repo permissions are enabled on the instance. [#45631](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45361)

### Removed

- Removed legacy GraphQL field `dirtyMetadata` on an insight series. `insightViewDebug` can be used as an alternative. [#44416](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44416)
- Removed `search.index.enabled` site configuration setting. Search indexing is now always enabled.
- Removed the experimental feature setting `showSearchContextManagement`. The search context management page is now available to all users with access to search contexts. [#45230](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45230)
- Removed the experimental feature setting `showComputeComponent`. Any notebooks that made use of the compute component will no longer render the block. The block will be deleted from the databse the next time a notebook that uses it is saved. [#45360](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45360)

# v4.2.1

- `minio` has been replaced with `blobstore`. Please see the update notes [here](/admin/how-to/blobstore_update_notes)

# v4.2.0

### Added

- Creating access tokens is now tracked in the security events. [#43226](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43226)
- Added `codeIntelAutoIndexing.indexerMap` to site-config that allows users to update the indexers used when inferring precise code intelligence auto-indexing jobs (without having to overwrite the entire inference scripts). For example, `"codeIntelAutoIndexing.indexerMap": {"go": "my.registry/sourcegraph/lsif-go"}` will cause Go projects to use the specified container (in a alternative Docker registry). [#43199](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43199)
- Code Insights data points that do not contain any results will display zero instead of being omitted from the visualization. Only applies to insight data created after 4.2. [#43166](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43166)
- Sourcegraph ships with node-exporter, a Prometheus tool that provides hardware / OS metrics that helps Sourcegraph scale your deployment. See your deployment update for more information:
  - [Kubernetes](/admin/updates/kubernetes)
  - [Docker Compose](/admin/updates/docker_compose)
- A structural search diagnostic to warn users when a language filter is not set. [#43835](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43835)
- GitHub/GitLab OAuth success/fail attempts are now a part of the audit log. [#43886](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43886)
- When rendering a file which is backed by Git LFS, we show a page informing the file is LFS and linking to the file on the codehost. Previously we rendered the LFS pointer. [#43686](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43686)
- Batch changes run server-side now support secrets. [#27926](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/27926)
- OIDC success/fail login attempts are now a part of the audit log. [#44467](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44467)
- A new experimental GraphQL query, `permissionsSyncJobs`, that lists the states of recently completed permissions sync jobs and the state of each provider. The TTL of entries retrained can be configured with `authz.syncJobsRecordsTTL`. [#44387](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44387), [#44258](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44258)
- The search input has a new search history button and allows cycling through recent searches via up/down arrow keys. [#44544](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44544)
- Repositories can now be ordered by size on the repo admin page. [#44360](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44360)
- The search bar contains a new Smart Search toggle. If a search returns no results, Smart Search attempts alternative queries based on a fixed set of rules, and shows their results (if there are any). Smart Search is enabled by default. It can be disabled by default with `"search.defaultMode": "precise"` in settings. [#44385](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44395)
- Repositories in the site-admin area can now be filtered, so that only indexed repositories are displayed [#45288](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/45288)

### Changed

- Updated minimum required version of `git` to 2.38.1 in `gitserver` and `server` Docker image. This addresses: https://github.blog/2022-04-12-git-security-vulnerability-announced/ and https://lore.kernel.org/git/d1d460f6-e70f-b17f-73a5-e56d604dd9d5@github.com/. [#43615](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43615)
- When a `content:` filter is used in a query, only file contents will be searched (previously any of file contents, paths, or repos were searched). However, as before, if `type:` is also set, the `content:` filter will search for results of the specified `type:`. [#43442](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43442)
- Updated [p4-fusion](https://github.com/salesforce/p4-fusion) from `1.11` to `1.12`.

### Fixed

- Fixed a bug where path matches on files in the root directory of a repository were not highlighted. [#43275](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43275)
- Fixed a bug where a search query wouldn't be validated after the query type has changed. [#43849](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43849)
- Fixed an issue with insights where a single erroring insight would block access to all insights. This is a breaking change for users of the insights GraphQL api as the `InsightViewConnection.nodes` list may now contain `null`. [#44491](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44491)
- Fixed a bug where Open in Editor didn't work well with `"repositoryPathPattern" = "{nameWithOwner}"` [#43839](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/44475)

### Removed

- Remove the older `log.gitserver.accessLogs` site config setting. The setting is succeeded by `log.auditLog.gitserverAccess`. [#43174](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43174)
- Remove `LOG_ALL_GRAPHQL_REQUESTS` env var. The setting is succeeded by `log.auditLog.graphQL`. [#43181](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43181)
- Removed support for setting `SRC_ENDPOINTS_CONSISTENT_HASH`. This was an environment variable to support the transition to a new consistent hashing scheme introduced in 3.31.0. [#43528](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43528)
- Removed legacy environment variable `ENABLE_CODE_INSIGHTS_SETTINGS_STORAGE` used in old versions of Code Insights to fall back to JSON settings based storage. All data was previously migrated in version 3.35 and this is no longer supported.

# v4.1.3

### Fixed

- Fixed a bug that caused the Phabricator native extension to not load the right CSS assets. [#43868](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43868)
- Fixed a bug that prevented search result exports to load. [#43344](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43344)

# v4.1.2

### Fixed

- Fix code navigation on OSS when CodeIntel is unavailable. [#43458](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43458)

### Removed

- Removed the onboarding checklist for new users that showed up in the top navigation bar, on user profiles, and in the site-admin overview page. After changes to the underlying user statistics system, the checklist caused severe performance issues for customers with large and heavily-used instances. [#43591](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43591)

# v4.1.1

### Fixed

- Fixed a bug with normalizing the `published` draft value for `changeset_specs`. [#43390](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43390)

# v4.1.0

### Added

- Outdated executors now show a warning from the admin page. [#40916](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40916)
- Added support for better Slack link previews for private instances. Link previews are currently feature-flagged, and site admins can turn them on by creating the `enable-link-previews` feature flag on the `/site-admin/feature-flags` page. [#41843](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41843)
- Added a new button in the repository settings, under "Mirroring", to delete a repository from disk and reclone it. [#42177](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42177)
- Batch changes run on the server can now be created within organisations. [#36536](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/36536)
- GraphQL request logs are now compliant with the audit logging format. The old GraphQl logging based on `LOG_ALL_GRAPHQL_REQUESTS` env var is now deprecated and scheduled for removal. [#42550](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42550)
- Mounting files now works when running batch changes server side. [#31792](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/31792)
- Added mini dashboard of total batch change metrics to the top of the batch changes list page. [#42046](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42046)
- Added repository sync counters to the code host details page. [#43039](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/43039)

### Changed

- Git server access logs are now compliant with the audit logging format. Breaking change: The 'actor' field is now nested under 'audit' field. [#41865](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41865)
- All Perforce rules are now stored together in one column and evaluated on a "last rule takes precedence" basis. [#41785](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41785)
- Security events are now a part of the audit log. [#42653](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42653)
- "GC AUTO" is now the default garbage collection job. We disable sg maintenance, which had previously replace "GC AUTO", after repeated reports about repo corruption. [#42856](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42856)
- Security events (audit log) can now optionally omit the internal actor actions (internal traffic). [#42946](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42946)
- To use the optional `customGitFetch` feature, the `ENABLE_CUSTOM_GIT_FETCH` env var must be set on `gitserver`. [#42704](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42704)

### Fixed

- WIP changesets in Gitlab >= 14.0 are now prefixed with `Draft:` instead of `WIP:` to accomodate for the [breaking change in Gitlab 14.0](https://docs.gitlab.com/ee/update/removals.html#wip-merge-requests-renamed-draft-merge-requests). [#42024](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42024)
- When updating the site configuration, the provided Last ID is now used to prevent race conditions when simultaneous config updates occur. [#42691](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42691)
- When multiple auth providers of the same external service type is set up, there are now separate entries in the user's Account Security settings. [#42865](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42865)
- Fixed a bug with GitHub code hosts that did not label archived repos correctly when using the "public" repositoryQuery keyword. [#41461](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41461)
- Fixed a bug that would display the blank batch spec that a batch change is initialized with in the batch specs executions tab. [#42914](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42914)
- Fixed a bug that would cause menu dropdowns to not open appropriately. [#42779](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42779)

### Removed

-

# v4.0.1

### Fixed

- Fixed a panic that can be caused by some tracing configurations. [#42027](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42027)
- Fixed broken code navigation for Javascript. [#42055](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/42055)
- Fixed issue with empty code navigation popovers. [#41958](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41958)

# v4.0.0

### Added

- A new look for Sourcegraph, previously in beta as "Simple UI", is now permanently enabled. [#41021](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41021)
- A new [multi-version upgrade](/admin/updates#multi-version-upgrades) process now allows Sourcegraph instances to upgrade more than a single minor version. Instances at version 3.20 or later can now jump directly to 4.0. [#40628](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40628)
- Matching ranges in file paths are now highlighted for path results and content results. Matching paths in repository names are now highlighted for repository results. [#41296](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41296) [#41385](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41385) [#41470](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41470)
- Aggregations by repository, file, author, and capture group are now provided for search results. [#39643](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/39643)
- Blob views and search results are now lazily syntax highlighted for better performance. [#39563](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/39563) [#40263](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40263)
- File links in both the search results and the blob sidebar and now prefetched on hover or focus. [#40354](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40354) [#41420](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41420)
- Negation support for the search predicates `-repo:has.path()` and `-repo:has.content()`. [#40283](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40283)
- Experimental clientside OpenTelemetry can now be enabled with `"observability.client": { "openTelemetry": "/-/debug/otlp" }`, which sends OpenTelemetry to the new [bundled OpenTelemetry Collector](/admin/observability/opentelemetry). [#37907](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/37907)
- File diff stats are now characterized by 2 figures: lines added and lines removed. Previously, a 3rd figure for lines modified was also used. This is represented by the fields on the `DiffStat` type on the GraphQL API. [#40454](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40454)

### Changed
- [Sourcegraph with Kubernetes (without Helm)](/admin/deploy/kubernetes): The `jaeger-agent` sidecar has been replaced by an [OpenTelemetry Collector](/admin/observability/opentelemetry) DaemonSet + Deployment configuration. The bundled Jaeger instance is now disabled by default, instead of enabled. [#40456](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/40456)
- [Sourcegraph with Docker Compose](/admin/deploy/docker-compose): The `jaeger` service has been replaced by an [OpenTelemetry Collector](/admin/observability/opentelemetry) service. The bundled Jaeger instance is now disabled by default, instead of enabled. [#40455](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/40455)
- `"observability.tracing": { "type": "opentelemetry" }` is now the default tracer type. To revert to existing behaviour, set `"type": "jaeger"` instead. The legacy values `"type": "opentracing"` and `"type": "datadog"` have been removed. [#41242](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41242)
- `"observability.tracing": { "urlTemplate": "" }` is now the default, and if `"urlTemplate"` is left empty, no trace URLs are generated. To revert to existing behaviour, set `"urlTemplate": "{{ .ExternalURL }}/-/debug/jaeger/trace/{{ .TraceID }}"` instead. [#41242](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41242)
- Code host connection tokens are no longer supported as a fallback method for syncing changesets in Batch Changes. [#25394](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/25394)
- **IMPORTANT:** `repo:contains(file:foo content:bar)` has been renamed to `repo:contains.file(path:foo content:bar)`. `repo:contains.file(foo)` has been renamed to `repo:contains.path(foo)`. `repo:contains()` **is no longer a valid predicate. Saved searches using** `repo:contains()` **will need to be updated to use the new syntax.** [#40389](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40389)

### Fixed

- Fixed support for bare repositories using the src-cli and other codehost type. This requires the latest version of src-cli. [#40863](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40863)
- The recommended [src-cli](https://github.com/sourcegraph/src-cli) version is now reported consistently. [#39468](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/39468)
- A performance issue affecting structural search causing results to not stream. It is much faster now. [#40872](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40872)
- An issue where the saved search input box reports an invalid pattern type for `standard`, which is now valid. [#41068](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41068)
- Git will now respect system certificate authorities when specifying `certificates` for the `tls.external` site configuration. [#38128](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/38128)
- Fixed a bug where setting `"observability.tracing": {}` would disable tracing, when the intended behaviour is to default to tracing with `"sampling": "selective"` enabled by default. [#41242](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41242)
- The performance, stability, and latency of search predicates like `repo:has.file()`, `repo:has.content()`, and `file:has.content()` have been dramatically improved. [#418](https://github.com/sourcegraph/zoekt/pull/418), [#40239](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40239), [#38988](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/38988), [#39501](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/39501)
- A search query issue where quoted patterns inside parenthesized expressions would be interpreted incorrectly. [#41455](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41455)

### Removed

- `CACHE_DIR` has been removed from the `sourcegraph-frontend` deployment. This required ephemeral storage which will no longer be needed. This variable (and corresponding filesystem mount) has been unused for many releases. [#38934](https://github.com/sourcegraph/sourcegraph-public-snapshot/issues/38934)
- Quick links will no longer be shown on the homepage or search sidebar. The `quicklink` setting is now marked as deprecated. [#40750](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40750)
- Quick links will no longer be shown on the homepage or search sidebar if the "Simple UI" toggle is enabled and will be removed entirely in a future release. The `quicklink` setting is now marked as deprecated. [#40750](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/40750)
- `file:contains()` has been removed from the list of valid predicates. `file:has.content()` and `file:contains.content()` remain, both of which work the same as `file:contains()` and are valid aliases of each other.
- The single-container `sourcegraph/server` deployment no longer bundles a Jaeger instance. [#41244](https://github.com/sourcegraph/sourcegraph-public-snapshot/pull/41244)
- The following previously-deprecated fields have been removed from the Batch Changes GraphQL API: `GitBranchChangesetDescription.headRepository`, `BatchChange.initialApplier`, `BatchChange.specCreator`, `Changeset.publicationState`, `Changeset.reconcilerState`, `Changeset.externalState`.

## Older versions

For older versions of Sourcegraph, see the [CHANGELOG](https://github.com/sourcegraph/sourcegraph-public-snapshot/blob/main/CHANGELOG.md) on GitHub.
