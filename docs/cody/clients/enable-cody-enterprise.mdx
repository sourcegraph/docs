<!-- Hackathon -->
# Enabling Cody on Sourcegraph Enterprise

<p className="subtitle">This guide will walk you through the steps to install and set up Cody with your Sourcegraph Enterprise instance.</p>

Cody enhances your coding experience by providing intelligent code suggestions, context-aware completions, and advanced code analysis.

<LinkCards>
   <LinkCard href="https://sourcegraph.com/contact/request-info" imgSrc="https://sourcegraph.com/.assets/img/sourcegraph-mark.svg" imgAlt="Cody Enterprise" title="Cody Enterprise" description="Get in touch with our team to try Cody for Sourcegraph Enterprise." />
</LinkCards>

## Cody Enterprise features

To cater to your Enterprise requirements, Cody Enterprise offers the following features:

### IDE Token Expiry

Site administrators can customize the time duration of the access token used by other users on the Sourcegraph Enterprise instance to connect Cody from their IDEs via the **Site admin** page. Administrators can choose from various options, including 7, 14, 30, 60, and 90 days.

![ide-token-expiry](https://storage.googleapis.com/sourcegraph-assets/Docs/token-expiry.png)

### Guardrails

<Callout type= "note">Guardrails for public code is currently in Beta stage and is supported with VS Code and JetBrains IDEs extensions.</Callout>

Open source attribution guardrails for public code reduce the exposure to copyrighted code, commonly called copyright guardrails. This involves the implementation of a verification mechanism within Cody to ensure that any code generated by the platform does not replicate open source code.

Guardrails for public code are available to all Sourcegraph Enterprise instances and are **disabled** by default. You can enable it from the **Site configuration**. You can do so by setting `"attribution.enabled": true` in site config.

It only matches code snippets that are at least **10 lines** or longer, and the search corpus **290,000** open source repositories.

<Callout type="info">Guardrails don't differentiate between license types. It matches any code snippet that is at least 10 lines long from the 290,000 indexed open source repositories.</Callout>

### Admin Controls

<Callout type="note">Admin Controls is supported with VS Code and JetBrains IDE extension.</Callout>

Sourcegraph account admins have selective control over users' access to Cody Enterprise, which is now managed via the Sourcegraph role-based access control system. This provides a more intuitive user interface for assigning permission to use Cody.

### Analytics

<Callout type= "note">Cody Analytics are supported with VS Code IDE extension and on the latest versions of JetBrains IDE.</Callout>

Cody Enterprise users get a clear view of usage analytics for their instance on a self-service basis. A separately managed cloud service for Cody analytics handles user auth, gets metrics data from Sourcegraph's BigQuery instance, and visualizes the metrics data.

The following metrics are available for Cody Enterprise users:

| **Metric Type** |                                                                                                                                                                         **What is measured?**                                                                                                                                                                          |
| --------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Active users    | - Total active users <br /> - Average daily users <br /> - Average no. of days each user used Cody (of last 30 days) <br /> - Cody users by day (last 30 days) <br /> - Cody users by month (last two months) <br /> - Cody users by number of days used                                                                                                               |
| Completions     | - Total accepted completions <br /> - Minutes saved per completion <br /> - Hours saved by completions <br /> - Cody completions by day <br /> - Completions acceptance rate <br /> - Weighted completions acceptance rate <br /> - Average completion latency <br /> - Acceptance rate by language <br /> |
| Chat            | - Total chat events <br /> - Minutes saved per chat <br /> - Hours saved by chats <br /> - Cody chats by day                                                                                                                                                                                                                      |
| Commands        | - Total command events <br /> - Minutes saved per command <br /> - Hours saved by commands <br /> - Cody commands by day <br /> - Most used commands                                                                                                                                                                              |

To enable Cody Analytics:

- Create an account on [Sourcegraph Accounts](https://accounts.sourcegraph.com/)
- A user already having an account on Sourcegraph.com gets automatically migrated to Sourcegraph Accounts. Users can sign in to Cody Analytics using their email and password
- Users without a Sourcegraph.com account, please get in touch with one of our teammates. They can help with both the account setup and assigning instances to specific users
- Map your user account to a Sourcegraph instance, and this gives you access to Cody's analytics

### Multi-repository context

<Callout type="info">Multi-repo context for Sourcegraph Enterprise is supported with VS Code and JetBrains editor extensions.</Callout>

Cody Enterprise supports searching up to 10 repositories to find relevant context in chat.

* In VS Code, open a new Cody chat, type `@`, and select `Remote Repositories` to search other repositories for context
* In JetBrains, use the enhanced context selector

### @-mention directory

<Callout type="info">@-mentioning directory is available for Enterprise users on VS Code, JetBrains, and Cody Web.</Callout>

To better support teams working with large monorepos, Enterprise users can `@-mention` directories when chatting with Cody. This helps you define more specific directories and sub-directories within that monorepo to give more precise context.

To do this, type `@` in the chat, and then select **Directories** to search other repositories for context in your codebase.

<video width="1920" height="1080" loop playsInline controls style={{ width: '100%', height: 'auto' }}>
  <source src="https://storage.googleapis.com/sourcegraph-assets/Docs/Media/%40-mention-dir-0824.mp4" type="video/mp4"/>
</video>

Please note that you can only `@-mention` remote directories (i.e., directories in your Sourcegraph instance) but not local directories. This means any recent changes to your directories can't be utilized as context until your Sourcegraph instance re-indexes any changes.

If you want to include recent changes that haven't been indexed in your Sourcegraph instance, you can `@-mention` specific files, lines of code, or symbols.

## Supported LLM models

Sourcegraph Enterprise supports many different LLM providers and models. You can use state of the art code completion models such as Anthropic's Claude or OpenAI's ChatGPT by adjusting your Sourcegraph instance's configuration.

Refer to the [Model Configuration](/cody/clients/model-configuration) or [Supported Models](/cody/capabilities/supported-models) sections for more information.
Use the drop-down menu to make your desired selection and get a detailed breakdown of the supported LLM models for each provider on Cody Enterprise.

<FeatureParity type='ent' />
For the supported LLM models listed above refer to the following notes:

1. Microsoft Azure is planning to deprecate the APIs used in SG version less than `5.3.3` on July 1, 2024 [Source](https://learn.microsoft.com/en-us/azure/ai-services/openai/api-version-deprecation)
2. Claude 2.1 is not recommended
3. Sourcegraph doesn't recommend GPT-4 non-turbo, Claude 1 or 2 models
4. Only supported through legacy completions API
5. BYOK with managed services are only supported for Self-hosted Sourcegraph instances
6. GPT-4 and GPT-4o for completions has a bug that is resulting in many failed completions

### Supported model configuration

Use the drop-down menu to make your desired selection and get a detailed breakdown of the supported model configuration for each provider on Cody Enterprise. This is an on-site configuration. Admins should pick a value from the table for `chatModel` to configure their chat model.

<FeatureParity type='configuration' />

For the supported LLM model configuration listed above refer to the following notes:

1. Microsoft Azure is planning to deprecate the APIs used in SG version less than `5.3.3` on July 1, 2024 [Source](https://learn.microsoft.com/en-us/azure/ai-services/openai/api-version-deprecation)
2. Claude 2.1 is not recommended
3. Sourcegraph doesn't recommend GPT-4 non-turbo, Claude 1 or 2 models
4. Only supported through legacy completions API
5. BYOK with managed services are only supported for Self-hosted Sourcegraph instances
