# Cody Context Filters

<p className="subtitle">Learn how to ignore specific files or folders in your codebase when using Cody Context Filters.</p>

This documentation helps you control what context from your codebase is used by Cody. You can do it via:

- Cody Context Filters (Cody Enterprise Only)
- Cody Ignore File (All Cody users)

## Context Filters

<Callout type="note">Context Filters is available for all Cody Enterprise users.</Callout>

Admins on the Sourcegraph Enterprise instance can use the Cody Context Filters to determine which repositories Cody can use as the context in its requests to third-party LLMs. This feature is only supported with the following requirements:

- A valid Cody Enterprise license and a running Sourcegraph version `>=5.4.0`
- Works if you're using Cody for VS Code, Cody for JetBrains, and Cody for Web as your client
- Your Cody client meets the following version specs: VS Code `>=1.20.0` and JetBrains `>=6.0.0`
- Setting the `cody-context-filters-enabled` feature flag to `true`

Administrators can configure the `cody.contextFilters` field in the site configuration with the repos that they wish Cody to exclude or only include using the following structure:

```
{
	// Optional. If defined, it must have at least one
	// field set (either `include` or `exclude`).
	'cody.contextFilters': {
		// Optional. If defined, it must have at least one item.
		include: [
			{
				// Required. Should follow the RE2 syntax.
				repoNamePattern: '^github\\.com\\/sourcegraph\\/.*'
			}
		],
		// Optional. If defined, it must have at least one item.
		exclude: [
			{
				// Required. Should follow the RE2 syntax.
				repoNamePattern: '.*analytics.*'
			}
		]
	}
}
```

### Interaction between include and exclude rules

1. `cody.contextFilters` field is not defined

By default, there are no restrictions on the repositories Cody can use for context in requests to third-party LLMs. All repositories are included, and none are excluded.

2. Only `include` rules are specified

Cody is restricted from using content from repositories whose names match any specified patterns in the `include` field. Since no `exclude` rules are specified, no repositories are explicitly excluded. An `include` field might contain a catch-all pattern (e.g., a `regexp` matching any string). In this case, Cody can access content from any repository, as a single match in the `include` rules is sufficient for inclusion. For example,

```
{
	'cody.contextFilters': {
		// Only repositories whose names either start with 'github.com/sourcegraph/'
		// or contain 'cody' are allowed.
		include: [
			{repoNamePattern: '^github\\.com\\/sourcegraph\\/.+'},
			{repoNamePattern: '.*cody.*'}
		]
	}
}
```

3. Only `exclude` rules are specified

All repositories are considered included by default without the `include` rules. Cody is prohibited from using content from any repository whose name matches at least one pattern specified in the exclude field. An `exclude` field may also contain a catch-all condition (e.g., a `regexp` matching any string). If such a match occurs, Cody is restricted from using content from any repository. For example,

```
{
	'cody.contextFilters': {
		// All repositories are allowed except for "github.com/sourcegraph/cody-analytics"
		// or the ones containing "secret" in their name.
		exclude: [
			{repoNamePattern: '^github\\.com\\/sourcegraph\\/cody-analytics$'},
			{repoNamePattern: '.*secret.*'}
		]
	}
}
```

4. Both `include` and `exclude` rules are specified

When making requests to third-party LLMs, Cody can use content from a repository if its name matches any of the `include` patterns and does not match any of the `exclude` patterns. Thus, the `exclude` rules filter only the repositories allowed by the `include` rules. For example,

```
{
	'cody.contextFilters': {
		// All repositories starting with "github.com/sourcegraph/" are allowed
		include: [{repoNamePattern: '^github\\.com\\/sourcegraph\\/.+'}],
		// except for "github.com/sourcegraph/cody-analytics"
		// and the ones containing "cody" in their name.
		exclude: [
			{repoNamePattern: '^github\\.com\\/sourcegraph\\/cody-analytics$'},
			{repoNamePattern: '.*cody.*'}
		]
	}
}
```

## Cody Ignore Files

<Callout type="note">Cody Ignore File functionality is available for Cody Free, Pro users and is currently in the Experimental stage and only supported in the VS Code extension.</Callout>

All Cody users can also configure the `.codyignore` file to specify files or folders from your codebase to be ignored as context by Cody through the following steps:

## Enabling Unstable Features

To use the ignore context feature, you first need to enable unstable features in Cody. Here's how:

1. Open your settings in Cody Extension
2. Next go to the `settings.json` file
3. Add a new line: `"cody.unstableFeatures": true`.

This will enable experimental features, including the ignore context feature.

## Using the Ignore Context Feature

To ignore specific files or folders from the context taken by Cody, you need to create a `ignore` file in your project. Here's how:

1. Create a new folder in your project root named `.cody`.
2. Inside the `.cody` folder, create a file named `ignore`.
3. In the `ignore` file, specify the files or folders you want to ignore.

The `.codyignore` file works similarly to a `.gitignore` file. If you want to ignore a file named `secret.json`, you would add `secret.json` to your `.codyignore` file. If you're going to ignore a folder called `lib/shared`, you would add `lib/shared/` to your `.codyignore` file.

Once a file or folder is added to the `.codyignore` file, Cody will no longer provide autocomplete suggestions for that file or folder, and it will not appear in your chat results.
